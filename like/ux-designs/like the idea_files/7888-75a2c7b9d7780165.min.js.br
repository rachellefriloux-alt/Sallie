"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ae48c010-4cc0-5eb5-82d4-56136e66c11f")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[7888],{306027:(e,t,n)=>{n.d(t,{Fb:()=>o,Xr:()=>i,qN:()=>s});let i="emoji_picker--emojiPickerContainerCommentsNext--P62HW emoji_picker--emojiPickerContainer--IKenF",o="emoji_picker--emojiPicker--Z8xIK",s="emoji_picker--pointingDropdown--icocU"},159269:(e,t,n)=>{n.d(t,{$S:()=>d,Du:()=>w,F7:()=>s,GI:()=>x,In:()=>C,KK:()=>P,Lo:()=>u,MJ:()=>_,OM:()=>p,Qq:()=>b,SD:()=>R,UR:()=>a,VM:()=>r,WJ:()=>N,WO:()=>T,YD:()=>j,aW:()=>I,eX:()=>o,ex:()=>E,g2:()=>k,k8:()=>f,lo:()=>y,wC:()=>m,wG:()=>l,wb:()=>c,xH:()=>g,xS:()=>i,xe:()=>h,zl:()=>v});let i="thread_comment--threadHeaderLeft--SYCpv thread_comment--_threadHeader--JJOhl",o="thread_comment--threadHeaderRight---BkiW thread_comment--_threadHeader--JJOhl",s="thread_comment--threadHeaderContainer--bkWD3",a="thread_comment--threadHeaderButton--T6n4F",r="thread_comment--threadHeaderButtonInactive--GeBs8",d="thread_comment--addReactionButton--19YyE",l="thread_comment--loader--yvpsF",c="thread_comment--threadContainer--8-QFV",m="thread_comment--threadContainerCommunityDetailsPage--olhmT thread_comment--threadContainer--8-QFV",h="thread_comment--threadContainerAnimated--NfA8v thread_comment--threadContainer--8-QFV",p="thread_comment--threadContainerInner--HR129",u="thread_comment--threadElement--ZD4SS thread_comment--_threadElement--KGa7b text--fontPos11--2LvXf text--_fontBase--QdLsd text--fontPos13--xW8hS text--_fontBase--QdLsd",_="thread_comment--threadElementReplyContainer--xmPHU thread_comment--threadElement--ZD4SS thread_comment--_threadElement--KGa7b text--fontPos11--2LvXf text--_fontBase--QdLsd text--fontPos13--xW8hS text--_fontBase--QdLsd",f="thread_comment--threadSubelementNoMargin--l65PV",y="thread_comment--indentedQuickReplyThreadSubelement--n8kVv thread_comment--threadSubelementNoMargin--l65PV",g="thread_comment--quickReplyThreadSubelementNoMargin--pM3K8 thread_comment--threadSubelementNoMargin--l65PV",x="thread_comment--indentedThreadSubelement--PzKjw thread_comment--threadSubelement--RwdyC thread_comment--threadSubelementNoMargin--l65PV",k="thread_comment--rightJustified--c9KoM",v="thread_comment--leftJustified--E-dFZ",C="thread_comment--quickReplyThreadElement--up8Fy thread_comment--_threadElement--KGa7b text--fontPos11--2LvXf text--_fontBase--QdLsd text--fontPos11--2LvXf text--_fontBase--QdLsd",w="thread_comment--authorAvatar--6KPpX",T="thread_comment--authorHandle--querA thread_comment--headerLabel--QI7QJ",b="thread_comment--text--9lttg",j="thread_comment--grayLabel--1EiBL thread_comment--headerLabel--QI7QJ",E="thread_comment--iconButtonSpace--salJx",P="thread_comment--attachmentsContainer--luAx9",N="thread_comment--reactionsContainer--bgSZe",I="thread_comment--resolvedIcon--3hl2b",R="thread_comment--loadingAvatar--OY7fs comment_cluster_elements--loadingSpinner--duOt5"},46612:(e,t,n)=>{n.d(t,{Gm:()=>p,MP:()=>c,OX:()=>r,Sg:()=>s,U0:()=>o,bQ:()=>h,fP:()=>i,i8:()=>m,mr:()=>a,o1:()=>u,q9:()=>l,xu:()=>d});let i="thread_comment_composer--inputSectionWrapper--Rxyg-",o="thread_comment_composer--newComment--tZ-X3",s="thread_comment_composer--composerEmpty--sIsaX",a="thread_comment_composer--highlighted--zC-Wl",r="thread_comment_composer--editableTypeahead--W8oHQ text--fontPos13--xW8hS text--_fontBase--QdLsd",d="thread_comment_composer--leftComposerButtonGroup--A7Vc-",l="thread_comment_composer--editSubmitButtons--enyqU",c="thread_comment_composer--replyComposerContainer--PlZj8",m="thread_comment_composer--replyAuthorElement--WOLY9",h="thread_comment_composer--errorFallback--QId0q text--fontPos13--xW8hS text--_fontBase--QdLsd thread_comment_composer--inputSectionWrapper--Rxyg-",p="thread_comment_composer--errorFallbackNewComment--7QPHi thread_comment_composer--errorFallback--QId0q text--fontPos13--xW8hS text--_fontBase--QdLsd thread_comment_composer--inputSectionWrapper--Rxyg- thread_comment_composer--newComment--tZ-X3",u="thread_comment_composer--actions--pXKOH"},368394:(e,t,n)=>{n.d(t,{I2:()=>r,K9:()=>d,Pg:()=>m,cC:()=>c,jn:()=>a,mS:()=>s,nX:()=>i,oQ:()=>o,xN:()=>l});let i="30px",o="emoji_typeahead--emojiTypeahead--fVmv9",s="emoji_typeahead--commentsEmojiTypeaheadDown--O8EYO",a="emoji_typeahead--commentsEmojiTypeaheadUp--RP2hd",r="emoji_typeahead--emojiTypeaheadRow---i-5r",d="emoji_typeahead--figJamEditorEmojiTypeaheadRowSelected--Xpw-b",l="emoji_typeahead--emojiTypeaheadRowSelected--B7eK8",c="emoji_typeahead--emojiName--hDLxK",m="emoji_typeahead--emojiPreview--3rFYm"},218507:(e,t,n)=>{n.d(t,{q:()=>N});var i=n(104076),o=n(716976),s=n(237420),a=n(468882),r=n(38989),d=n(431120),l=n(224996),c=n(615931),m=n(314653),h=n(553538),p=n(324169),u=n(47972),_=n(554841),f=n(405787),y=n(981400),g=n(429110),x=n(261109),k=n(469790),v=n(651376),C=n(605020);function w(e){let{inputRef:t,text:n}=e,[s,r]=o.useState(!1);return(0,k.O1)(e.onEscape,k.KD.LINK_TOOLTIP),(0,i.jsx)("div",{className:"alt_text_editor--container--iBAlE hyperlink_editor--container--rXDYj",style:{left:e.location.x,top:e.location.y},children:(0,i.jsx)("div",{className:`alt_text_editor--popup--slm4K hyperlink_editor--popup--CHv-O _overlayBase--_overlayBase--Rkj8l ${x.Dm}`,children:e.canEdit&&(s||""===n)?(0,i.jsx)("input",{className:"alt_text_editor--input--la-OY hyperlink_editor--input--FGLip input--darkInput--zfbnG",defaultValue:n,onKeyDown:t=>{"Enter"===t.key&&(e.onEnter(),t.preventDefault())},placeholder:(0,a.t)("comments.add_description"),autoComplete:"off",autoCapitalize:"off",ref:t,autoFocus:!0}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"alt_text_editor--textContainer--96qTK",children:(0,i.jsxs)("div",{className:e.canEdit?"alt_text_editor--text--GIG6O":"alt_text_editor--extendedText--s3rKT alt_text_editor--text--GIG6O",children:[(0,i.jsx)("span",{className:"alt_text_editor--label--dv8rN",children:(0,a.t)("comments.alt_text_label")}),n]})}),e.canEdit&&(0,i.jsx)("button",{className:"alt_text_editor--button--WSr1m",onClick:()=>r(!0),autoFocus:!0,children:(0,a.t)("comments.edit_alt_text")})]})})})}var T=n(440392),b=n(211820),j=n(84674);let E={shouldZoomToStart:!1,shouldWheelPan:!0,enableZoomControls:!0,enableZoomKeyControls:!0,minZoomFactor:.01,maxZoomFactor:10,crossOrigin:"use-credentials"};var P=(e=>(e[e.LEFT=-1]="LEFT",e[e.RIGHT=1]="RIGHT",e))(P||{});let N=(0,C.Ju)(function(e){let t=(0,s.wA)(),[n,C]=o.useState(e.selectedIdx),P=o.useRef(null),[N,I]=o.useState(null),R=o.useRef(null),{onUpdateAltText:A}=e,[S,M]=o.useState(e.attachments),D=(0,y.UR)(g.b.ATTACHMENT_MODAL_BACKGROUND_COLOR),O=D?(0,d.H0)(D):void 0,L=e=>{if(P.current){let t=P.current?.children[e].firstChild;t?.blur()}},U=e=>{L(n),C(e),I(null)},F=e=>{U((n+e+S.length)%S.length)},K=e=>{let t=n===(-1===e?0:S.length-1);return(0,i.jsx)(p.$,{onClick:()=>F(e),icon:-1===e?"chevron-left-32":"chevron-right-32",variant:"text",disabled:t})},W=e=>{if("ArrowLeft"===e.key)0!==n&&F(-1);else if("ArrowRight"===e.key){if(n===S.length-1)return;F(1)}},V=()=>(t(_.Lo()),!0);(0,k.O1)(V,k.KD.FULL_SCREEN_MODAL);let H=(e,n)=>{e.preventDefault(),e.stopPropagation(),t(u.j7({type:x.DT,data:{id:"comment_attachment_context_menu",clientX:e.clientX,clientY:e.clientY,attachment:n}}))},z=o.useRef(null),B=o.useCallback(()=>{if(R.current&&!N){let e=R.current.getBoundingClientRect(),n=new l.Mi(e.left+e.width/2,e.top);t(f.jD()),I(n)}else I(null)},[t,N]),G=o.useCallback(e=>{if(z.current){let i=z.current.value.trim();(i||e)&&A(i,n).then(e=>{e&&(200!==e.status?t(h.F.enqueue({message:(0,a.t)("comments.failed_to_update_alt_text")})):M(e=>(e[n]={...e[n],altText:i},e)))}).catch(e=>{t(h.F.enqueue({message:(0,a.t)("comments.failed_to_update_alt_text")}))})}I(null)},[t,A,n]);return(0,i.jsxs)(m.i,{displayAs:m.C.Block,children:[(0,i.jsx)(T.d_,{className:"attachment_detail_modal--attachmentDetailsModal--Ilt1h",size:"any",onKeyDown:e=>{W(e)},children:(0,i.jsxs)("div",{className:"attachment_detail_modal--contentSectionContainer--x2FL9",children:[(0,i.jsxs)("div",{className:"attachment_detail_modal--headerContainer--vNgwC",children:[(0,i.jsx)("div",{className:"attachment_detail_modal--headerTitle--1-PU5",children:S[n].metadata.file_name??(0,a.t)("comments.attachment_default_name",{fileExtension:S[n].mediaType.split("/")[1]})}),(0,i.jsx)(c.Jn,{className:"attachment_detail_modal--headerCloseButton--AQ1Mo",recordingKey:"commentMediaDetailModal",onClick:V,innerText:(0,a.t)("comments.close"),"aria-label":(0,a.t)("comments.close")})]}),(0,i.jsxs)("div",{className:"attachment_detail_modal--selectedContent--UofIS",children:[(0,i.jsx)(b.DH,{imageSrc:S[n].imageUrl,onContextMenu:e=>{H(e,S[n])},pageBackgroundColor:O??void 0,...E}),!!(0,r.kc)().comments_media_alt_text&&(e.canEdit||S[n].altText)&&(0,i.jsx)("button",{className:S.length>1?"attachment_detail_modal--altTextAboveThumbnails---Ivnf attachment_detail_modal--altText--lsdjO feed_post_detail_modal--contentOverlayPill--1jsoj":"attachment_detail_modal--altText--lsdjO feed_post_detail_modal--contentOverlayPill--1jsoj","data-tooltip-type":v.Ib.TEXT,"data-tooltip":N?void 0:(0,a.t)("comments.add_description"),"data-tooltip-show-above":!0,onClick:()=>N?G(S[n].altText):B(),ref:R,children:(0,a.t)("comments.alt_text")})]}),S.length>1&&(0,i.jsxs)("div",{className:"attachment_detail_modal--thumbnailSection--rGGn4",children:[K(-1),(0,i.jsx)("div",{ref:P,className:"attachment_detail_modal--thumbnailContainer--ErgqC",children:S.map((e,t)=>(0,i.jsx)("div",{className:"attachment_detail_modal--thumbnailWrapper--dWda8",children:(0,i.jsx)(j.MH,{thumbnailUrl:e.thumbnailUrl,altText:e.altText||(0,a.t)("comments.attachment_thumbnail_alt_text_default"),isSelected:t===n,onClick:e=>{U(t)},onRightClick:t=>H(t,e)})},e.thumbnailUrl))}),K(1)]})]})}),N&&(0,i.jsx)(w,{text:S[n].altText??"",location:N,onEnter:()=>G(S[n].altText),onEscape:()=>(I(null),!0),inputRef:z,canEdit:e.canEdit})]})},"AttachmentDetailModal",C.ZU.NO)},421865:(e,t,n)=>{n.d(t,{a:()=>u});var i=n(104076),o=n(237420),s=n(468882),a=n(47972),r=n(554841);if(3679!=n.j)var d=n(261109);var l=n(870025),c=n(218507),m=n(84674),h=n(159269),p=n(692466);function u(e){let t=(0,o.wA)(),{attachments:n}=e,u=i=>{t((0,r.to)({type:c.q,data:{attachments:n,selectedIdx:n.map(e=>e.thumbnailUrl).indexOf(i),onUpdateAltText:_,canEdit:e.canEdit},showModalsBeneath:!0}))},_=(t,i)=>{let o=n[i];return l.l.put(e.fileKey,o.id,t)},f=(e,n)=>{e.preventDefault(),e.stopPropagation(),t(a.j7({type:d.DT,data:{id:"comment_attachment_context_menu",clientX:e.clientX,clientY:e.clientY,attachment:n}}))};return(0,i.jsx)("div",{className:h.KK,children:n.slice(0,3).map((e,t)=>(0,i.jsx)("div",{className:p.Kn,children:(0,i.jsx)(m.MH,{thumbnailUrl:e.thumbnailUrl,altText:e.altText||(0,s.t)("comments.attachment_thumbnail_alt_text_default"),overlayText:n.length>3&&2===t?`+${n.length-3}`:void 0,onClick:u,onRightClick:t=>f(t,e),dimensions:0===t&&1===n.length?e.metadata.dimensions:void 0})},e.id))})}},429110:(e,t,n)=>{n.d(t,{b:()=>i});var i=(e=>(e.DOCK_STYLE="DOCK_STYLE",e.ATTACHMENT_MODAL_BACKGROUND_COLOR="ATTACHMENT_MODAL_BACKGROUND_COLOR",e))(i||{})},898025:(e,t,n)=>{n.d(t,{H6:()=>D,WM:()=>R,_B:()=>N,hC:()=>I,nq:()=>M,uB:()=>S,zf:()=>A});var i=n(716976),o=n(237420),s=n(855272),a=n(711839),r=n(611769),d=n(59881),l=n(705518),c=n(296672),m=n(276752),h=n(558789),p=n(93899),u=n(271308),_=n(161025),f=n(5243),y=n(854244),g=n(885347),x=n(681369),k=n(196531),v=n(229462),C=n(163942),w=n(728193),T=n(863400),b=n(972480),j=n(794134);function E(e){return!!e.commentPin}let P={value:()=>{}};function N(){let[{value:e},t]=i.useState(P),[{value:n},o]=i.useState(P),[s,a]=i.useState(!1),r=i.useCallback(e=>{t(e?{value:e}:P)},[t]),d=i.useCallback(e=>{o(e?{value:e}:P)},[o]);return i.useMemo(()=>({onInsert:n,onClear:e,isEditorFocused:s,setIsEditorFocused:a,editorOnClear:r,editorOnInsert:d}),[e,n,s,a,r,d])}function I(e,t,n){return null==e||"loaded"!==e.status?t:n?n(e.data):e.data}function R(e,t,n,r,d){let l=(0,g.s)(),_=(0,o.wA)(),f=(0,j.eY)(),y=(0,w.lg)(),x=(0,c.H)(),k=x&&x!==s.AD,C=(0,h.hA)(),T=(0,p.$m)(),b=i.useMemo(()=>{let t;let i=e=>e.filter(e=>{if(e.anchored&&e.comments.length>0&&e.comments[0].client_meta?.node_id){let t=e.comments[0].client_meta.node_id;return!!f.get(t)}return!0}),o=e=>e.filter(e=>{if(e.anchored&&e.comments.length>0&&e.comments[0].client_meta?.node_id){let t=e.comments[0].client_meta.node_id,n=t?(0,a.UN)().get(t):void 0,i=n?(0,c.s)(n,y):s.AD;return k?i===x:i!==s.AD}return!0});switch(l.filterBy){case"hidden_sections":t=e=>e.filter(e=>{if(e.id!==n&&e.anchored&&e.comments.length>0&&e.comments[0].client_meta?.node_id){let t=e.comments[0].client_meta.node_id,n=f.get(t);return!n?.isUnderHiddenSection}return!0});break;case"deleted_anchors":t=i;break;case"non_focused_node_anchors":t=o;break;case"slide_filter_rules":t=e=>T&&k?o(i(e)):i(e);break;case"non_dev_mode_focus":t=e=>e.filter(e=>{if(e.anchored&&e.comments.length>0&&e.comments[0].client_meta?.node_id){let t=C?(0,a.UN)().get(C):null;if(!t)return!0;let n=e.comments[0].client_meta.node_id,i=n?(0,a.UN)().get(n):null;return(0,m.WJ)(t,i)}return!0})}return I(e,[],t)},[l.filterBy,e,n,f,k,x,C,T,y]),E=i.useRef(b);return E.current=b,i.useEffect(()=>{r&&!E.current.find(e=>e.id===n)&&n!==v.hm&&_(u.UU())},[_,n,r]),i.useMemo(()=>b.filter(e=>!!e.canvasPosition&&e.page===t&&(!d||n===e.id)&&!e.isCanvasMention),[b,t,n,d])}function A(e,t){let n=i.useMemo(()=>e.filter(e=>e.canvasPosition),[e]),o=i.useMemo(()=>{if(0!==n.length)return n.reduce((e,t)=>e.canvasPosition.y<t.canvasPosition.y?e:t)},[n]);return i.useMemo(()=>o?function(e,t,n){let i=(0,b.Z0)(n,e).y,o=e=>Math.floor(((0,b.Z0)(n,e.canvasPosition).y-i)/50);return t.sort((e,t)=>{if((0,C.U6)()){if(E(e)&&!E(t))return -1;if(!E(e)&&E(t))return 1}let n=o(e),i=o(t);return n===i?e.canvasPosition.x-t.canvasPosition.x:n-i})}(o.canvasPosition,e,t):e,[e,o,t])}function S(e,t){let n=i.useContext(x.hh),s=i.useMemo(()=>I(n.threads,[]),[n.threads]),a=(0,o.d4)(e=>e.comments.newComment);return i.useMemo(()=>e===v.hm?(0,k.JG)(e,a,t):s.find(t=>t.id===e)||null,[a,e,s,t])}function M(e,t,n,s,a,r){let[d,l]=i.useState(!1);i.useEffect(()=>{e&&l(e===n)},[e,n]);let c=(0,o.wA)(),m=(0,_.I_)(),h=(0,g.s)(),p=(0,T.Z)("comments-navigate");return i.useEffect(()=>{if(t&&!d){let t=s.find(t=>t.id===e);if(t){if(r){if(!t.isPendingFromSinatra&&t.canvasPosition){let e=(0,b.Z0)(a.getViewportInfo(),t.canvasPosition),n=(0,y.c4)(t.comments).length,i=f.XC.getPinSize(n);r(t.id,{x:e.x,y:e.y,width:1.15*i.width,height:1.15*i.height})}}else c(u.At({receiptsAPI:m.commentReceipts,thread:t,viewport:a,config:h,navigate:p}));l(!0)}}},[t,m,a,c,e,s,d,r,h,p]),d}function D(e,t){let n=(0,o.d4)(e=>e.comments.newComment),s=(0,o.wA)(),a=(0,_.I_)().writeAPI,c=(0,g.s)();return i.useCallback(()=>{if(!a){console.error("Calling submitNewComment with no write API");return}let i=(0,r.g)();l.sn.start(`comment_creation_${i}`),(0,d.sx)("New comment Creating UUID",{uuid:i});let o=n.anchorPosition;if(!o)return;let m=e.getCommentDestinationForCanvasPosition(o,t,!0);m&&((0,d.sx)("New comment dispatching submission",{uuid:i}),s(u._B({destination:m,commentsWriteApi:a,commentsConfiguration:c,uuid:i})))},[e,n,s,t,a,c])}},54434:(e,t,n)=>{function i(e){if("loaded"!==e.status)return!1;let t=e.data.file;return!!t&&("comments"in t||"mobileCommentThread"in t)}n.d(t,{I:()=>o,e:()=>i});class o{constructor(e,t,n){this.args=e,this.subscription=t,this.user=n,this.livegraphClient=null}get fileKey(){return this.args.fileKey}get loadedComments(){return i(this.subscription)?"comments"in this.subscription.data.file?this.subscription.data.file.comments:this.subscription.data.file.mobileCommentThread:[]}optimistically(e){if(!this.livegraphClient){setTimeout(()=>{throw Error("Unable to perform optimistic mutation to livegraph, no livegraph client")});return}if(!this.subscription){setTimeout(()=>{throw Error(`Unable to perform optimistic mutation to livegraph, no livegraph client ${JSON.stringify(this.args)}`)});return}if(!i(this.subscription)){let e=this.subscription;console.error("Unable to perform optimistic mutation to livegraph - partial subscription",JSON.stringify(this.args),JSON.stringify({loaded:"loaded"===e.status,status:e.status,file:"loaded"===e.status&&!!e.data.file,currentFileFollower:"loaded"===e.status&&!!e.data.file?.currentUserFileFollower,comments:"loaded"===e.status&&!!(e.data.file&&"comments"in e.data.file?e.data.file.comments:e.data.file?.mobileCommentThread)}));return}e(this.subscription.data,this.livegraphClient,this.user)}}},259114:(e,t,n)=>{n.d(t,{xI:()=>r,kJ:()=>a});var i=n(693181);let o=new class{constructor(){this.FileCommentPinImpl=(0,i.vh)()}setPin(e,t){return this.FileCommentPinImpl.validate(({xr:n})=>n.put(`/api/file/${e}/comments/${t}`,{comment_pin_action:"set_pin"}))}removePin(e,t){return this.FileCommentPinImpl.validate(({xr:n})=>n.put(`/api/file/${e}/comments/${t}`,{comment_pin_action:"remove_pin"}))}};var s=n(761952);function a(){return function(e){if("loaded"!==e.status)return 0;let t=0;for(let n of e.data)n.commentPin&&t++;return t}((0,s.wq)())}class r{constructor(e){this.client=e}setPin(e){let t=o.setPin(this.client.fileKey,e);return this.client.optimistically(async(n,i,o)=>{let s=new Date,a=`${e}_${this.client.fileKey}`;await i.optimisticallyCreate({CommentPin:{[a]:{fileKey:n.file.id,fileCommentId:e,updatedAt:s,createdAt:s,userId:o.id}}},t)}),t}removePin(e,t){let n=o.removePin(this.client.fileKey,e);return this.client.optimistically(async(i,o)=>{if("loaded"!==this.client.subscription.status)throw Error("Unable to get pin for unloaded subscription");await o.optimisticallyDelete({CommentPin:{[t||`${e}_${this.client.fileKey}`]:null}},n)}),n}}},187434:(e,t,n)=>{n.d(t,{R:()=>p,v:()=>h});var i=n(716976),o=n(237420),s=n(468882),a=n(707698),r=n(490384),d=n(179236),l=n(397617),c=n(428444),m=n(981400);function h(){let e=(0,o.wA)(),t=(0,m.sn)(),n=(0,d._6)(),s="prototype"===n.view,h=(0,r.q5)(),p=s?n.file.editor_type:h?.editorType;return i.useCallback(n=>{let i=(0,l.jN)({file:{key:n.key,editorType:p||c._Y.DESIGN},base:s?"proto":"file",nodeId:n.client_meta?.node_id,allowDefaulting:!1,commentId:n.parent_id??n.id,...t});return e(a.S({url:i}))},[e,t,s,p])}function p(){let[e,t]=i.useState(null);return[e,()=>{null==e||e.endsWith("\xa0")?t((0,s.t)("comments.accessibility_reply_added")):t((0,s.t)("comments.accessibility_reply_added")+"\xa0")}]}},946044:(e,t,n)=>{n.d(t,{ny:()=>C,Kb:()=>w});var i=n(104076),o=n(716976),s=n(922251),a=n(587825),r=n(468882),d=n(511570),l=n.n(d),c=n(376162),m=n(452062),h=n(873304);let p=[{id:"heavy_plus_sign",description:"plus sign"},{id:"+1",description:"thumbs up"},{id:"-1",description:"thumbs down"},{id:"eyes",description:"eyes"},{id:"heart_eyes",description:"heart eyes"},{id:"joy",description:"joy"},{id:"star2",description:"glowing star",hideInPicker:!0},{id:"fire",description:"fire"}].map(e=>{let t=h.dN.get(e.id),n=t?t?.skins[0].unified:"";return{...e,skin:null,colons:`:${e.id}:`,unified:n,native:String.fromCodePoint(parseInt(n,16))}});var u=n(651376);let _=(0,n(623623).ex)("emoji_reaction_tooltip",function(e){let{emojiUnicodeList:t,emojiShortcodeToUsers:n}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"emoji_reaction_tooltip--unicodeContainer--So5EP",children:t.map(e=>(0,i.jsx)("span",{className:"emoji_reaction_tooltip--unicode---Fnn9",children:e},e))}),n.map(([e,t])=>(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:"emoji_reaction_tooltip--users--HREY8",children:t}),(0,i.jsx)("div",{className:"emoji_reaction_tooltip--shortcode--wvFPr",children:e})]},e))]})},e=>{let t={emojiUnicodeList:[],emojiShortcodeToUsers:[]},n=e.getAttribute("data-tooltip-data");return n&&(t={...t,...JSON.parse(n)}),t}),f="10px",y="reactions--reaction--V7d-0 text--fontPos11--2LvXf text--_fontBase--QdLsd";function g(e){return void 0!==e.numUsers}let x={};function k(e,t){let n=e.map(e=>e.handle).slice(0,t),i=e.length-t;return i>0&&n.push((0,m.td)(i,"other")),(0,m.Yx)(n)}p.forEach(e=>{x[`:${e.id}:`]=e});let v=o.forwardRef(function(e,t){let n=g(e.reaction)?e.reaction.numUsers:e.reaction.users.length,o=Object.keys(e.reaction.skinTonesToUsers).length,a=o>0?Object.keys(e.reaction.skinTonesToUsers):[""],d=a.map(t=>(0,c.UF)(`${e.reaction.emoji}${t}`)[0]),m={emojiUnicodeList:[],emojiShortcodeToUsers:[]};if(!g(e.reaction)){let t=[],n=[];if(o>0)a.forEach(i=>{let s=`${e.reaction.emoji}${i}`;t.push((0,c.UF)(s)[0].unicode);let a=k(e.reaction.skinTonesToUsers[i],Math.floor(40/o));n.push([s,a])});else{t.push((0,c.UF)(e.reaction.emoji)[0].unicode);let i=k(e.reaction.users,40);n.push([e.reaction.emoji,i])}m={emojiUnicodeList:t,emojiShortcodeToUsers:n}}return(0,i.jsxs)(s.E,{ref:t,"aria-label":e.reaction.selected?(0,r.t)("comments.reaction_selected_descriptive_aria_label_text",{num_users:n,icon:JSON.stringify(m.emojiUnicodeList)}):(0,r.t)("comments.reaction_unselected_descriptive_aria_label_text",{num_users:n,icon:JSON.stringify(m.emojiUnicodeList)}),"aria-pressed":e.reaction.selected,className:l()({"reactions--selectedReaction--2gVk1 reactions--reaction--V7d-0 text--fontPos11--2LvXf text--_fontBase--QdLsd":e.reaction.selected,[y]:!e.reaction.selected,"reactions--hiddenReaction--iatfg":!e.visible}),"data-testid":`reaction-button-${e.reaction.emoji}`,"data-tooltip":_,"data-tooltip-data":JSON.stringify(m),"data-tooltip-max-width":200,"data-tooltip-type":u.Ib.SPECIAL,onClick:e.onClick,children:[d.map(e=>(0,i.jsx)("span",{className:"reactions--emojiUnicode--GF97d",children:e.unicode},`${e.meta}`)),(0,i.jsx)("span",{className:"reactions--count---FqY3",children:n})]})});function C(e){let t=e.styleClassName?e.styleClassName:"reactions--addReaction--TEv8M";return(0,i.jsx)(s.E,{className:t,"data-tooltip-type":u.Ib.TEXT,"data-tooltip":(0,r.t)("comments.add_reaction"),onClick:e.onClick,"aria-label":(0,r.t)("comments.add_reaction"),"data-testid":"add-reaction-button","data-fullscreen-intercept":e["data-fullscreen-intercept"],children:(0,i.jsx)(a.A,{})})}function w(e){let{reactions:t,collapseOverflow:n,onClickExisting:s,children:a,prependToList:d}=e,c=o.useRef(null),m=o.useRef({}),[h,p]=o.useState(null),[u,_]=o.useState(!n);o.useLayoutEffect(()=>{if(!c.current)return;let{width:e}=c.current.getBoundingClientRect(),n=-parseInt(f)+parseInt("1px"),i=0;for(let o of t){let s=m.current[o.emoji];if(!s)return;if((n+=parseInt(f)+s.getBoundingClientRect().width)>e||i===t.length-1&&n+40+parseInt(f)>e)break;i+=1}p(i)},[t]);let g=null===h?null:t.length-h,x=t.map((t,n)=>{let o=s?e=>s(t,e):void 0;return(0,i.jsx)(v,{reaction:t,onClick:o,ref:e=>m.current[t.emoji]=e,visible:u||e.addedReaction||null===h||n<h},t.emoji)}),k=!(u||e.addedReaction)&&null!==g&&g>0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:l()({"reactions--reactionList--mLzTA":!0,"reactions--singleRow--yap9W":k,"reactions--maxDoubleRow--aAVmE":!(u||e.addedReaction)&&null===g}),ref:c,children:[...d??[],x,!k&&a]}),k&&(0,i.jsx)("div",{className:"reactions--showMoreBtn--4yVso",children:(0,i.jsx)("button",{className:y,onClick:()=>{_(!0)},"data-testid":"show-more-reactions-button",children:(0,r.tx)("comments.num_hidden_more",{numHidden:g})})})]})}},558221:(e,t,n)=>{n.d(t,{NS:()=>l,Cs:()=>c});var i=n(104076),o=n(716976);n(47890),n(468882);var s=n(511570),a=n.n(s),r=n(842949),d=n(691431);let l=122;function c(e){let[t,n]=o.useState(!1),s=(0,r.am)();o.useEffect(()=>{s("comments_suggestions_picker_opened")},[s]);let l=(0,d.f6)(e),c=e.typeahead.suggestedComments.map((o,a)=>{let r=()=>{e.setTypeahead({...e.typeahead,index:a})};return(0,i.jsx)(d.Hn,{className:"suggestions_picker--suggestionPillsOneLine--BVNya",selectedClassName:"suggestions_picker--suggestionPillsSelected--bswnN",selected:e.typeahead.index===a,onPointerOver:()=>{t&&r()},onPointerDown:()=>{n(!0),r()},onClick:()=>{s("comments_suggestions_picker_selected_item",{commentSuggestion:o.suggestionsKey,commentSuggestionIndex:a+1}),e.onInsert()},children:o.suggestionDisplay},`commentSuggestion ${o.suggestionDisplay}`)});return(0,i.jsx)(d.xD,{dispatchTypeahead:e.setTypeahead,typeahead:e.typeahead,className:a()({"suggestions_picker--suggestionPillsContainer--oKhWE":!1,"suggestions_picker--suggestionPillsOneLineContainer--kuqy- suggestions_picker--suggestionPillsContainer--oKhWE":!0,"suggestions_picker--suggestionPillsDown--0HaBY":e.direction===d.ri.DOWNWARDS,"suggestions_picker--suggestionPillsUp--gu1n-":e.direction===d.ri.UPWARDS}),onPointerMove:()=>n(!0),onInsert:e.onInsert,onClear:e.onClear,isOneLineOfSuggestions:!0,trackEvent:s,...l,children:c})}},481116:(e,t,n)=>{n.d(t,{C:()=>l,e:()=>c});var i=n(104076),o=n(468882),s=n(511570),a=n.n(s),r=n(13607),d=n(46612);let l=(0,r.kf)("lazy_thread_comment_composer",{isCodesplit:!0,ComponentFactory:async()=>({default:(await Promise.all([n.e(3402),n.e(5592),n.e(4349),n.e(2457),n.e(8410)]).then(n.bind(n,342457))).ThreadCommentComposer})});function c(e){let{type:t}=e;return(0,i.jsx)("div",{className:a()({[d.Gm]:"new"===t,[d.bQ]:"thread"===t}),children:(0,i.jsx)("span",{children:(0,o.tx)("comments.failed_to_load")})})}},192992:(e,t,n)=>{n.d(t,{I:()=>O});var i=n(104076),o=n(716976),s=n(237420),a=n(258882),r=n(823242),d=n(468882),l=n(38989),c=n(59881),m=n(705518),h=n(761179),p=n(977051),u=n(147186),_=n(872798),f=n(651376);function y(e){let t=function(e,t=(0,_.Gq)().getPrimaryLocale(!1)){return new Intl.DateTimeFormat(t,{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}).format(u.A.utc(e).toDate())}(e.date,e.locale);return(0,i.jsx)("span",{"data-tooltip-type":f.Ib.TEXT,"data-tooltip":t,children:e.children})}var g=n(271308),x=n(161025),k=n(761952),v=n(421865),C=n(981184),w=n(981400),T=n(946044),b=n(229462),j=n(119369),E=n(439497),P=n(663511),N=n(128212),I=n(47972),R=n(808655),A=n(159269);let S=e=>e.stopPropagation(),M=(0,i.jsx)("div",{className:A.SD,"data-testid":"thread-comment-loading-avatar"});function D(e){let t=!e.hideReactions,n=e.comment,s=(0,k.AK)(n.id)>0,h=!!n.isPendingFromSinatra,u=!!n.isSaving,_=(0,l.kc)().comments_faster_saving_ux?u:h;o.useEffect(()=>{let{uuid:e}=n;if(e&&!_){let t=m.sn.get(`comment_reply_creation_${e}`);if(t&&t.isRunning&&!t.isUnreliable){let t=m.sn.tryStop(`comment_reply_creation_${e}`);t&&(0,c.sx)("comment_reply_creation",{elapsedMs:t},{forwardToDatadog:!0})}}},[n,_]);let f=(0,w.vn)(),g=!h&&(!e.hideOverflowMenu&&n.user_id===e.user?.id||f),x=(0,i.jsx)(j.Ro,{entity:n.user,size:24,className:A.Du});return(0,i.jsxs)("div",{className:`${e.isQuickReplyThreadView?A.In:A.Lo}`,children:[(0,i.jsxs)("div",{className:`${e.isQuickReplyThreadView?A.xH:A.k8}`,children:[(0,i.jsxs)("div",{className:A.zl,children:[_?M:e.communityAuthorLink?(0,i.jsx)(a.N,{href:e.communityAuthorLink.href,onClick:e.communityAuthorLink.onClick,children:x}):x,e.communityAuthorLink?(0,i.jsx)(r._,{href:e.communityAuthorLink.href,onClick:e.communityAuthorLink.onClick,style:{cursor:"pointer"},className:A.WO,children:(0,i.jsx)("h3",{dir:"auto",children:n.user.handle})}):(0,i.jsx)("h3",{className:A.WO,dir:"auto",children:n.user.handle}),_?(0,i.jsx)("div",{className:A.YD,children:(0,d.tx)("comments.in_a_moment")}):(0,i.jsx)("div",{className:A.YD,children:(0,i.jsx)(y,{date:n.created_at,children:(0,i.jsx)(p.h1,{capitalize:!0,date:n.created_at})})}),e.metaAddon]}),(0,i.jsx)("div",{className:A.g2,children:g&&(0,i.jsx)(P.V,{label:(0,d.t)("comments.comment_actions"),comment:n,recordingKey:"threadComment.commentActionsButton",possibleActions:e.overflowMenuActions,onDelete:e.onDelete})})]}),(0,i.jsxs)("div",{tabIndex:-1,ref:e.threadCommentRef,onMouseDown:S,className:`${e.isQuickReplyThreadView?A.lo:A.GI}`,"data-testid":"thread-comment-message",children:[(0,i.jsx)(C.HH,{commentId:n.id,messageMeta:n.message_meta,className:A.Qq,showEditedIndicator:e.showEditedIndicator}),t&&!s&&e.user&&(0,i.jsx)(U,{comment:e.comment,currentUser:e.user,isPendingComment:h,threadCommentRef:e.threadCommentRef}),!t&&(0,i.jsx)("div",{className:A.ex})]}),n.attachments&&(0,i.jsx)(v.a,{attachments:n.attachments,fileKey:e.comment.key,canEdit:e.comment.user_id===e.user?.id}),t&&s&&e.user&&(0,i.jsx)("div",{className:A.WJ,children:(0,i.jsx)(L,{comment:e.comment,currentUser:e.user,isPendingComment:h,isQuickReplyThreadView:e.isQuickReplyThreadView,threadCommentRef:e.threadCommentRef})})]})}function O(e){let{dispatch:t,comment:n,prevAuthor:a}=e,r=o.useRef(null);!function(e,t){let n=(0,s.d4)(e=>e.comments.editingComment),i=(0,h.ZC)(n);o.useEffect(()=>{n||i?.id!==t.id||e.current?.focus()},[n,i,t.id,e])}(r,n);let l=o.useCallback(e=>{t(g.Df({id:n.id,key:n.key,messageMeta:e}))},[t,n]),c=o.useCallback(e=>{t(g.uy({id:n.id,key:n.key,attachmentId:e.id,attachment:e}))},[t,n]),m=o.useCallback(e=>{t(g.uy({id:n.id,key:n.key,attachmentId:e,attachment:null}))},[n.id,n.key,t]),p=o.useCallback(()=>{t(g.pD())},[t]),u=function(e){let t=(0,s.wA)(),n=o.useMemo(()=>e?{view:"communityHub",subView:"handle",handle:e}:void 0,[e]),i=(0,s.d4)(e=>n?(0,R.Np)(e,n):void 0),a=o.useMemo(()=>n?(0,N.Gc)(e=>{e.preventDefault(),t(I.sf(n))}):void 0,[n,t]);if(n&&i&&a)return{href:i,onClick:a}}(n.profile_handle),_=a!==n.user_id;if(!e.editingComment||e.editingComment.id!==n.id||e.commentCreationDisabled)return(0,i.jsx)(D,{comment:e.comment,communityAuthorLink:u,hideReactions:e.hideReactions,isQuickReplyThreadView:e.isQuickReplyThreadView,metaAddon:e.metaAddon,onDelete:e.onDelete,overflowMenuActions:e.overflowMenuActions,showEditedIndicator:e.showEditedIndicator,threadCommentRef:r,user:e.user});{let{messageMeta:t,attachmentUpdates:o}=e.editingComment,s=Object.values(o?.attachments??{}),a=[...new Set(e.thread.comments.map(e=>e.user.handle))];return(0,i.jsx)(E.K,{allowAttachments:!0,attachments:s,authorChanged:_,authorNames:a,createdAt:n.created_at,deleteAttachment:m,dispatch:e.dispatch,editingExistingComment:!0,editorOnClear:e.editorOnClear,editorOnInsert:e.editorOnInsert,editorRef:e.editorRef,editorType:e.editorType,fileKey:e.thread.key,hideEmojiPicker:e.hideEmojiPicker,hyperlinkLocation:e.hyperlinkLocation,isDisabled:!1,mentionables:e.mentionables,messageMeta:t,mountInputFocused:e.mountInputFocused,onCancel:p,onSubmit:()=>e.submitEdit(n,t,o),placeholderText:(0,d.t)("comments.comment_n"),recordingKey:b.Dw.edit,setHyperlinkEditorRef:e.setHyperlinkEditorRef,setHyperlinkLocation:e.setHyperlinkLocation,setIsEditorFocused:e.setIsEditorFocused,submitText:(0,d.t)("comments.save"),threadId:e.thread.id,threadPosition:e.threadPosition,typeahead:e.typeahead,updateAttachment:c,updateMessage:l,user:n.user,viewportPositionFromClientPosition:e.viewportPositionFromClientPosition})}}function L(e){let t=(0,s.wA)(),[n,a]=o.useState(!1),{reactionsApi:r}=(0,x.I_)(),d=(0,k.Tv)(e.comment.id,e.currentUser.id),l=r?(n,i)=>{i.stopPropagation(),t(g.z$({reactionsApi:r,id:e.comment.id,emoji:n.emoji,quickReply:!!e.isQuickReplyThreadView})),e.threadCommentRef.current?.focus()}:void 0;return"loaded"!==d.status?null:(0,i.jsx)(T.Kb,{reactions:d.data.typed,collapseOverflow:!0,onClickExisting:l,addedReaction:n,children:(0,i.jsx)(U,{comment:e.comment,currentUser:e.currentUser,isPendingComment:e.isPendingComment,onAddedReaction:()=>{a(!0)},isQuickReplyThreadView:e.isQuickReplyThreadView,threadCommentRef:e.threadCommentRef})})}function U(e){let t=(0,s.wA)(),{reactionsApi:n}=(0,x.I_)(),a=(0,s.d4)(e=>e.comments.emojiPicker),r=o.useMemo(()=>!!a?.visible&&a.commentsId===e.comment.id,[e.comment.id,a]);if(e.isPendingComment||!n)return null;let d=i=>{l(),e.onAddedReaction&&e.onAddedReaction(),t(g.z$({reactionsApi:n,id:e.comment.id,emoji:i.shortcodes,quickReply:!!e.isQuickReplyThreadView})),e.threadCommentRef.current?.focus()},l=()=>{t(g.RI({visible:!1})),e.threadCommentRef.current?.focus()};return(0,i.jsx)("div",{style:r?{opacity:1}:{},className:A.$S,children:(0,i.jsx)(T.ny,{onClick:n=>{n.stopPropagation();let i=n.currentTarget.getBoundingClientRect();t(g.RI({visible:!0,targetRect:i,commentsId:e.comment.id,onPick:d,onCancel:l}))},selected:r,"data-fullscreen-intercept":!0})})}},439497:(e,t,n)=>{n.d(t,{K:()=>c});var i=n(104076),o=n(716976),s=n(468882),a=n(452062),r=n(790476),d=n(481116),l=n(46612);function c(e){let t=o.useCallback(()=>{e.replyContainerRef?.current&&e.replyContainerRef.current.scrollIntoView({block:"end",behavior:"smooth"})},[e.replyContainerRef]),n=(0,i.jsx)(d.C,{allowAttachments:e.allowAttachments,ariaLabel:e.authorNames?(0,s.t)("fullscreen.accessibility.reply_to_comment_with_authors",{username:(0,a.Yx)(e.authorNames)}):(0,s.t)("fullscreen.accessibility.reply_to_comment"),attachments:e.attachments,authorChanged:e.authorChanged,className:e.className,createdAt:e.createdAt,deleteAttachment:e.deleteAttachment,dispatch:e.dispatch,editingExistingComment:e.editingExistingComment,editorOnClear:e.editorOnClear,editorOnInsert:e.editorOnInsert,editorRef:e.editorRef,editorType:e.editorType,errorFallback:(0,i.jsx)(d.e,{type:"thread"}),fallback:null,fileKey:e.fileKey,hideEmojiPicker:e.hideEmojiPicker,hyperlinkLocation:e.hyperlinkLocation,isDisabled:e.isDisabled,isEmojiPickerDisabled:e.isEmojiPickerDisabled,maintainSelectionOnFocus:e.maintainSelectionOnFocus,mentionables:e.mentionables,messageMeta:e.messageMeta,mountInputFocused:e.mountInputFocused,onCancel:e.onCancel,onComposeFocus:e.onComposeFocus,onEditStart:e.onEditStart,onSubmit:e.onSubmit,placeholderText:e.placeholderText,recordingKey:e.recordingKey,scrollToBottom:e.replyContainerRef&&t,setHyperlinkEditorRef:e.setHyperlinkEditorRef,setHyperlinkLocation:e.setHyperlinkLocation,setIsEditorFocused:e.setIsEditorFocused,submitText:e.submitText,threadId:e.threadId,threadPosition:e.threadPosition,typeahead:e.typeahead,updateAttachment:e.updateAttachment,updateMessage:e.updateMessage,user:e.user,viewportPositionFromClientPosition:e.viewportPositionFromClientPosition});return(0,i.jsxs)("div",{className:l.MP,ref:e.replyContainerRef,children:[(0,i.jsx)("div",{className:l.i8,children:(0,i.jsx)(r.H8,{user:e.user||{}})}),n]})}},663511:(e,t,n)=>{n.d(t,{V:()=>K});var i=n(104076),o=n(237420),s=n(414393),a=n(748716),r=n(926646),d=n(283002),l=n(468882),c=n(271308),m=n(161025),h=n(981400),p=n(187434),u=n(716976),_=n(898025),f=n(932119),y=n(266132),g=n(794134),x=n(174538),k=n(846364),v=n(498020),C=n(235313),w=n(920983),T=n(735286);n(224433);var b=n(59881),j=n(848755),E=n(932612),P=n(948648),N=n(945603),I=n(456984),R=n(536760);let A=new Set(["make","change","update","align","move","replace","add","remove","try","use","create","adjust","fix","tweak","resize","simplify","center","group","reorder","reposition","stretch","shorten","duplicate","rework","refine","restyle","animate","clean up","can we","could you","maybe try","what if we","let's","would it make sense to","should we","what about","how about","another idea","alternative","perhaps","maybe we could","I wonder if","could this be","is there a way to","would it help if","do you think we should","bigger","smaller","lighter","more consistent","less busy","heavier","more bold","bolder","clearer","more clear","softer","soften","more soft","sharp","sharper","cleaner","simpler","more contrast","less contrast","higher contrast","lower contrast","more consistent","more spacing","less spacing","more space","less space","tighter","denser","faster","slower","smoother","snappier","more readable","more legible","more aligned","less cluttered","more accessible","less accessible","hierarchy","spacing","consistency","padding","margin","grid","layout","alignment","balance","proportion","whitespace","white space","composition","frame","component","constraint","auto layout","column","section","flow","font","type","typography","weight","color","contrast","palette","accessibility","accessible","not accessible","consistency","consistent","inconsistent"]);var S=n(623134);function M(e){let t=(0,P.f)("seen_send_comment_to_make_upsell"),{contains:n,keyword:o}=function(e){let t=(0,R.md)(S.k);return e.id!==t?{contains:!1,keyword:null}:function(e,t){let n=e.toLowerCase();for(let e of t){let t=e.toLowerCase(),i=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(RegExp(`\\b${i}\\b`).test(n))return{contains:!0,keyword:t}}return{contains:!1,keyword:null}}(function e(t){let n="";for(let i of t)i.t&&(n+=i.t+" "),i.children&&(n+=e(i.children));return n}(e.message_meta),A)}(e.comment);return((0,T.h)(()=>{!t&&n&&(o&&b.az.trackDefinedEvent("activation.send_comments_to_make.keyword_triggered_from_comment",{keyword:o}),e.show())}),e.isShowing)?(0,i.jsx)(w.J,{brand:"seascape",children:(0,i.jsx)(k.bL,{variant:"strong",manager:e.manager,children:(0,i.jsx)(j.fu,{name:"Send Comment to Make Upsell Viewed",children:(0,i.jsxs)(v.vo,{className:"x1ncir08",children:[(0,i.jsx)(k.Y9,{children:(0,i.jsx)(v.hE,{autofocus:!0,children:(0,l.t)("figma_make_growth.send_this_comment_to_make")})}),(0,i.jsx)(v.nB,{children:(0,l.t)("figma_make_growth.you_can_now_use_comments")}),(0,i.jsx)(k.wi,{children:(0,i.jsx)(v.jk,{children:(0,i.jsx)(w.J,{brand:"bake-filebrowser",mode:"dark",children:(0,i.jsx)(C.$n,{variant:"primary",onClick:()=>{e.onCtaClick(),e.complete()},children:(0,l.t)("figmake.send_comments_to_make.upsell.cta")})})})})]})})})}):null}var D=n(229462),O=n(520356),L=n(99646),U=n(160686),F=(e=>(e.EDIT="edit",e.DELETE="delete",e.COPY_LINK="copy_link",e.TOGGLE_UNREAD="toggle_unread",e.SEND_TO_MAKE="send_to_make",e))(F||{});function K(e){let t=(0,m.I_)(),n=(0,o.wA)(),v=(0,O.iZ)(),C=(0,p.v)(),{onSendToMake:w}=function(e){let t=(0,o.wA)(),n=(0,g.p8)("currentPage"),i=(0,o.d4)(e=>e.comments.activeThread?.id??null),s=(0,_.uB)(i,n);return{onSendToMake:(0,u.useCallback)((n,i)=>{s&&((0,y.Cu)({trackingDescriptor:"ActiveThreadComment"===n?f.c.SEND_COMMENTS_TO_MAKE_OVERFLOW_MENU_CTA:f.c.SEND_COMMENTS_TO_MAKE_UPSELL_CTA}),(0,x.C)({type:"send-comments-to-make",entryPoint:n,newFileFrom:i,thread:s,comment:e,dispatch:t}))},[e,t,s])}}(e.comment),T=(0,h.vn)(),{manager:b,getTriggerProps:P}=a.b(),{getTriggerProps:R,...A}=function(){let{show:e,isShowing:t,complete:n}=(0,E.e)({overlay:I.Am9,priority:N.N.DEFAULT_MODAL}),{getTriggerProps:i,manager:o}=k.gR({isOpen:t,onOpenChange:e=>!e&&n(),placement:"right-start"});return{isShowing:t,manager:o,show:e,complete:n,getTriggerProps:i}}();(0,U.VX)(b);let S=t=>()=>{switch(t){case"edit":F();break;case"delete":e.onDelete(e.comment);break;case"copy_link":e.onCopyLink?e.onCopyLink(e.comment):C(e.comment);break;case"toggle_unread":K();break;case"send_to_make":w("ActiveThreadComment",L.f6.SEND_COMMENTS_TO_MAKE);break;default:(0,s.xb)(t)}},F=()=>{let{id:t,key:i,message_meta:o,attachments:s}=e.comment,a=(s||[]).reduce((e,t)=>(e[t.id]=t,e),{});n(c.Df({id:t,key:i,messageMeta:o,attachmentUpdates:{attachments:a,deleted:[]}}))},K=()=>{let i=t.commentReceipts;if(i){if(e.isUnread&&e.thread){n(c.AY({receiptsAPI:i,thread:e.thread}));return}n(c.QY({receiptsAPI:i,comment:e.comment}))}},W=e.comment.parent_id?(0,l.t)("comments.delete_comment"):(0,l.t)("comments.delete_thread"),V=e.isUnread?(0,l.t)("comments.mark_as_read"):(0,l.t)("comments.mark_as_unread"),H=(!e.possibleActions||e.possibleActions.includes("toggle_unread"))&&(0,i.jsx)(a.q7,{onClick:S("toggle_unread"),children:V},"toggle_unread"),z=(!e.possibleActions||e.possibleActions.includes("copy_link"))&&(0,i.jsx)(a.q7,{onClick:S("copy_link"),children:(0,l.tx)("comments.copy_link")},"copy_link"),B=(!e.possibleActions||e.possibleActions.includes("edit"))&&(0,i.jsx)(a.q7,{onClick:S("edit"),recordingKey:"commentOverflowMenu.editComment",children:(0,l.tx)("comments.edit")},"edit"),G=(!e.possibleActions||e.possibleActions.includes("delete"))&&(0,i.jsx)(a.q7,{onClick:S("delete"),recordingKey:"commentOverflowMenu.deleteComment",children:W},"delete"),$=(!e.possibleActions||e.possibleActions.includes("send_to_make"))&&(0,i.jsx)(a.q7,{onClick:S("send_to_make"),recordingKey:"commentOverflowMenu.sendToMake",children:(0,i.jsx)(j.fu,{name:"Send Comment to Make Action Viewed",children:(0,l.tx)("figmake.send_comments_to_make.overflow_menu.action")})},"send_to_make"),Q=e.comment.parent_id?[B,G]:[B],X=[];if(e.thread&&e.thread.id===e.comment.id)switch(e.thread.sidebarItemType){case D.kT.FEED_POST:X=[z];break;case D.kT.COMMENT_THREAD:case D.kT.LITMUS_COMMENT_THREAD:X=e.comment.user_id===v?.id?[H,z,G]:[H,z];break;default:(0,s.xb)(e.thread)}else e.comment.user_id===v?.id&&(X=X.concat(Q)),T&&X.push($);if(0===X.filter(Boolean).length)return null;let{onMouseDown:J,onPointerDown:q,...Y}=P();return null==e.thread&&T?(0,i.jsxs)(a.bL,{manager:b,children:[(0,i.jsx)(r.d,{"aria-label":e.label,recordingKey:e.recordingKey,...Y,children:(0,i.jsx)("span",{...R(),children:(0,i.jsx)(d.J,{})})}),(0,i.jsx)(a.mc,{children:X}),(0,i.jsx)(M,{...A,comment:e.comment,onCtaClick:()=>{w("ActiveThreadComment > SendCommentsToMakeUpsell",L.f6.SEND_COMMENTS_TO_MAKE_UPSELL)}})]}):(0,i.jsxs)(a.bL,{manager:b,children:[(0,i.jsx)(r.d,{"aria-label":e.label,recordingKey:e.recordingKey,...Y,children:(0,i.jsx)(d.J,{})}),(0,i.jsx)(a.mc,{children:X})]})}},160686:(e,t,n)=>{n.d(t,{Dp:()=>d,VX:()=>c,i:()=>l});var i=n(536760);let{useRegisterMenu:o,open:s,close:a,isOpenAtom:r}=(0,n(132841).K)(),d=3679!=n.j?a:null,l=()=>(0,i.fp)(r)[0],c=3679!=n.j?o:null},774479:(e,t,n)=>{if(n.d(t,{Op:()=>o,gV:()=>s,nr:()=>a}),3679!=n.j)var i=n(429356);function o(e){let t=new Map,n=new Map;for(let{id:i,...o}of e.states){if(t.has(i))throw Error(`Duplicate state ID ${i.toString()} found when building state machine`);if(t.set(i,o),null==o.transitions)continue;let e=new Map;for(let{event:t,...s}of(n.set(i,e),o.transitions)){let n=e.get(t);null==n&&(n=[],e.set(t,n)),n?.push(s)}}return{config:e,isComplete(e){let n=t.get(e);return n?.terminal??!1},isInitial:t=>t===e.initial,start:()=>e.initial,transition(e,t){let i=n.get(e)?.get(t.id);if(null==i)return null;for(let n of i)if(null==n.condition||n.condition({from:e,to:n.target,event:t}))return n.target;return null}}}function s(e){let t=new Set;for(let n of e.config.states)if(null!=n.transitions)for(let e of n.transitions)e.event===i.b&&e.meta?.userEvents!=null&&e.meta.userEvents.forEach(e=>t.add(e));return t}function a(e,t,n){var o,s;let a=new Set("string"==typeof e?[e]:e),r={userEvents:[...a]};return o=i.b,s={condition:e=>a.has(e.event.type)&&(n?.condition?.(e)??!0),meta:r},{event:o,target:t,condition:s?.condition,meta:s?.meta}}},939574:(e,t,n)=>{n.d(t,{rn:()=>l});var i=n(536760),o=n(490432);if(3679!=n.j)var s=n(774479);if(3679!=n.j)var a=n(429356);if(3679!=n.j)var r=n(688264);let d=new Map;function l(e,t){let n=function(e,t){if(d.has(e))return null;let n=(0,s.gV)(t),l=function(e){let t={currentState:e.start(),lastEvent:null,previousState:null};return(0,i.um)(t,(n,i)=>{switch(i?.type){case"RESET":return t;case"TRANSITION":return function(t,n){let i=e.transition(t.currentState,n);return null!=i?{currentState:i,lastEvent:n,previousState:t.currentState}:t}(n,i.payload.event);default:return n}})}(t),c=(0,i.eU)(e=>e(l),(e,t)=>t(l,{type:"RESET"})),m=e=>{let{id:t,properties:o}="properties"in e?e:{id:e.id,properties:void 0};if(!(0,r.Tl)(t,n))return;let s={id:a.b,type:t,properties:o??{}};i.zl.set(l,{type:"TRANSITION",payload:{event:s}})};return(0,r.eR)(i.zl.get(o.az),n,m),d.set(e,{clear:()=>{d.delete(e),(0,r.BD)(i.zl.get(o.az),n,m)},reset:()=>{let e=i.zl.get(o.az);(0,r.BD)(e,n,m),(0,r.eR)(e,n,m)}}),{machine:t,name:e,_atom:c}}(e,t);if(null==n)throw Error(`Registering state machine with name ${e} already in use`);return n}},429356:(e,t,n)=>{n.d(t,{b:()=>i});let i="@@userEvent"},128361:(e,t,n)=>{if(n.d(t,{Op:()=>i.Op,nr:()=>i.nr,rn:()=>o.rn}),3679!=n.j)var i=n(774479);var o=n(939574);n(316569)},688264:(e,t,n)=>{function i(e,t){return t.has(e)}function o(e,t,n){for(let i of t)e.addEventListener(i,n)}function s(e,t,n){for(let i of t)e.removeEventListener(i,n)}n.d(t,{BD:()=>s,Tl:()=>i,eR:()=>o})},174538:(e,t,n)=>{n.d(t,{C:()=>v});var i=n(711839),o=n(468882),s=n(536760),a=n(59881),r=n(614291),d=n(553538),l=n(931330),c=n(866962),m=n(266132),h=n(409459),p=n(428444),u=n(278995),_=n(202039),f=n(251291),y=n(635278),g=n(801283);let x={FULLSCREEN_UNAVAILABLE:"fullscreen-unavailable",SOMETHING_WENT_WRONG:"something-went-wrong",MORE_THAN_MAXIMUM_ALLOWED_NODES_SELECTED:"more-than-maximum-allowed-nodes-selected",NO_VALID_FIGJAM_SELECTION:"no-valid-figjam-selection",CONTEXT_WINDOW_EXCEEDED:"context-window-exceeded"};function k(e,t,n,i){let o=(0,h.Kl)(t);i((0,l.zE)({state:o,from:n,editorType:p._Y.FIGMAKE,team:void 0,openNewFileIn:y.ai.NEW_TAB,newFileDataLocalStorageKey:e}))}function v(e){var t,n,l;let h=r.D.getState(),p=h.openFile,y=h.fileVersion,v=h.user?.id??null,C="fullscreen"===h.selectedView.view?h.selectedView.editorType:null;switch(e.type){case"send-to-make-from-design":case"send-to-make-from-devmode":(t={...e,openFile:p,fileVersion:y,userId:v},new Promise((e,n)=>{let o=(0,i.UN)(),a=o.getCurrentPage()?.guid,r=o.getDirectlySelectedNodes(),d=r.map(e=>e.guid),l=d.join(","),m={entryPoint:t.entryPoint,userId:t.userId,fileKey:t.openFile?.key,fileVersion:t.fileVersion,pageGuid:a,selectedNodeId:l};if(0===r.length||!t.openFile||null===t.fileVersion||!a){n({key:x.SOMETHING_WENT_WRONG,trackingProperties:m});return}if(r.length>3){n({key:x.MORE_THAN_MAXIMUM_ALLOWED_NODES_SELECTED,trackingProperties:m});return}let h=function(){let e=(0,_.gP)("make_large_paste_threshold").get("sizeBytes",25e4);return u.glU?.isActiveCanvasSelectionWithinThreshold(e)??null}();if(null===h){n({key:x.FULLSCREEN_UNAVAILABLE,trackingProperties:m});return}e({localStorageKey:s.zl.set(c.Fk,{type:t.type,fileKey:t.openFile.key,fileVersion:t.fileVersion,source:t.entryPoint,exceedsMakePasteThreshold:!h,selectedNodeIds:d,pageGuid:a}),trackingProperties:{pageId:a,nodeId:l,userId:t.userId,fileKey:t.openFile.key,fileVersion:t.fileVersion,exceedsMakePasteThreshold:!h,isViewOnly:t.openFile.canView&&!t.openFile.canEdit}})})).then(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMake`,status:"success"}),k(t.localStorageKey,h,e.newFileFrom,e.dispatch)}).catch(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMake`,status:"error",error:t.key}),e.dispatch(d.F.enqueue({message:(0,o.t)("figmake.send_to_make_from_design.error.something-went-wrong"),type:"send-to-make-from-design-error",error:!0}))});break;case"send-comments-to-make":(n={...e,openFile:p,fileVersion:y,userId:v},new Promise((e,t)=>{let o=(0,i.UN)(),a=o.getCurrentPage()?.guid,r={entryPoint:n.entryPoint,userId:n.userId,fileKey:n.openFile?.key,fileVersion:n.fileVersion,pageGuid:a};if(!n.openFile||null===n.fileVersion||!a){t({key:x.SOMETHING_WENT_WRONG,trackingProperties:r});return}let d=(0,f.aT)(n.comment),l=function(e){if(!(0,i.UN)())return null;let t=e.comments?.[0]?.client_meta?.node_id??null;return t&&u.glU?.canBeConvertedToCodeLayer(t)?t:null}(n.thread),m={type:"send-comments-to-make",fileKey:n.openFile.key,fileVersion:n.fileVersion,source:n.entryPoint,selectedNodeId:l??void 0,pageGuid:a};e({localStorageKey:s.zl.set(c.Fk,{...m,comments:[d]}),trackingProperties:{pageId:a,userId:n.userId,fileKey:m.fileKey,fileVersion:n.fileVersion,selectedNodeId:l??void 0,isViewOnly:n.openFile.canView&&!n.openFile.canEdit}})})).then(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMake`,status:"success"}),k(t.localStorageKey,h,e.newFileFrom,e.dispatch)}).catch(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMake`,status:"error",error:t.key}),e.dispatch(d.F.enqueue({message:(0,o.t)("figmake.send_to_make_from_design.error.something-went-wrong"),type:"send-to-make-from-design-error",error:!0}))});break;case"send-to-make-from-figjam":(l={...e,openFile:p,fileVersion:y,userId:v},new Promise((e,t)=>{let n;let o=(0,i.UN)(),r=o.getCurrentPage()?.guid,d=o.getDirectlySelectedNodes(),m=d?.[0]?.guid,h=(0,g.B1)(o),p={entryPoint:l.entryPoint,userId:l.userId,fileKey:l.openFile?.key,fileVersion:l.fileVersion,pageGuid:r};if(!l.openFile||null===l.fileVersion||!r||0===h.length){t({key:x.SOMETHING_WENT_WRONG,trackingProperties:p});return}try{n=(0,g.Oo)(h)}catch(e){t({key:e?.message??x.SOMETHING_WENT_WRONG,trackingProperties:p});return}if(0===n.length){(0,a.sx)("activation.send_to_make_from_figjam.no_valid_selection",{},{forwardToDatadog:!0}),t({key:x.NO_VALID_FIGJAM_SELECTION,trackingProperties:p});return}let u={type:"send-to-make-from-figjam",fileKey:l.openFile.key,fileVersion:l.fileVersion,source:l.entryPoint,selectedNodeId:m??void 0,pageGuid:r};e({localStorageKey:s.zl.set(c.Fk,{...u,textNodes:n}),trackingProperties:{pageId:r,userId:l.userId,fileKey:u.fileKey,fileVersion:l.fileVersion,selectedNodeId:m??void 0,isViewOnly:l.openFile.canView&&!l.openFile.canEdit}})})).then(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMakeFromFigJam`,status:"success"}),k(t.localStorageKey,h,e.newFileFrom,e.dispatch)}).catch(t=>{(0,m.Cu)({editorType:C,...t.trackingProperties,trackingContext:`${e.entryPoint} > SendToMakeFromFigJam`,status:"error",error:t.key}),t.key===x.NO_VALID_FIGJAM_SELECTION?e.dispatch(d.F.enqueue({message:(0,o.t)("figmake.send_to_make_from_design.error.no-valid-figjam-selection"),type:"send-to-make-from-design-error",error:!1})):t.key===x.CONTEXT_WINDOW_EXCEEDED?e.dispatch(d.F.enqueue({message:(0,o.t)("figmake.send_to_make_from_figjam.error.context-window-exceeded"),type:"send-to-make-from-design-error",error:!1})):e.dispatch(d.F.enqueue({message:(0,o.t)("figmake.send_to_make_from_design.error.something-went-wrong"),type:"send-to-make-from-design-error",error:!0}))})}}},607329:(e,t,n)=>{if(n.d(t,{Dr:()=>s,aT:()=>a,cM:()=>o}),3679!=n.j)var i=n(414393);var o=(e=>(e.NODE="node",e.IMAGE="image",e.VIDEO="video",e.PROTOTYPE="prototype",e))(o||{});function s(e){switch(e.type){case"node":case"image":return!0;case"video":case"prototype":return!1;default:(0,i.xb)(e)}}function a(e){switch(e.type){case"node":return!0;case"image":return"image/gif"!==e.mediaType;case"video":case"prototype":return!1;default:(0,i.xb)(e)}}},587839:(e,t,n)=>{n.d(t,{A:()=>m});var i=n(104076),o=n(716976),s=n(511570),a=n.n(s),r=n(873304),d=n(128212),l=n(469790),c=n(467660);let m=function(e){let t=r.il.getDefaultSkin(),[n,s]=o.useState(t?t-1:0),m=t=>{t+=1,c.Y5.triggerAction("set-default-emoji-skin-tone",{newEmojiSkinTone:t}),e.onInsert(),setTimeout(()=>{e.onClear()},50)},{forceCloseSkinToneSelector:h}=e,p=o.useCallback(()=>(h(),!0),[h]);(0,l.O1)(p,l.KD.EDITING_TEXT_FIELD);let u=t=>{let i=e.allSkinTones.length;t.keyCode===d.Uz.UP_ARROW||t.keyCode===d.Uz.LEFT_ARROW?(t.stopPropagation(),t.preventDefault(),s((n-1+i)%i)):t.keyCode===d.Uz.DOWN_ARROW||t.keyCode===d.Uz.RIGHT_ARROW?(t.stopPropagation(),t.preventDefault(),s((n+1)%i)):(t.keyCode===d.Uz.ENTER||t.keyCode===d.Uz.TAB)&&(t.stopPropagation(),t.preventDefault(),m(e.allSkinTones[n].skin))},_=e=>s(e),f=e=>n===e;return o.useEffect(()=>(window.addEventListener("keydown",u,{capture:!0}),()=>window.removeEventListener("keydown",u,{capture:!0}))),(0,i.jsx)("div",{role:"listbox",onKeyDown:u,className:"skin_tone_selector--skinToneSelect--y6dln",tabIndex:0,children:e.allSkinTones.map((t,n)=>(0,i.jsx)("div",{role:"option",tabIndex:-1,onPointerUp:()=>m(n),onPointerEnter:()=>_(n),className:a()({"skin_tone_selector--emojiWrapper--ShVCf":!0,"skin_tone_selector--figJamEditorSkinToneEmojiSelected--Xy7zc":f(n)&&!e.isComments&&e.isFigJam,"skin_tone_selector--skinToneEmojiSelected--j523O":f(n)&&(e.isComments||!e.isFigJam)}),"aria-selected":f(n),children:(0,i.jsx)("img",{className:"skin_tone_selector--skinToneEmojiPreview--6BIz1",src:t.src,alt:""},t.src)},`${t.emojiName}-${t.skin}`))})}},194558:(e,t,n)=>{n.d(t,{p:()=>i});let i=(0,n(536760).eU)("")},25996:(e,t,n)=>{n.d(t,{E:()=>I});var i=n(104076),o=n(801708),s=n(468882),a=n(38989),r=n(536760),d=n(511570),l=n.n(d),c=n(133202),m=n(590248),h=n(790476),p=n(144811),u=n(402403),_=n(229462),f=n(818475),y=n(616098),g=n(651376),x=n(119369),k=n(691431),v=n(263638),C=n(194558);let w="mentions_typeahead--mentionsTypeahead--0G1Mt",T="mentions_typeahead--communityMentionsTypeahead--d2hdN mentions_typeahead--mentionsTypeahead--0G1Mt",b="mentions_typeahead--commentsMentionsTypeaheadDown--GaGMe",j="mentions_typeahead--commentsMentionsTypeaheadUp--Ovlxr",E="mentions_typeahead--mentionsTypeaheadHeader--3mbyK",P="mentions_typeahead--name--08XKn mentions_typeahead--profileItem--eA3Qi",N=(0,c.jz)("132px")+8;function I(e){let t=(0,r.Xr)(C.p);return(0,i.jsx)(R,{...e,setMentionIdAtom:t,isUI3:!0})}class R extends m.uA{constructor(e){super(e),this.pointerMoved=!1,this.onMentionTypeaheadClick=e=>{this.props.onInsert(),this.props.setTypeahead(null),"profile_handle"in this.props.typeahead.mentions[e]&&this.props.dispatch((0,u.Hx)(this.props.typeahead.mentions[e]))},this.placeMention=e=>{this.props.setTypeahead({...this.props.typeahead,index:e})},this.generateTypeaheadItems=(e,t=0)=>{let n=e=>{let t="handle"in e?e.handle:null,n=null;if((0,y.d)(e))n=(0,i.jsx)("div",{className:P,children:e.name});else if(this.props.entity.id===e.id){let o=t??e.name;n=(0,i.jsx)("div",{className:P,children:(0,s.tx)("comments.name_and_you",{name:o||""})})}else n="email"in e?(0,i.jsx)(v._,{className:P,email:e.email||null,displayString:e.handle}):(0,i.jsx)("div",{className:P,children:e.name||t||""});return n},o=e=>(0,y.d)(e)?(0,s.t)("user_groups.num_people_no_parentheses",{num:e.member_count}):"profile_handle"in e?`@${e.profile_handle}`:e.id.startsWith("invite-")?(0,s.t)("comments.invited"):e.email,r=e=>(0,y.d)(e)?(0,i.jsx)(p.q,{size:h.Pf.MEDIUM30,userGroup:e}):(0,i.jsx)(x.Ro,{entity:e}),d=e=>{if(!(0,y.d)(e))return;let t=(0,f.yE)(e.preview_members,e.member_count);if(t)return{"data-tooltip-type":g.Ib.TEXT,"data-tooltip":t,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":220}};return e.map((e,s)=>{if((0,y.d)(e)&&(!(0,a.kc)().user_groups||!(0,a.kc)().user_groups_at_mentions))return null;let l=n(e),c=o(e),h=r(e),p=this.props.getAdditionalMetadata?.(e),u=this.props.typeahead.index===s+t,_=d(e);return(0,i.jsxs)(k.Hn,{__tempScreenReaderFixAriaSelected:!0,className:this.props.isCommunityMentions?"mentions_typeahead--communityMentionsTypeaheadRow--eL1iz mentions_typeahead--mentionsTypeaheadRow--2EwXX text--fontPos12--YsUAh text--_fontBase--QdLsd":"mentions_typeahead--mentionsTypeaheadRow--2EwXX",id:e.id,onClick:()=>{this.onMentionTypeaheadClick(s+t)},onPointerDown:()=>{this.pointerMoved=!0,this.placeMention(s+t)},onPointerOver:()=>{this.pointerMoved&&this.placeMention(s+t)},recordingKey:m.Pt(this.props.recordingKey,s+t,"item"),selected:u,selectedClassName:this.props.isCommunityMentions?"mentions_typeahead--communityMentionsTypeaheadRowSelected--pPzO6":"mentions_typeahead--mentionsTypeaheadRowSelected--AEr6h",children:[(0,i.jsx)("div",{className:"mentions_typeahead--avatar--Po0PL",children:h}),(0,i.jsxs)("div",{className:"mentions_typeahead--profile--C1inz",children:[l,(0,i.jsxs)("div",{className:"mentions_typeahead--metadata--BJOWW mentions_typeahead--profileItem--eA3Qi","data-testid":"mention-typeahead-metadata",children:[!!c&&(0,i.jsx)("span",{className:"mentions_typeahead--email--Sc3Kt",..._,children:c}),!!p&&(0,i.jsxs)("span",{className:"mentions_typeahead--additionalMetadata--r6A38",children:[c?" \u2022 ":"",p]})]})]})]},e.id)}).filter(Boolean)},this.setMaxTypeaheadHeight()}setMaxTypeaheadHeight(){this.props.setMaxTypeaheadHeight&&(this.props.isCommunityMentions?this.props.setMaxTypeaheadHeight((0,c.jz)("216px")):this.props.setMaxTypeaheadHeight(this.props.typeahead.maxMentions*(0,c.jz)("48px")))}componentDidUpdate(e){e.typeahead.mentions!==this.props.typeahead.mentions&&(this.pointerMoved=!1),(this.props.setMaxTypeaheadHeight!==e.setMaxTypeaheadHeight||this.props.typeahead.maxMentions!==e.typeahead.maxMentions||this.props.isCommunityMentions!==e.isCommunityMentions)&&this.setMaxTypeaheadHeight(),this.props.typeahead.index!==e.typeahead.index&&this.props.setMentionIdAtom(this.props.typeahead.mentions[this.props.typeahead.index]?.id??"")}render(){let e=()=>this.pointerMoved=!0,t=(0,k.f6)(this.props);if(this.props.typeahead.mentions.some(e=>e.id.startsWith("invite-"))){let n=this.props.typeahead.mentions.filter(e=>e.id.startsWith("invite-")),o=this.generateTypeaheadItems(n),a=this.props.typeahead.mentions.filter(e=>!e.id.startsWith("invite-")),r=this.generateTypeaheadItems(a,o.length),d=(0,i.jsx)("div",{className:E,style:{padding:6},children:(0,s.tx)("comments.invited")},"mentions-typeahead-top-padding-div"),c=(0,i.jsx)("div",{className:E,style:{padding:6},children:(0,s.tx)("comments.with_access")},"mentions-typeahead-bottom-padding-div"),m=[];return o.length>0&&(m.push(d),m.push(...o)),r.length>0&&(m.push(c),m.push(...r)),(0,i.jsxs)(k.xD,{className:l()({[T]:this.props.isCommunityMentions,[w]:!this.props.isCommunityMentions,[b]:this.props.isComments&&this.props.direction===k.ri.DOWNWARDS,[j]:this.props.isComments&&this.props.direction===k.ri.UPWARDS}),dataTestId:this.props.dataTestId,dispatchTypeahead:this.props.setTypeahead,id:_.Qd,onClear:this.props.onClear,onInsert:this.props.onInsert,onPointerMove:e,typeahead:this.props.typeahead,width:this.props.width,zIndex:this.props.zIndex,...t,children:[...m]})}{let n=this.generateTypeaheadItems(this.props.typeahead.mentions),a=(0,i.jsx)("div",{style:{height:6}},"mentions-typeahead-top-padding-div"),r=(0,i.jsx)("div",{style:{height:6}},"mentions-typeahead-bottom-padding-div"),d=this.props.isUI3?[...n]:[a,...n,r];if(this.props.typeahead.search&&this.props.typeahead.search.length>0){let e=(0,i.jsxs)("span",{style:{maxWidth:this.props.width-N},className:"mentions_typeahead--noMatchesFoundSearchTerm--smkuY",children:[(0,s.tx)("comments.at_mention"),this.props.typeahead.search]}),t=(0,i.jsx)(o.T,{role:"alert",children:(0,i.jsx)("div",{className:"mentions_typeahead--noMatchesFoundRow--9mNPs",children:(0,i.jsx)("span",{className:"mentions_typeahead--noMatchesFoundText--anK6N text--fontPos12--YsUAh text--_fontBase--QdLsd",style:{maxWidth:this.props.width},children:(0,s.tx)("comments.no_users_matched_your_search",{searchQuery:e})})},"mentions-typeahead-no-matches-div")});d=this.props.isUI3?[t]:[a,t,r]}return(0,i.jsx)(k.xD,{ariaLabel:(0,s.t)("comments.at_mention_listbox_label"),className:l()({[T]:this.props.isCommunityMentions,[w]:!this.props.isCommunityMentions,[b]:this.props.isComments&&this.props.direction===k.ri.DOWNWARDS,[j]:this.props.isComments&&this.props.direction===k.ri.UPWARDS}),dataTestId:this.props.dataTestId,dispatchTypeahead:this.props.setTypeahead,id:_.Qd,onClear:this.props.onClear,onInsert:this.props.onInsert,onPointerMove:e,typeahead:this.props.typeahead,width:this.props.width,zIndex:this.props.zIndex,...t,children:d})}}}R.displayName="MentionsTypeaheadView"},691431:(e,t,n)=>{n.d(t,{ri:()=>c,Hn:()=>h,xD:()=>m,f6:()=>p});var i=n(104076),o=n(716976),s=n(278995),a=n(511570),r=n.n(a),d=n(128212),l=n(590248),c=(e=>(e.UPWARDS="upwards",e.DOWNWARDS="downwards",e))(c||{});class m extends l.o6{constructor(){super(...arguments),this.isPointerInTypeaheadView=!0,this.getPositionStyle=()=>{if(this.props.useFixedPosition){let e=this.props.targetRect.left;return"downwards"===this.props.direction?{top:this.props.targetRect.bottom,left:e}:this.props.useWindowAsViewport?{bottom:window.innerHeight-this.props.targetRect.top,left:e}:s.NfO?{bottom:s.NfO.getViewportBounds().height-this.props.targetRect.top,left:this.props.targetRect.left}:{top:this.props.targetRect.bottom,left:this.props.targetRect.left}}if("downwards"===this.props.direction){let{left:e,bottom:t}=this.props.targetRect;return{transform:`translate(${e}px, ${t}px)`,WebkitTransform:`translate(${e}px, ${t}px)`}}if("upwards"===this.props.direction){let{left:e,bottom:t}=this.props.positionFromBottom;return{left:e,bottom:t}}},this.handleKeyDown=l.C0(this,"keydown",e=>{if(this.props.shouldNotHandleKeyDown)return;let t=!0,n=this.props.typeahead,i=o.Children.count(this.props.children?.filter(e=>o.isValidElement(e)&&e.type===h)),s=null;if(e.keyCode!==d.Uz.DOWN_ARROW||e.ctrlKey||e.altKey||e.shiftKey||e.metaKey){if(e.keyCode!==d.Uz.UP_ARROW||e.ctrlKey||e.altKey||e.shiftKey||e.metaKey){if((e.keyCode===d.Uz.DOWN_ARROW||e.keyCode===d.Uz.UP_ARROW)&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)){this.props.onClear();return}}else s="suggestions"===this.props.typeahead.type&&-1===n.index?i-1:(i+n.index-1)%i}else s=(n.index+1)%i;(e.keyCode===d.Uz.ENTER||e.keyCode===d.Uz.TAB)&&(e.stopPropagation(),e.preventDefault(),s=n.index,"suggestions"===n.type&&this.props.trackEvent&&this.props.trackEvent("comments_suggestions_picker_selected_item",{commentSuggestion:n.suggestedComments[n.index].suggestionsKey,commentSuggestionIndex:n.index+1}),this.props.onInsert(),this.props.shouldNotClearOnEnter&&(t=!1)),"suggestions"===this.props.typeahead.type&&this.props.isOneLineOfSuggestions&&!(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(e.keyCode===d.Uz.RIGHT_ARROW?s=(n.index+1)%i:e.keyCode===d.Uz.LEFT_ARROW&&(s=(i+n.index-1)%i)),null!==s&&this.props.dispatchTypeahead({...this.props.typeahead,index:s}),e.keyCode===d.Uz.ESCAPE||"suggestions"!==this.props.typeahead.type&&(e.keyCode===d.Uz.TAB||e.keyCode===d.Uz.ENTER||e.keyCode===d.Uz.LEFT_ARROW||e.keyCode===d.Uz.RIGHT_ARROW)?setTimeout(()=>{t&&this.props.onClear()},50):"suggestions"===this.props.typeahead.type&&(e.keyCode===d.Uz.ENTER||e.keyCode===d.Uz.TAB)&&this.props.dispatchTypeahead(null)}),this.handlePointerUp=l.Am(this,"pointerup",()=>{this.holdTimeout&&(clearTimeout(this.holdTimeout),this.props.setIsPointerDownInTypeahead?.(!1),this.isPointerInTypeaheadView||this.props.setWasPointerDownInTypeahead?.(!1))}),this.handlePointerDown=l.Am(this,"pointerdown",e=>{e.stopPropagation(),e.preventDefault(),this.holdTimeout=window.setTimeout(()=>{this.props.setIsPointerDownInTypeahead?.(!0),this.props.setWasPointerDownInTypeahead?.(!0)},500)}),this.handlePointerEnter=()=>this.isPointerInTypeaheadView=!0,this.handlePointerLeave=()=>this.isPointerInTypeaheadView=!1,this.pointerUpHandler=()=>{this.isPointerInTypeaheadView||this.props.setWasPointerDownInTypeahead?.(!1)}}componentDidMount(){super.componentDidMount(),window.addEventListener("keydown",this.handleKeyDown,{capture:!0}),window.addEventListener("pointerup",this.pointerUpHandler)}componentWillUnmount(){super.componentWillUnmount(),window.removeEventListener("keydown",this.handleKeyDown,{capture:!0}),window.removeEventListener("pointerup",this.pointerUpHandler)}render(){let e=(0,i.jsx)("div",{"aria-label":this.props.ariaLabel,className:r()("typeahead--typeahead--R3Cas",this.props.className,"downwards"===this.props.direction&&"typeahead--openDownwards--qftyz"),"data-testid":this.props.dataTestId,id:this.props.id,onKeyDown:this.handleKeyDown,onPointerDown:this.handlePointerDown,onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave,onPointerMove:this.props.onPointerMove,onPointerUp:this.handlePointerUp,role:"listbox",style:{...this.getPositionStyle(),width:this.props.width,zIndex:this.props.zIndex},tabIndex:-1,children:this.props.children});return this.props.useFixedPosition?(0,i.jsx)("div",{className:"typeahead--fixedTypeaheadContainer--wzT8k",children:e}):e}}m.displayName="TypeaheadView";class h extends l.uA{constructor(){super(...arguments),this.containerRef=o.createRef(),this.handlePointerDown=l.Am(this,"pointerdown",e=>this.props.onPointerDown()),this.handlePointerUp=l.Am(this,"pointerup",()=>this.props.onClick())}componentDidUpdate(e,t){super.componentDidUpdate(e,t),!e.selected&&this.props.selected&&this.containerRef.current?.scrollIntoView({block:"nearest"})}render(){let e=this.props.className;this.props.selected&&(e+=" "+this.props.selectedClassName);let t=this.props.__tempScreenReaderFixAriaSelected?void 0:this.props.selected;return(0,i.jsx)("div",{role:"option",tabIndex:-1,"aria-selected":t,className:e,onPointerDown:this.handlePointerDown,onPointerUp:this.handlePointerUp,onPointerOver:this.props.onPointerOver,ref:this.containerRef,id:this.props.id,children:this.props.children})}}function p(e){return{...e.useFixedPosition?{useFixedPosition:!0,targetRect:e.targetRect,direction:e.direction}:"downwards"===e.direction?{targetRect:e.targetRect,direction:"downwards"}:{positionFromBottom:e.positionFromBottom,direction:"upwards"},useWindowAsViewport:e.useWindowAsViewport}}h.displayName="TypeaheadItem"},53559:(e,t,n)=>{n.d(t,{E:()=>d});var i=n(104076),o=n(716976),s=n(468882),a=n(219155),r=n(834265);let d=(0,n(605020).Ju)(function({comment:e,onCancel:t,onClose:n,onConfirm:d,onConfirmComplete:l,...c}){let m=o.useCallback(()=>{d(),n(),l?.()},[n,d,l]),h=o.useCallback(()=>{n(),t?.()},[n,t]);return(0,i.jsx)(r.R,{autofocusConfirm:!0,onCancel:h,onConfirm:m,onClose:a.lQ,confirmText:(0,s.t)("general.delete"),destructive:!0,recordingKey:"commentDeleteConfirmModal",title:(0,s.t)("comments.delete_comment"),...c,children:!e||e.parent_id?(0,s.t)("comments.are_you_sure_you_want_to_delete_this_comment_this_action_cannot_be_undone"):(0,s.t)("comments.delete_confirmation_thread")})},"confirm-comment-deletion-modal")},903217:(e,t,n)=>{n.d(t,{J:()=>a});var i=n(536760),o=n(7438);let s={messageIndex:-1,fileSequenceNumber:0,chatMessageId:"",versionName:null,sourceCodeHash:""},a=(0,o.Wh)(()=>(0,i.eU)(s))},124928:(e,t,n)=>{n.d(t,{gk:()=>s,iw:()=>o});let i="feed_post_";function o(e){return`${i}${e.replace(/-/g,"_")}`}function s(e){if(e.startsWith(i))return e.slice(i.length).replace(/_/g,"-");throw Error("Thread ID is not in valid format for feed post")}},587825:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(716976),o=n(104076);let s=(0,i.memo)(function(e){return(0,o.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,o.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M12 5a7 7 0 1 1 0 14 7 7 0 0 1 0-14m0 1a6 6 0 1 0 0 12 6 6 0 0 0 0-12m-3.18 7a.56.56 0 0 1 .492.325 2.996 2.996 0 0 0 5.377 0 .56.56 0 0 1 .49-.325h.05c.327 0 .566.31.434.61a4.001 4.001 0 0 1-7.326 0c-.132-.3.108-.61.434-.61zM10 10a1 1 0 1 1 0 2 1 1 0 0 1 0-2m4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"})})})},116039:(e,t,n)=>{n.d(t,{V:()=>s});var i=n(716976),o=n(104076);let s=(0,i.memo)(function(e){return(0,o.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,o.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M9.5 6a.5.5 0 0 1 0 1h-2a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 6 16.5v-9A1.5 1.5 0 0 1 7.5 6zm8 0a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0V7.707l-4.146 4.147a.5.5 0 1 1-.707-.707L16.293 7H12.5a.5.5 0 0 1 0-1z"})})})},274086:(e,t,n)=>{n.d(t,{T:()=>s});var i=n(716976),o=n(104076);let s=(0,i.memo)(function(e){return(0,o.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,o.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"m12.705 15.816-.705-.7-.705.7L9 18.096V6.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v11.597zm1.59 2.99L12 16.526l-2.295 2.28c-.631.627-1.705.18-1.705-.71V6.5A1.5 1.5 0 0 1 9.5 5h5A1.5 1.5 0 0 1 16 6.5v11.597c0 .89-1.074 1.336-1.705.71",clipRule:"evenodd"})})})}}]);

//# debugId=ae48c010-4cc0-5eb5-82d4-56136e66c11f

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/cc043e2953b71fb8d6d52bee108c610cf88e6d75/7888-75a2c7b9d7780165.min.js.map