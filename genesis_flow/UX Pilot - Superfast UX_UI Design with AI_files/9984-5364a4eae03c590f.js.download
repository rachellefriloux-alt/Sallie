"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9984],{29984:function(e,t,n){n.d(t,{CJ:function(){return WireframerProvider},xP:function(){return usePageStructure},Al:function(){return useWireframer},ss:function(){return useWireframerLoading}});var r,i=n(45610),s=n(21575),a=n(41369),o=n(43654),u=n(9),d=n(44313),l=n(50044),c=n(57437),p=n(24033),f=n(2265),m=n(81508),g=n(19676),h=n(78906),v=n(86335),y=n(62270),w=n(715),S=n(55688),_=n(21889),I=n(60453),E=n(90012),A=n(52997),C=n(15203),T=n(75104),D=n(46095),b=function(){function DesignData(){(0,v._)(this,DesignData),this.pages=new Map,this.groups=new Map,this.shapes=new Map,this.wireframes=new Map,this.assets=new Map,this.pageToGroups=new Map,this.pageToShapes=new Map,this.pageToAssets=new Map,this.groupToWireframes=new Map}var e=DesignData.prototype;return e.getPage=function(e){return e&&this.pages.get(e)||null},e.getGroup=function(e){return e&&this.groups.get(e)||null},e.getShape=function(e){return e&&this.shapes.get(e)||null},e.getWireframe=function(e){return e&&this.wireframes.get(e)||null},e.getAsset=function(e){return e&&this.assets.get(e)||null},e.getItem=function(e,t){if(!e||!t)return null;var n=this["".concat(e,"s")];return n&&n.get(t)||null},e.getPageGroups=function(e){var t=this;return e?Array.from(this.pageToGroups.get(e)||new Set).map(function(e){return t.groups.get(e)}).filter(Boolean):[]},e.getPageShapes=function(e){var t,n=this;return e?Array.from(null!==(t=this.pageToShapes.get(e))&&void 0!==t?t:new Set).map(function(e){return n.shapes.get(e)}).filter(Boolean):[]},e.getPageAssets=function(e){var t,n=this;return e?Array.from(null!==(t=this.pageToAssets.get(e))&&void 0!==t?t:new Set).map(function(e){return n.assets.get(e)}).filter(Boolean):[]},e.getGroupWireframes=function(e){var t,n=this;return e?Array.from(null!==(t=this.groupToWireframes.get(e))&&void 0!==t?t:new Set).map(function(e){return n.wireframes.get(e)}).filter(Boolean).sort(function(e,t){return((null==e?void 0:e.order)||0)-((null==t?void 0:t.order)||0)}):[]},e.getPageStructure=function(e){var t=this,n=this.getPage(e);if(n){var r=this.getPageGroups(e).filter(function(e){return e&&e.id}).sort(function(e,t){return new Date((null==e?void 0:e.createdAt)||0).getTime()-new Date((null==t?void 0:t.createdAt)||0).getTime()}).map(function(e){var n;return(0,o._)((0,a._)({},e),{wireframes:(null===(n=t.getGroupWireframes(e.id))||void 0===n?void 0:n.sort(function(e,t){return((null==e?void 0:e.order)||0)-((null==t?void 0:t.order)||0)}))||[]})}).filter(function(e){return e.wireframes.length>0}),i=this.getPageShapes(e)||[],s=this.getPageAssets(e)||[];return(0,o._)((0,a._)({},n),{groups:r,shapes:i,assets:s})}},e.getAllPages=function(){return Array.from(this.pages.values())},e.getAllGroups=function(){return Array.from(this.groups.values())},e.getAllShapes=function(){return Array.from(this.shapes.values())},e.getAllAssets=function(){return Array.from(this.assets.values())},e.getAllWireframes=function(){return Array.from(this.wireframes.values())},e.findWireframeByRetryId=function(e){return this.getAllWireframes().find(function(t){return t.retryId===e})},e.findAssetParentPage=function(e){var t=!0,n=!1,r=void 0;try{for(var i,s=Array.from(this.pageToAssets)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=(0,u._)(i.value,2),o=a[0];if(a[1].has(e))return o}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return null},e.replaceWireframeInGroup=function(e,t,n){var r=this,i=this.getGroupWireframes(e);return i.forEach(function(t){return r.removeWireframe(e,t.id)}),i.forEach(function(i){i.id===t?r.addWireframe(e,n):r.addWireframe(e,i)}),this},e.updateWireframeWithRetry=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),r=this.getWireframe(e);return r?this.updateWireframe(e,(0,o._)((0,a._)({},r,t),{retryId:n})):this},e.addPage=function(e){if(!(null==e?void 0:e.id))return this;var t=e.id,n=e.name,r=e.type,i=void 0===r?D.Ty.PAGE:r,s=e.pageAiContext;return this.pages.set(t,{id:t,name:void 0===n?"":n,type:i,pageAiContext:s}),this.pageToGroups.set(t,new Set),this.pageToShapes.set(t,new Set),this.pageToAssets.set(t,new Set),this},e.addGroup=function(e,t){if(!e||!(null==t?void 0:t.id))return this;var n,r=t.id,i=t.name,s=t.type,u=void 0===s?D.Ty.GROUP:s,d=(0,T._)(t,["id","name","type"]);return this.groups.set(r,(0,o._)((0,a._)({name:void 0===i?"":i,type:u},d),{id:r})),null===(n=this.pageToGroups.get(e))||void 0===n||n.add(r),this.groupToWireframes.set(r,new Set),this},e.addShape=function(e,t){if(!e||!(null==t?void 0:t.id))return this;var n,r=t.id,i=t.uid,s=(0,T._)(t,["id","uid"]);return this.shapes.set(r,(0,a._)({id:r,uid:i},s)),null===(n=this.pageToShapes.get(e))||void 0===n||n.add(r),this},e.addAsset=function(e,t){if(!e||!(null==t?void 0:t.id))return this;var n,r=t.id,i=t.type,s=t.name,o=(0,T._)(t,["id","type","name"]);return this.assets.set(r,(0,a._)({id:r,type:i,name:void 0===s?"":s},o)),null===(n=this.pageToAssets.get(e))||void 0===n||n.add(r),this},e.createGroupWithWireframes=function(e,t,n){var r,i,s,u,d=this;return this.addGroup(e,(0,a._)({name:t.name||"Group ".concat(this.getAllGroups().length+1),order:null!==(u=null===(s=this.pages)||void 0===s?void 0:null===(i=s.get(e))||void 0===i?void 0:null===(r=i.groups)||void 0===r?void 0:r.length)&&void 0!==u?u:0,type:D.Ty.GROUP},t)),n.forEach(function(e){var n;d.addWireframe(t.id,(0,o._)((0,a._)({},e),{id:e.id||e.wireframeId,type:D.Ty.WIREFRAME,wireframeId:e.id||e.wireframeId,wireframeName:(null===(n=e.prompt)||void 0===n?void 0:n.slice(0,30))||"Wireframe ".concat(e.id||e.wireframeId),saveStatus:D.G3.UNSAVED}))}),this},e.addWireframe=function(e,t){if(!e||!t)return this;var n=t.wireframeId,r=t.id,i=(0,T._)(t,["wireframeId","id"]),s=n||r;if(!s)return this;this.wireframes.set(s,(0,a._)({id:s},i));var o=this.groupToWireframes.get(e);return o?o.add(s):this.groupToWireframes.set(e,new Set([s])),this},e.moveWireframe=function(e,t){var n;return null===(n=this.groupToWireframes.get(t))||void 0===n||n.delete(e),this},e.moveGroup=function(e,t){var n;return null===(n=this.pageToGroups.get(t))||void 0===n||n.delete(e),this},e.moveShape=function(e,t){var n;return null===(n=this.pageToShapes.get(t))||void 0===n||n.delete(e),this},e.moveAsset=function(e,t){var n;return null===(n=this.pageToAssets.get(t))||void 0===n||n.delete(e),this},e.updatePage=function(e,t){if(!e||!this.pages.has(e))return console.warn("Cannot update page: ".concat(e)),this;var n=this.pages.get(e);return this.pages.set(e,(0,a._)({},n,t)),this},e.updateGroup=function(e,t){if(!this.groups.has(e))return console.error("Group ".concat(e," not found")),this;var n=this.groups.get(e);return this.groups.set(e,(0,a._)({},n,t)),this},e.updateShape=function(e,t){if(!this.shapes.has(e))return console.error("Shape ".concat(e," not found")),this;var n=this.shapes.get(e);return this.shapes.set(e,(0,a._)({},n,t)),this},e.upsertShape=function(e,t){if(!this.shapes.has(e))return console.info("Shape ".concat(e," not found, creating one")),this.shapes.set(e,(0,a._)({},t)),this;var n=this.shapes.get(e);return this.shapes.set(e,(0,a._)({},n,t)),this},e.updateAsset=function(e,t){if(!this.assets.has(e))return console.error("Asset ".concat(e," not found")),this;var n=this.assets.get(e);return this.assets.set(e,(0,a._)({},n,t)),this},e.updateWireframe=function(e,t){if(!this.wireframes.has(e))return console.error("Wireframe ".concat(e," not found")),this;var n=this.wireframes.get(e);return this.wireframes.set(e,(0,a._)({},n,t)),this},e.findParentPage=function(e){var t=!0,n=!1,r=void 0;try{for(var i,s=Array.from(this.pageToGroups)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=(0,u._)(i.value,2),o=a[0];if(a[1].has(e))return o}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return null},e.findShapeParentPage=function(e){var t=!0,n=!1,r=void 0;try{for(var i,s=Array.from(this.pageToShapes)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=(0,u._)(i.value,2),o=a[0];if(a[1].has(e))return o}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return null},e.findParentGroup=function(e){var t=!0,n=!1,r=void 0;try{for(var i,s=Array.from(this.groupToWireframes)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=(0,u._)(i.value,2),o=a[0];if(a[1].has(e))return o}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return null},e.validateStructure=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=Array.from(this.groups.keys())[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var s=r.value;this.findParentPage(s)||console.warn("Orphaned group found: ".concat(s))}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}var a=!0,o=!1,u=void 0;try{for(var d,l=Array.from(this.shapes.keys())[Symbol.iterator]();!(a=(d=l.next()).done);a=!0){var c=d.value;this.findShapeParentPage(c)||console.warn("Orphaned shape found: ".concat(c))}}catch(e){o=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var p=!0,f=!1,m=void 0;try{for(var g,h=Array.from(this.assets.keys())[Symbol.iterator]();!(p=(g=h.next()).done);p=!0){var v=g.value;this.findAssetParentPage(v)||console.warn("Orphaned asset found: ".concat(v))}}catch(e){f=!0,m=e}finally{try{p||null==h.return||h.return()}finally{if(f)throw m}}var y=!0,w=!1,S=void 0;try{for(var _,I=Array.from(this.wireframes.keys())[Symbol.iterator]();!(y=(_=I.next()).done);y=!0){var E=_.value;this.findParentGroup(E)||console.warn("Orphaned wireframe found: ".concat(E))}}catch(e){w=!0,S=e}finally{try{y||null==I.return||I.return()}finally{if(w)throw S}}return this},e.bulkUpdate=function(e,t,n){var r={page:this.pages,group:this.groups,wireframe:this.wireframes,asset:this.assets}[e];if(!r)throw Error("Invalid type: ".concat(e));return t.forEach(function(e){if(r.has(e)){var t=r.get(e);r.set(e,n(t))}}),this},e.removePage=function(e){var t=this;return Array.from(this.pageToGroups.get(e)||[]).forEach(function(n){t.removeGroup(e,n)}),Array.from(this.pageToShapes.get(e)||[]).forEach(function(n){t.removeShape(e,n)}),Array.from(this.pageToAssets.get(e)||[]).forEach(function(n){t.removeAsset(e,n)}),this.pageToGroups.delete(e),this.pageToShapes.delete(e),this.pageToAssets.delete(e),this.pages.delete(e),this},e.removeGroup=function(e,t){var n,r=this;return Array.from(this.groupToWireframes.get(t)||[]).forEach(function(e){r.removeWireframe(t,e)}),null===(n=this.pageToGroups.get(e))||void 0===n||n.delete(t),this.groupToWireframes.delete(t),this.groups.delete(t),this},e.removeShape=function(e,t){var n;return null===(n=this.pageToShapes.get(e))||void 0===n||n.delete(t),this.shapes.delete(t),this},e.removeAsset=function(e,t){var n;return null===(n=this.pageToAssets.get(e))||void 0===n||n.delete(t),this.assets.delete(t),this},e.removeWireframe=function(e,t){var n=this.groupToWireframes.get(e);return n&&(n.delete(t),this.groupToWireframes.set(e,n)),this.wireframes.delete(t),this},e.removeWireframeByRetryId=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this.findWireframeByRetryId(e);if(!n)return this;var r=this.findParentGroup(n.id);if(!r)return this;if(this.removeWireframe(r,n.id),t&&0===this.getGroupWireframes(r).length){var i=this.findParentPage(r);i&&this.removeGroup(i,r)}return this},e.replaceWireframe=function(e,t,n){var r=this,i=this.getGroupWireframes(e);return i.forEach(function(t){return r.removeWireframe(e,t.id)}),i.forEach(function(i){i.id===t?r.addWireframe(e,n):r.addWireframe(e,i)}),this},e.removeWireframeAndCleanup=function(e){var t=this.findParentGroup(e);if(!t)return this;if(this.removeWireframe(t,e),0===this.getGroupWireframes(t).length){var n=this.findParentPage(t);n&&this.removeGroup(n,t)}return this},e.clearPage=function(e){var t=this;return this.getPageGroups(e).forEach(function(n){t.removeGroup(e,n.id)}),this.getPageShapes(e).forEach(function(n){t.removeShape(e,n.id)}),this.getPageAssets(e).forEach(function(n){t.removeAsset(e,n.id)}),this},e.toJSON=function(){return{pages:Array.from(this.pages.entries()),groups:Array.from(this.groups.entries()),wireframes:Array.from(this.wireframes.entries()),shapes:Array.from(this.shapes.entries()),assets:Array.from(this.assets.entries()),pageToGroups:Array.from(this.pageToGroups.entries()).map(function(e){var t=(0,u._)(e,2);return[t[0],Array.from(t[1])]}),pageToShapes:Array.from(this.pageToShapes.entries()).map(function(e){var t=(0,u._)(e,2);return[t[0],Array.from(t[1])]}),pageToAssets:Array.from(this.pageToAssets.entries()).map(function(e){var t=(0,u._)(e,2);return[t[0],Array.from(t[1])]}),groupToWireframes:Array.from(this.groupToWireframes.entries()).map(function(e){var t=(0,u._)(e,2);return[t[0],Array.from(t[1])]})}},e.validateMove=function(e,t,n,r){var i,s,a;if(!e||!t||!n||!r)return!1;switch(r){case"wireframe":return!!this.groupToWireframes.has(t)&&!!this.groupToWireframes.has(n)&&!!(null===(i=this.groupToWireframes.get(t))||void 0===i?void 0:i.has(e));case"group":return!!this.pageToGroups.has(t)&&!!this.pageToGroups.has(n)&&!!(null===(s=this.pageToGroups.get(t))||void 0===s?void 0:s.has(e));case"asset":return!!this.pageToAssets.has(t)&&!!this.pageToAssets.has(n)&&!!(null===(a=this.pageToAssets.get(t))||void 0===a?void 0:a.has(e));default:return!1}},e.addStylesToGroup=function(e,t){var n=t.font;this.updateGroup(e,{font:n});var r=Array.from(this.groupToWireframes.get(e)||[]),i=!0,s=!1,a=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var d=o.value;this.updateWireframe(d,{font:n})}}catch(e){s=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw a}}return this},e.addStylesToWireframe=function(e,t){var n=t.font;return this.updateWireframe(e,{font:n}),this},e.getPageWireframes=function(e){if(!e)return[];var t=this.getPageGroups(e),n=new Set,r=[],i=!0,s=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var d=o.value,l=this.getGroupWireframes(d.id),c=!0,p=!1,f=void 0;try{for(var m,g=l[Symbol.iterator]();!(c=(m=g.next()).done);c=!0){var h=m.value,v=h.syncId||h.id;n.has(v)||(n.add(v),r.push(h))}}catch(e){p=!0,f=e}finally{try{c||null==g.return||g.return()}finally{if(p)throw f}}}}catch(e){s=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw a}}return r.sort(function(e,t){return(e.order||0)-(t.order||0)}),r},e.getUnusedAssets=function(){var e=this.getAllAssets(),t=new Set,n=!0,r=!1,i=void 0;try{for(var s,a=Array.from(this.pageToAssets)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=(0,u._)(s.value,2);(o[0],o[1]).forEach(function(e){return t.add(e)})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e.filter(function(e){return!t.has(e.id)})},e.cleanupOrphanedAssets=function(){var e=this;return this.getUnusedAssets().forEach(function(t){e.assets.delete(t.id)}),this},e.cleanup=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=Array.from(this.groupToWireframes)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var s=(0,u._)(r.value,2),a=s[0];s[1],this.groups.has(a)||this.groupToWireframes.delete(a)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}var o=!0,d=!1,l=void 0;try{for(var c,p=Array.from(this.pageToGroups)[Symbol.iterator]();!(o=(c=p.next()).done);o=!0){var f=(0,u._)(c.value,2),m=f[0];f[1],this.pages.has(m)||this.pageToGroups.delete(m)}}catch(e){d=!0,l=e}finally{try{o||null==p.return||p.return()}finally{if(d)throw l}}var g=!0,h=!1,v=void 0;try{for(var y,w=Array.from(this.pageToShapes)[Symbol.iterator]();!(g=(y=w.next()).done);g=!0){var S=(0,u._)(y.value,2),_=S[0];S[1],this.pages.has(_)||this.pageToShapes.delete(_)}}catch(e){h=!0,v=e}finally{try{g||null==w.return||w.return()}finally{if(h)throw v}}var I=!0,E=!1,A=void 0;try{for(var C,T=Array.from(this.pageToAssets)[Symbol.iterator]();!(I=(C=T.next()).done);I=!0){var D=(0,u._)(C.value,2),b=D[0];D[1],this.pages.has(b)||this.pageToAssets.delete(b)}}catch(e){E=!0,A=e}finally{try{I||null==T.return||T.return()}finally{if(E)throw A}}return this},DesignData.fromJSON=function(e){if(!e)return new DesignData;var t=new DesignData;try{e.pages&&e.pages.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];return r&&t.pages.set(r,i)}),e.groups&&e.groups.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];return r&&t.groups.set(r,i)}),e.shapes&&e.shapes.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];return r&&t.shapes.set(r,i)}),e.assets&&e.assets.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];return r&&t.assets.set(r,i)}),e.wireframes&&e.wireframes.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];return r&&t.wireframes.set(r,i)}),e.pageToGroups&&e.pageToGroups.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];r&&Array.isArray(i)&&t.pageToGroups.set(r,new Set(i.filter(Boolean)))}),e.pageToShapes&&e.pageToShapes.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];r&&Array.isArray(i)&&t.pageToShapes.set(r,new Set(i.filter(Boolean)))}),e.pageToAssets&&e.pageToAssets.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];r&&Array.isArray(i)&&t.pageToAssets.set(r,new Set(i.filter(Boolean)))}),e.groupToWireframes&&e.groupToWireframes.forEach(function(e){var n=(0,u._)(e,2),r=n[0],i=n[1];r&&Array.isArray(i)&&t.groupToWireframes.set(r,new Set(i.filter(Boolean)))})}catch(e){return console.error("Error parsing JSON:",e),new DesignData}return t},DesignData}(),x=n(82924),W=n(15680),P=A.TY.endpoints,M=A.cr.endpoints,L=A.yk.endpoints,O=x.fo.endpoints,G=function(e){(0,S._)(SyncedDesignData,e);var t=(0,_._)(SyncedDesignData);function SyncedDesignData(e){var n;return(0,v._)(this,SyncedDesignData),(n=t.call(this)).uid=e,n.syncing=!1,n.lastSynced=null,n.syncStatus={pages:new Map,groups:new Map,wireframes:new Map,shapes:new Map,assets:new Map},n.pendingChanges={pages:new Set,groups:new Set,wireframes:new Set,shapes:new Set,assets:new Set},n.pendingDeletes={shapes:new Map},n.deletedShapeIds=new Set,n.loadingStates={pages:new Map,groups:new Map,wireframes:new Map,shapes:new Map,assets:new Map},n.autoSyncInterval=null,n.apiDispatch=(0,C.b)().dispatch,n}var n=SyncedDesignData.prototype;return n.executeMutation=function(e,t){var n=this;return(0,i._)(function(){var r,i,s,a,o,d;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(!n.apiDispatch)throw Error("API dispatch not set. Call setApiDispatch first.");if(i=(r=(0,u._)(e.split("."),2))[0],s=r[1],"groups"===i)a=P[s];else if("wireframes"===i)a=M[s];else if("pages"===i)a=L[s];else if("shapes"===i)a=O[s];else if("assets"===i)throw Error("Assets API not implemented yet");if(!a)throw Error("Endpoint ".concat(e," not found"));l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.apiDispatch(a.initiate(t))];case 2:if((o=l.sent()).error)throw o.error;return[2,o.data];case 3:throw d=l.sent(),console.error("Error executing ".concat(e,":"),d),d;case 4:return[2]}})})()},n.setUID=function(e){this.uid=e},n.setSyncing=function(e){this.syncing=e,e&&(this.lastSynced=new Date)},n.generateId=function(e,t){return t?t.includes("temp")?t:"".concat(e,"_temp_").concat(t):"".concat(e,"_temp_").concat(Date.now())},n.setLoading=function(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i={pages:new Map(this.loadingStates.pages),groups:new Map(this.loadingStates.groups),wireframes:new Map(this.loadingStates.wireframes),shapes:new Map(this.loadingStates.shapes),assets:new Map(this.loadingStates.assets)};return t&&(i["".concat(e,"s")]?(i["".concat(e,"s")].set(t,{isLoading:n,error:r}),this.loadingStates=i,this.dispatchLoadingStateChange()):console.warn("Invalid loading type: ".concat(e))),this},n.setLoadingWireframe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setLoading("wireframe",e,t,n)},n.setLoadingGroup=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setLoading("group",e,t,n)},n.setLoadingShape=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setLoading("shape",e,t,n)},n.setLoadingAsset=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setLoading("asset",e,t,n)},n.setLoadingPage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setLoading("page",e,t,n)},n.clearLoading=function(e,t){var n={pages:new Map(this.loadingStates.pages),groups:new Map(this.loadingStates.groups),wireframes:new Map(this.loadingStates.wireframes),shapes:new Map(this.loadingStates.shapes),assets:new Map(this.loadingStates.assets)};return n["".concat(e,"s")].delete(t),this.loadingStates=n,this.dispatchLoadingStateChange(),this},n.clearLoadingWireframe=function(e){this.clearLoading("wireframe",e)},n.clearLoadingGroup=function(e){this.clearLoading("group",e)},n.clearLoadingShape=function(e){this.clearLoading("shape",e)},n.clearLoadingAsset=function(e){this.clearLoading("asset",e)},n.clearLoadingPage=function(e){this.clearLoading("page",e)},n.removeGroup=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"removeGroup",this).call(this,e,t),this},n.removeShape=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"removeShape",this).call(this,e,t),this.syncStatus.shapes.delete(t),this.pendingChanges.shapes.delete(t),this.pendingChanges.pages.add(e),this},n.queueShapeDelete=function(e,t){if(!t||"null"===t||"undefined"===t||""===t.trim())return console.warn("⚠️ queueShapeDelete called with invalid shapeId:",t),this;var n=null!=e?e:this.findShapeParentPage(t);return this.pendingDeletes.shapes.set(t,{pageId:null!=n?n:null}),this.deletedShapeIds.add(t),this.pendingChanges.shapes.delete(t),this.syncStatus.shapes.delete(t),(0,y._)((0,w._)(SyncedDesignData.prototype),"removeShape",this).call(this,n||"",t),n&&this.pendingChanges.pages.add(n),this},n.resolveShapeDelete=function(e){return e&&"null"!==e&&"undefined"!==e&&""!==e.trim()&&(this.pendingDeletes.shapes.delete(e),this.deletedShapeIds.delete(e),this.pendingChanges.shapes.delete(e)),this},n.removeWireframe=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"removeWireframe",this).call(this,e,t),this},n.isLoading=function(e,t){var n,r,i;return null!==(i=null===(r=this.loadingStates["".concat(e,"s")])||void 0===r?void 0:null===(n=r.get(t))||void 0===n?void 0:n.isLoading)&&void 0!==i&&i},n.getError=function(e,t){var n,r;return null!==(r=null===(n=this.loadingStates["".concat(e,"s")].get(t))||void 0===n?void 0:n.error)&&void 0!==r?r:null},n.isPageLoading=function(e){return this.isLoading("page",e)},n.isGroupLoading=function(e){return this.isLoading("group",e)},n.isWireframeLoading=function(e){return this.isLoading("wireframe",e)},n.isShapeLoading=function(e){return this.isLoading("shape",e)},n.isAssetLoading=function(e){return this.isLoading("asset",e)},n.addPage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,y._)((0,w._)(SyncedDesignData.prototype),"addPage",this).call(this,e),this.syncStatus.pages.set(e.id,{synced:t,lastSynced:t?new Date:null}),t||this.pendingChanges.pages.add(e.id),this},n.addGroup=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,y._)((0,w._)(SyncedDesignData.prototype),"addGroup",this).call(this,e,t),this.syncStatus.groups.set(t.id,{synced:n,lastSynced:n?new Date:null}),n||this.pendingChanges.groups.add(t.id),this.pendingChanges.pages.add(e),this},n.addShape=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,y._)((0,w._)(SyncedDesignData.prototype),"addShape",this).call(this,e,t),this.syncStatus.shapes.set(t.id,{synced:n,lastSynced:n?new Date:null}),n||this.pendingChanges.shapes.add(t.id),this.pendingChanges.pages.add(e),this},n.addAsset=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,y._)((0,w._)(SyncedDesignData.prototype),"addAsset",this).call(this,e,t),this.syncStatus.assets.set(t.id,{synced:n,lastSynced:n?new Date:null}),n||this.pendingChanges.assets.add(t.id),this.pendingChanges.pages.add(e),this},n.addWireframe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,y._)((0,w._)(SyncedDesignData.prototype),"addWireframe",this).call(this,e,t),this.syncStatus.wireframes.set(t.id,{synced:n,lastSynced:n?new Date:null}),n||(this.pendingChanges.wireframes.add(t.id),this.markAsUnsynced("group",e)),this},n.updateWireframeHtml=function(e,t){return this.getWireframe(e)?(this.updateWireframe(e,{wireframeOutputHtml:t,lastModified:new Date().toISOString()}),this.markAsSynced("wireframe",e)):console.warn("Wireframe ".concat(e," not found for HTML update")),this},n.removeWireframeAndCleanup=function(e){var t=this.findParentGroup(e);if(!t)return this;(0,y._)((0,w._)(SyncedDesignData.prototype),"removeWireframe",this).call(this,t,e);var n=this.findParentPage(t);return this.markAsUnsynced("page",n),0===this.getGroupWireframes(t).length?this.removeGroupFromDB(t):this.markAsUnsynced("group",t),this},n.syncUpdateWireframe=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"updateWireframe",this).call(this,e,t),this.markAsUnsynced("wireframe",e),this},n.syncUpdateShape=function(e,t){return e&&"null"!==e&&"undefined"!==e&&""!==e.trim()?this.deletedShapeIds.has(e)?console.info("ℹ️ Skipping update for deleted shape:",e):((0,y._)((0,w._)(SyncedDesignData.prototype),"updateShape",this).call(this,e,t),this.markAsUnsynced("shape",e)):console.warn("⚠️ syncUpdateShape called with invalid shapeId:",e),this},n.syncUpsertShape=function(e,t,n){return t&&"null"!==t&&"undefined"!==t&&""!==t.trim()?this.deletedShapeIds.has(t)?console.info("ℹ️ Skipping upsert for deleted shape:",t):((0,y._)((0,w._)(SyncedDesignData.prototype),"upsertShape",this).call(this,t,n),this.addShape(e,n),this.markAsUnsynced("shape",t)):console.warn("⚠️ syncUpsertShape called with invalid shapeId:",t),this},n.updatePage=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"updatePage",this).call(this,e,t),this.markAsUnsynced("page",e),this},n.updateGroup=function(e,t){(0,y._)((0,w._)(SyncedDesignData.prototype),"updateGroup",this).call(this,e,t),this.markAsUnsynced("group",e);var n=this.findParentPage(e);return n&&this.pendingChanges.pages.add(n),this},n.updateShape=function(e,t){(0,y._)((0,w._)(SyncedDesignData.prototype),"updateShape",this).call(this,e,t),this.markAsUnsynced("shape",e);var n=this.findShapeParentPage(e);return n&&this.pendingChanges.pages.add(n),this},n.updateAsset=function(e,t){(0,y._)((0,w._)(SyncedDesignData.prototype),"updateAsset",this).call(this,e,t),this.markAsUnsynced("asset",e);var n=this.findAssetParentPage(e);return n&&this.pendingChanges.pages.add(n),this},n.removeAsset=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"removeAsset",this).call(this,e,t),this.syncStatus.assets.delete(t),this.pendingChanges.assets.delete(t),this.pendingChanges.pages.add(e),this},n.markAsUnsynced=function(e,t){var n=this.syncStatus["".concat(e,"s")],r=n.get(t)||{synced:!1,lastSynced:null};r.synced=!1,n.set(t,r),this.pendingChanges["".concat(e,"s")].add(t)},n.markAsSynced=function(e,t){this.syncStatus["".concat(e,"s")].set(t,{synced:!0,lastSynced:new Date}),this.pendingChanges["".concat(e,"s")].delete(t)},n.markGroupAsSynced=function(e){this.markAsSynced("group",e)},n.markPageAsSynced=function(e){this.markAsSynced("page",e)},n.markWireframeAsSynced=function(e){this.markAsSynced("wireframe",e)},n.markShapeAsSynced=function(e){this.markAsSynced("shape",e)},n.markAssetAsSynced=function(e){this.markAsSynced("asset",e)},n.cleanupPendingAfterSync=function(){var prune=function(e,t){var n=!0,r=!1,i=void 0;try{for(var s,a=Array.from(e)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=s.value,u=t.get(o);(null==u?void 0:u.synced)&&e.delete(o)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}};prune(this.pendingChanges.pages,this.syncStatus.pages),prune(this.pendingChanges.groups,this.syncStatus.groups),prune(this.pendingChanges.wireframes,this.syncStatus.wireframes),prune(this.pendingChanges.shapes,this.syncStatus.shapes),prune(this.pendingChanges.assets,this.syncStatus.assets)},n.isItemSynced=function(e,t){var n;return!!(null===(n=this.syncStatus["".concat(e,"s")].get(t))||void 0===n?void 0:n.synced)},n.isItemInDB=function(e,t){var n,r,i=this.getItem(e,t);if(!i)return!1;if(i.syncId)return!0;var s=null!==(r=null!==(n=i.id)&&void 0!==n?n:t)&&void 0!==r?r:null;return!!s&&!s.includes("temp")},n.isWireframeSaved=function(e){var t,n;return null!==(n=null===(t=this.getWireframe(e))||void 0===t?void 0:t.isSaved)&&void 0!==n&&n},n.isGroupSaved=function(e){var t,n=this.getGroup(e);return null!==(t=null==n?void 0:n.isSaved)&&void 0!==t&&t},n.isPageSaved=function(e){var t,n;return null!==(n=null===(t=this.getPage(e))||void 0===t?void 0:t.isSaved)&&void 0!==n&&n},n.isPageSynced=function(e){return this.isItemInDB("page",e)},n.isGroupSynced=function(e){return this.isItemInDB("group",e)},n.isShapeSynced=function(e){return this.isItemInDB("shape",e)},n.isAssetSynced=function(e){return this.isItemInDB("asset",e)},n.isWireframeSynced=function(e){return this.isItemInDB("wireframe",e)},n.hasPendingChanges=function(){return this.pendingChanges.pages.size>0||this.pendingChanges.groups.size>0||this.pendingChanges.wireframes.size>0||this.pendingChanges.shapes.size>0||this.pendingChanges.assets.size>0||this.pendingDeletes.shapes.size>0},n.hasGeneratingWireframes=function(){try{return(this.getAllWireframes?this.getAllWireframes():[]).some(function(e){return(null==e?void 0:e.status)==="generating"})}catch(e){return!1}},n.addStylesToGroup=function(e,t){(0,y._)((0,w._)(SyncedDesignData.prototype),"addStylesToGroup",this).call(this,e,t),this.markAsUnsynced("group",e);var n=Array.from(this.groupToWireframes.get(e)||[]),r=!0,i=!1,s=void 0;try{for(var a,o=n[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var u=a.value;this.markAsUnsynced("wireframe",u)}}catch(e){i=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return this},n.getVersionGroups=function(e){var t,n,r=null===(n=(0,C.b)().getState().versions)||void 0===n?void 0:null===(t=n.pageVersionGroups)||void 0===t?void 0:t.find(function(t){return t.pageId===e});return r?r.groups:[]},n.addStylesToWireframe=function(e,t){return(0,y._)((0,w._)(SyncedDesignData.prototype),"addStylesToWireframe",this).call(this,e,t),this.markAsUnsynced("wireframe",e),this},n.syncToBackend=function(){var e=this;return(0,i._)(function(){var t,n,r,i,s,d,c,p,f,m,g,h,v,y,w,S,_,A,C,T,D,b,x,P,M,L,O,G,R,F,V,k,N,U,H,B,J,z,j,Y,Z,K,X,Q,q,$,ee,et,en,er,ei,es,ea,eo,eu,ed,el;return(0,l.Jh)(this,function(l){switch(l.label){case 0:l.trys.push([0,51,52,53]),e.setSyncing(!0),(0,I.hb)(I.zW.syncing,{syncing:!0,lastSynced:null}),t=!0,n=!1,r=void 0,l.label=1;case 1:l.trys.push([1,8,9,10]),i=Array.from(e.pendingChanges.pages)[Symbol.iterator](),l.label=2;case 2:if(t=(s=i.next()).done)return[3,7];if(d=s.value,!(c=e.getPage(d)))return[3,6];if(p=e.getPageGroups(d),f=e.getPageShapes(d)||[],m=p.map(function(e){return e.syncId||e.id}),g=f.map(function(e){return e.syncId||e.id}).filter(function(e){return!e.includes("temp")}),h=Array.from(new Map(p.flatMap(function(t){return e.getGroupWireframes(t.id)}).map(function(e){return[e.syncId||e.id,e]})).values()).map(function(e){return e.syncId||e.id}),v=(e.getPageAssets(d)||[]).map(function(e){return e.syncId||e.id}).filter(function(e){return!e.includes("temp")}),!e.isItemInDB("page",d))return[3,4];return[4,e.executeMutation("pages.updatePage",(0,a._)({pageId:c.syncId||d,name:c.name,groupIds:m,shapeIds:g,wireframeIds:h,assetIds:v},c))];case 3:return l.sent(),e.markAsSynced("page",d),[3,6];case 4:return[4,e.executeMutation("pages.createPage",(0,a._)({name:c.name,uid:e.uid,groupIds:m,wireframeIds:h,shapeIds:g,assetIds:v},c))];case 5:"success"===(y=l.sent()).status&&(e.updatePage(d,{syncId:y.pageId}),e.markAsSynced("page",d)),l.label=6;case 6:return t=!0,[3,2];case 7:return[3,10];case 8:return w=l.sent(),n=!0,r=w,[3,10];case 9:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 10:S=!0,_=!1,A=void 0,l.label=11;case 11:l.trys.push([11,18,19,20]),C=Array.from(e.pendingChanges.groups)[Symbol.iterator](),l.label=12;case 12:if(S=(T=C.next()).done)return[3,17];if(D=T.value,!(b=e.getGroup(D))||(x=e.getGroupWireframes(D).map(function(e){return e.syncId||e.id}),e.isItemSynced("group",D)))return[3,16];if(!e.isItemInDB("group",D))return[3,14];return[4,e.executeMutation("groups.updateGroup",{groupId:b.syncId||D,name:b.name,wireframeIds:x,isSaved:b.isSaved})];case 13:return l.sent(),e.markAsSynced("group",D),[3,16];case 14:return[4,e.executeMutation("groups.createGroup",(0,o._)((0,a._)({},b),{name:b.name,uid:e.uid,wireframeIds:x,isSaved:b.isSaved}))];case 15:P=l.sent(),e.updateGroup(D,{syncId:P.groupId}),e.markAsSynced("group",D),l.label=16;case 16:return S=!0,[3,12];case 17:return[3,20];case 18:return w=l.sent(),_=!0,A=w,[3,20];case 19:try{S||null==C.return||C.return()}finally{if(_)throw A}return[7];case 20:M=!0,L=!1,O=void 0,l.label=21;case 21:l.trys.push([21,26,27,28]),G=Array.from(e.pendingDeletes.shapes.entries())[Symbol.iterator](),l.label=22;case 22:if(M=(R=G.next()).done)return[3,25];return V=(F=(0,u._)(R.value,2))[0],k=F[1],[4,e.executeMutation("shapes.deleteCanvasShape",(0,a._)({shapeId:V},(null==k?void 0:k.pageId)?{pageId:k.pageId}:{}))];case 23:l.sent(),e.pendingDeletes.shapes.delete(V),e.deletedShapeIds.delete(V),e.pendingChanges.shapes.delete(V),l.label=24;case 24:return M=!0,[3,22];case 25:return[3,28];case 26:return w=l.sent(),L=!0,O=w,[3,28];case 27:try{M||null==G.return||G.return()}finally{if(L)throw O}return[7];case 28:N=!0,U=!1,H=void 0,l.label=29;case 29:l.trys.push([29,39,40,41]),B=Array.from(e.pendingChanges.shapes)[Symbol.iterator](),l.label=30;case 30:if(N=(J=B.next()).done)return[3,38];if(z=J.value,e.deletedShapeIds.has(z))return e.pendingChanges.shapes.delete(z),[3,37];if(!(j=e.getShape(z))||e.isItemSynced("shape",z))return[3,37];if(!e.isItemInDB("shape",z))return[3,35];if(!("flow-node"===j.type||"arrow"===j.type))return[3,32];return[4,e.executeMutation("shapes.updateFlowchartShape",{shapeId:z,data:j,uid:e.uid})];case 31:return l.sent(),[3,34];case 32:return[4,e.executeMutation("shapes.updateCanvasShape",{shapeId:z,data:j,uid:e.uid})];case 33:l.sent(),l.label=34;case 34:return e.markAsSynced("shape",z),[3,37];case 35:if(!(Y=(0,W.W_)())||!(Z=Y.getShape(z)))return[3,37];return[4,e.executeMutation("shapes.createCanvasShape",(0,o._)((0,a._)({},j),{props:(0,a._)({},Z.props),uid:e.uid}))];case 36:"success"===(K=l.sent()).status&&(Y.updateShape((0,o._)((0,a._)({},Z),{props:(0,o._)((0,a._)({},Z.props),{shapeId:K.shape.id})})),e.markAsSynced("shape",z),e.removeShape(j.pageId,z),e.addShape(j.pageId,(0,o._)((0,a._)({},K.shape),{props:(0,o._)((0,a._)({},(null==K?void 0:null===(X=K.shape)||void 0===X?void 0:X.props)||{},Z.props),{shapeId:K.shape.id})}),!0)),l.label=37;case 37:return N=!0,[3,30];case 38:return[3,41];case 39:return w=l.sent(),U=!0,H=w,[3,41];case 40:try{N||null==B.return||B.return()}finally{if(U)throw H}return[7];case 41:Q=!0,q=!1,$=void 0;try{for(ee=Array.from(e.pendingChanges.assets)[Symbol.iterator]();!(Q=(et=ee.next()).done);Q=!0)en=et.value,e.getAsset(en)&&!e.isItemSynced("asset",en)&&(e.isItemInDB("asset",en)?console.warn("Asset update not implemented yet for asset ".concat(en)):console.warn("Asset creation not implemented yet for asset ".concat(en)),e.markAsSynced("asset",en))}catch(e){q=!0,$=e}finally{try{Q||null==ee.return||ee.return()}finally{if(q)throw $}}er=!0,ei=!1,es=void 0,l.label=42;case 42:l.trys.push([42,48,49,50]),ea=Array.from(e.pendingChanges.wireframes)[Symbol.iterator](),l.label=43;case 43:if(er=(eo=ea.next()).done)return[3,47];if(eu=eo.value,(null==(ed=e.getWireframe(eu))?void 0:ed.status)==="failed"||(null==ed?void 0:ed.status)==="generating")return e.markAsSynced("wireframe",eu),[3,46];if(!e.isItemInDB("wireframe",eu))return[3,45];return[4,e.executeMutation("wireframes.updateWireframe",{wireframeId:eu,data:(0,a._)({},ed)})];case 44:return l.sent(),e.markAsSynced("wireframe",eu),[3,46];case 45:e.markAsSynced("wireframe",eu),l.label=46;case 46:return er=!0,[3,43];case 47:return[3,50];case 48:return w=l.sent(),ei=!0,es=w,[3,50];case 49:try{er||null==ea.return||ea.return()}finally{if(ei)throw es}return[7];case 50:return[2,!0];case 51:throw console.error("Error syncing to backend:",el=l.sent()),(0,E.z)(el);case 52:return e.cleanupPendingAfterSync(),e.setSyncing(!1),(0,I.hb)(I.zW.syncing,{syncing:!1,lastSynced:new Date}),[7];case 53:return[2]}})})()},n.saveWireframe=function(e){var t=this;return(0,i._)(function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:t.setLoading("wireframe",e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.executeMutation("wireframes.saveWireframe",{wireframeId:e})];case 2:return r.sent(),t.clearLoading("wireframe",e),t.updateWireframe(e,{isSaved:!0}),[2,!0];case 3:return n=r.sent(),t.setLoading("wireframe",e,!1,n.message),[2,!1];case 4:return[2]}})})()},n.unsaveWireframe=function(e){var t=this;return(0,i._)(function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:t.setLoading("wireframe",e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.executeMutation("wireframes.unsaveWireframe",{wireframeId:e})];case 2:return r.sent(),t.markAsUnsynced("wireframe",e),t.clearLoading("wireframe",e),t.updateWireframe(e,{isSaved:!1}),[2,!0];case 3:return n=r.sent(),t.setLoading("wireframe",e,!1,n.message),[2,!1];case 4:return[2]}})})()},n.saveGroup=function(e){var t=this;return(0,i._)(function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:t.setLoading("group",e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.executeMutation("groups.saveGroup",{groupId:e})];case 2:return r.sent(),t.markAsSynced("group",e),t.clearLoading("group",e),t.updateGroup(e,{isSaved:!0}),[2,!0];case 3:return n=r.sent(),t.setLoading("group",e,!1,n.message),[2,!1];case 4:return[2]}})})()},n.unsaveGroup=function(e){var t=this;return(0,i._)(function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:t.setLoading("group",e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.executeMutation("groups.unsaveGroup",{groupId:e})];case 2:return r.sent(),t.markAsUnsynced("group",e),t.clearLoading("group",e),t.updateGroup(e,{isSaved:!1}),[2,!0];case 3:return n=r.sent(),t.setLoading("group",e,!1,n.message),[2,!1];case 4:return[2]}})})()},n.addWireframeToDB=function(e){var t=this;return(0,i._)(function(){var n,r,i,s,a;return(0,l.Jh)(this,function(o){switch(o.label){case 0:r=null!==(n=e.id)&&void 0!==n?n:e.wireframeId,t.setLoading("wireframe",r),o.label=1;case 1:return o.trys.push([1,3,,4]),i={data:{wireframeId:e.id,isSaved:!0,isL1:e.isL1,isHiFi:e.isHiFi}},[4,t.executeMutation("wireframes.saveNewWireframes",i)];case 2:return"success"===(s=o.sent()).status&&t.markAsSynced("wireframe",r),t.clearLoading("wireframe",r),[2,s];case 3:throw a=o.sent(),t.setLoading("wireframe",r,!1,a.message),console.error("Error saving wireframe:",a),(0,E.z)(a);case 4:return[2]}})})()},n.addGroupToDB=function(e){var t=this;return(0,i._)(function(){var n,r,i,s;return(0,l.Jh)(this,function(a){switch(a.label){case 0:t.setLoading("group",e),a.label=1;case 1:if(a.trys.push([1,7,,8]),n=t.getGroup(e),r=t.getGroupWireframes(e).map(function(e){return e.id}),!t.isItemInDB("group",e))return[3,4];if(!n)return[3,3];return[4,t.executeMutation("groups.updateGroup",{groupId:n.syncId||e,name:n.name,wireframeIds:r})];case 2:a.sent(),a.label=3;case 3:return[3,6];case 4:if(!n)return[3,6];return[4,t.executeMutation("groups.createGroup",{name:n.name,uid:t.uid,wireframeIds:r})];case 5:"success"===(i=a.sent()).status&&(t.updateGroup(e,{syncId:i.groupId}),setTimeout(function(){t.markAsSynced("group",e)},1e3)),a.label=6;case 6:return t.clearLoading("group",e),[2,!0];case 7:throw s=a.sent(),t.setLoading("group",e,!1,s.message),console.error("Error saving group:",s),(0,E.z)(s);case 8:return[2]}})})()},n.addPageToDB=function(e){var t=this;return(0,i._)(function(){var n,r,i,s,o;return(0,l.Jh)(this,function(u){switch(u.label){case 0:t.setLoading("page",e),u.label=1;case 1:if(u.trys.push([1,6,,7]),!(n=t.getPage(e)))throw Error("Page not found");if(i=(r=t.getPageGroups(e)).map(function(e){return e.id}),s=r.flatMap(function(e){return t.getGroupWireframes(e.id)}).map(function(e){return e.id}),!t.isItemInDB("page",e))return[3,3];return[4,t.executeMutation("pages.updatePage",(0,a._)({pageId:e,name:n.name,groupIds:i,wireframeIds:s},n.rest))];case 2:return u.sent(),[3,5];case 3:return[4,t.executeMutation("pages.createPage",(0,a._)({name:n.name,uid:t.uid,groupIds:i,wireframeIds:s},n.rest))];case 4:"success"===u.sent().status&&t.markAsSynced("page",e),u.label=5;case 5:return t.clearLoading("page",e),[2,!0];case 6:throw o=u.sent(),t.setLoading("page",e,!1,o.message),console.error("Error saving page:",o),(0,E.z)(o);case 7:return[2]}})})()},n.removeWireframeFromDB=function(e){var t=this;return(0,i._)(function(){var n,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t.executeMutation("wireframes.unsaveWireframe",{wireframeId:e})];case 1:return"success"===(n=i.sent()).status&&t.markAsUnsynced("wireframe",e),[2,n];case 2:throw console.error("Error unsaving wireframe:",r=i.sent()),(0,E.z)(r);case 3:return[2]}})})()},n.removeGroupFromDB=function(e){var t=this;return(0,i._)(function(){var n,r,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:t.setLoading("group",e),s.label=1;case 1:if(s.trys.push([1,3,,4]),!(n=t.getGroup(e)))return[2];return[4,t.executeMutation("groups.deleteGroup",{groupId:n.syncId||e})];case 2:return r=s.sent(),t.markAsSynced("group",e),t.clearLoading("group",e),t.removeGroup(t.findParentPage(e),e),[2,r];case 3:throw i=s.sent(),t.setLoading("group",e,!1,i.message),console.error("Error deleting group:",i),(0,E.z)(i);case 4:return[2]}})})()},n.removePageFromDB=function(e){var t=this,n=this;return(0,i._)(function(){var r,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:n.setLoading("page",e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.executeMutation("pages.deletePage",{pageId:e})];case 2:return"success"===(r=s.sent()).status&&((0,y._)((0,w._)(SyncedDesignData.prototype),"removePage",t).call(n,e),n.syncStatus.pages.delete(e),n.pendingChanges.pages.delete(e),n.loadingStates.pages.delete(e)),n.clearLoading("page",e),[2,r];case 3:throw i=s.sent(),n.setLoading("page",e,!1,i.message),console.error("Error deleting page:",i),(0,E.z)(i);case 4:return[2]}})})()},n.addAssetToDB=function(e,t){var n=this;return(0,i._)(function(){return(0,l.Jh)(this,function(e){n.setLoading("asset",t);try{if(!n.getAsset(t))throw Error("Asset not found");return n.isItemInDB("asset",t)?console.warn("Asset update not implemented yet for asset ".concat(t)):console.warn("Asset creation not implemented yet for asset ".concat(t)),n.clearLoading("asset",t),[2,!0]}catch(e){throw n.setLoading("asset",t,!1,e.message),console.error("Error saving asset:",e),(0,E.z)(e)}return[2]})})()},n.removeAssetFromDB=function(e){var t=this;return(0,i._)(function(){var n;return(0,l.Jh)(this,function(r){t.setLoading("asset",e);try{if(!t.getAsset(e))return[2];return console.warn("Asset deletion not implemented yet for asset ".concat(e)),t.markAsSynced("asset",e),t.clearLoading("asset",e),(n=t.findAssetParentPage(e))&&t.removeAsset(n,e),[2,!0]}catch(n){throw t.setLoading("asset",e,!1,n.message),console.error("Error deleting asset:",n),(0,E.z)(n)}return[2]})})()},n.getSyncStatus=function(){return{pendingPages:Array.from(this.pendingChanges.pages),pendingGroups:Array.from(this.pendingChanges.groups),pendingWireframes:Array.from(this.pendingChanges.wireframes),pendingShapes:Array.from(this.pendingChanges.shapes),pendingDeletedShapes:Array.from(this.pendingDeletes.shapes.keys()),pendingAssets:Array.from(this.pendingChanges.assets),totalPending:this.pendingChanges.pages.size+this.pendingChanges.groups.size+this.pendingChanges.wireframes.size+this.pendingChanges.shapes.size+this.pendingChanges.assets.size+this.pendingDeletes.shapes.size}},n.hasLoadingItems=function(){var checkLoading=function(e){var t=!1;return e.forEach(function(e){e.isLoading&&(t=!0)}),t};return checkLoading(this.loadingStates.pages)||checkLoading(this.loadingStates.groups)||checkLoading(this.loadingStates.wireframes)||checkLoading(this.loadingStates.shapes)||checkLoading(this.loadingStates.assets)},n.getErrors=function(){var getTypeErrors=function(e){var t={};return e.forEach(function(e,n){e.error&&(t[n]=e.error)}),t};return{pages:getTypeErrors(this.loadingStates.pages),groups:getTypeErrors(this.loadingStates.groups),wireframes:getTypeErrors(this.loadingStates.wireframes),shapes:getTypeErrors(this.loadingStates.shapes),assets:getTypeErrors(this.loadingStates.assets)}},n.dispatchLoadingStateChange=function(){var e=new CustomEvent("loadingStateChanged");document.dispatchEvent(e)},n.loadFromBackend=function(){var e=this;return(0,i._)(function(){var t,n,r,i,s,o,u,d,c;return(0,l.Jh)(this,function(p){switch(p.label){case 0:return p.trys.push([0,10,,11]),[4,e.executeMutation("pages.getPages",{uid:e.uid})];case 1:if("success"!==(t=p.sent()).status)return[3,9];n=!0,r=!1,i=void 0,p.label=2;case 2:p.trys.push([2,7,8,9]),s=function(){var t,n,r,i,s,o,d,c,p;return(0,l.Jh)(this,function(f){switch(f.label){case 0:return t=u.value,e.addPage({id:t.id,name:t.name,pageAiContext:t.pageAiContext||"",type:"page"}),e.markAsSynced("page",t.id),[4,e.executeMutation("groups.getGroups",{uid:e.uid})];case 1:if("success"!==(n=f.sent()).status)return[3,9];r=!0,i=!1,s=void 0,f.label=2;case 2:f.trys.push([2,7,8,9]),o=function(){var n,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:return n=c.value,e.addGroup(t.id,(0,a._)({id:n.id,name:n.name,type:"group"},n)),e.markAsSynced("group",n.id),[4,e.executeMutation("groups.getGroupWireframes",{groupId:n.id})];case 1:return"success"===(r=i.sent()).status&&r.wireframes.forEach(function(t){e.addWireframe(n.id,t),e.markAsSynced("wireframe",t.id)}),[2]}})},d=n.groups[Symbol.iterator](),f.label=3;case 3:if(r=(c=d.next()).done)return[3,6];return[5,(0,l.XA)(o())];case 4:f.sent(),f.label=5;case 5:return r=!0,[3,3];case 6:return[3,9];case 7:return p=f.sent(),i=!0,s=p,[3,9];case 8:try{r||null==d.return||d.return()}finally{if(i)throw s}return[7];case 9:return[2]}})},o=t.pages[Symbol.iterator](),p.label=3;case 3:if(n=(u=o.next()).done)return[3,6];return[5,(0,l.XA)(s())];case 4:p.sent(),p.label=5;case 5:return n=!0,[3,3];case 6:return[3,9];case 7:return d=p.sent(),r=!0,i=d,[3,9];case 8:try{n||null==o.return||o.return()}finally{if(r)throw i}return[7];case 9:return[2,!0];case 10:throw console.error("Error loading from backend:",c=p.sent()),(0,E.z)(c);case 11:return[2]}})})()},n.startAutoSync=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this.stopAutoSync();var t=this;this.autoSyncInterval=setInterval((0,i._)(function(){return(0,l.Jh)(this,function(e){switch(e.label){case 0:if(!t.hasPendingChanges())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.syncToBackend()];case 2:return e.sent(),[3,4];case 3:return console.error("Auto-sync failed:",e.sent()),[3,4];case 4:return[2]}})}),1e3*e)},n.stopAutoSync=function(){this.autoSyncInterval&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null)},n.destroy=function(){this.stopAutoSync()},SyncedDesignData}(b),R=n(68232),getAddSectionPrompt=function(e,t,n){var r="";switch(t){case"left":r="User request: ".concat(e,"\nTarget placement: left of ").concat(n,'\n\nCRITICAL RULES:\n1. The new section MUST appear to the LEFT of the target section horizontally at ALL screen sizes.\n2. Use horizontal layout (flex-row) - NO responsive breakpoints that change to vertical.\n3. The new section MUST be visible on mobile without manual stretching.\n\nLAYOUT IMPLEMENTATION:\n- ALWAYS use flex-row at base level (NOT flex-col md:flex-row)\n- Set minimum widths to ensure mobile visibility:\n  - min-w-[280px] or min-w-[50vw] on EACH section\n  - flex-shrink-0 to prevent collapse\n- Enable horizontal scrolling:\n  - overflow-x-auto on wrapper container\n\nEXAMPLE:\nhtml\n<div class="flex flex-row overflow-x-auto w-full gap-4">\n  <div id="new-section" class="min-w-[280px] flex-shrink-0 p-4">\n    <!-- New content -->\n  </div>\n  <div id="target" class="min-w-[280px] flex-shrink-0">\n    <!-- Target section -->\n  </div>\n</div>\n\n\nFIXED/ABSOLUTE POSITIONED TARGET:\nIf target uses position:fixed or position:absolute:\n- Convert to position:relative\n- Then apply horizontal layout as above\n\nLAYOUT STRATEGY:\n1. Wrap new section and target in flex-row container\n2. New section comes FIRST in DOM (left position)\n3. Apply: min-w-[280px] flex-shrink-0 to both sections\n4. Apply: overflow-x-auto to wrapper\n5. Preserve target\'s existing classes and IDs\n\nVISIBILITY RULES:\n- NO display:none, opacity:0, or hidden overflow that hides content\n- Sections must be visible on mobile through horizontal scroll\n- NO vertical stacking at any screen size');break;case"right":r="User request: ".concat(e,"\nTarget placement: right of ").concat(n,'\n\nCRITICAL RULES:\n1. The new section MUST appear to the RIGHT of the target section horizontally at ALL screen sizes.\n2. Use horizontal layout (flex-row) - NO responsive breakpoints that change to vertical.\n3. The new section MUST be visible on mobile without manual stretching.\n\nLAYOUT IMPLEMENTATION:\n- ALWAYS use flex-row at base level (NOT flex-col md:flex-row)\n- Set minimum widths to ensure mobile visibility:\n  - min-w-[280px] or min-w-[50vw] on EACH section\n  - flex-shrink-0 to prevent collapse\n- Enable horizontal scrolling:\n  - overflow-x-auto on wrapper container\n\nEXAMPLE:\nhtml\n<div class="flex flex-row overflow-x-auto w-full gap-4">\n  <div id="target" class="min-w-[280px] flex-shrink-0">\n    <!-- Target section -->\n  </div>\n  <div id="new-section" class="min-w-[280px] flex-shrink-0 p-4">\n    <!-- New content -->\n  </div>\n</div>\n\n\nFIXED/ABSOLUTE POSITIONED TARGET:\nIf target uses position:fixed or position:absolute:\n- Convert to position:relative\n- Then apply horizontal layout as above\n\nLAYOUT STRATEGY:\n1. Wrap target and new section in flex-row container\n2. New section comes SECOND in DOM (right position)\n3. Apply: min-w-[280px] flex-shrink-0 to both sections\n4. Apply: overflow-x-auto to wrapper\n5. Preserve target\'s existing classes and IDs\n\nVISIBILITY RULES:\n- NO display:none, opacity:0, or hidden overflow that hides content\n- Sections must be visible on mobile through horizontal scroll\n- NO vertical stacking at any screen size');break;case"below":r="User request: ".concat(e,"\nTarget placement: below ").concat(n,'\n\nCRITICAL RULES:\n1. The new section MUST appear BELOW the target section in both DOM order and visual layout.\n2. The new section MUST be visually visible and occupy real space.\n3. Use vertical layout (flex-col or block flow) at ALL screen sizes.\n\nFIXED/ABSOLUTE POSITIONED TARGET:\nIf target uses position:fixed or position:absolute (common with footers):\n- Convert target to position:relative or position:static\n- OR add bottom padding/margin to body/main equal to target height\n- Place new section in normal document flow after the target\n\nEXAMPLE (fixed footer):\nhtml\n<!-- BEFORE -->\n<nav id="footer" class="fixed bottom-0 left-0 right-0 bg-white z-50">...</nav>\n\n<!-- AFTER -->\n<nav id="footer" class="relative bg-white">...</nav>\n<div id="new-section" class="w-full p-4"><!-- New content --></div>\n\n\nLAYOUT STRATEGY:\n1. Check if target is fixed/absolute - if yes, convert it or add spacing\n2. Place new section immediately after target in DOM\n3. Use w-full on new section for full width\n4. Stack vertically with flex-col on parent if wrapping is needed\n\nVISIBILITY RULES:\n- NO display:none, opacity:0, position:absolute/fixed on new section\n- NO negative margins or z-index tricks\n- New section must occupy real vertical space');break;case"above":r="User request: ".concat(e,"\nTarget placement: above ").concat(n,'\n\nCRITICAL RULES:\n1. The new section MUST appear ABOVE the target section in both DOM order and visual layout.\n2. The new section MUST be visually visible and occupy real space.\n3. Use vertical layout (flex-col or block flow) at ALL screen sizes.\n\nFIXED/ABSOLUTE POSITIONED TARGET:\nIf target uses position:fixed or position:absolute:\n- Convert target to position:relative or position:static\n- OR add top padding/margin to body/main equal to target height\n- Place new section in normal document flow above the target\n\nEXAMPLE (fixed header):\nhtml\n<!-- BEFORE -->\n<header id="header" class="fixed top-0 left-0 right-0 bg-white z-50">...</header>\n\n<!-- AFTER -->\n<div id="new-section" class="w-full p-4"><!-- New content --></div>\n<header id="header" class="sticky top-0 bg-white z-50">...</header>\n\n\nLAYOUT STRATEGY:\n1. Check if target is fixed/absolute - if yes, convert it or add spacing\n2. Place new section immediately before target in DOM\n3. Use w-full on new section for full width\n4. Stack vertically with flex-col on parent if wrapping is needed\n\nVISIBILITY RULES:\n- NO display:none, opacity:0, position:absolute/fixed on new section\n- NO negative margins or z-index tricks\n- New section must occupy real vertical space')}return r},F=n(4392),V=n(72319),k=n(79398),hooks_useCachedDesignData=function(){var e=(0,F.aC)().userInfo,t=(0,u._)((0,f.useState)(function(){return new G(null==e?void 0:e.uid)}),2),n=t[0],r=t[1],i=(0,f.useCallback)(function(t){r(function(n){var r=new G(null==e?void 0:e.uid);return Object.assign(r,n),"function"==typeof t?t(r):Object.assign(r,t),r})},[null==e?void 0:e.uid]);return(0,f.useEffect)(function(){return n.startAutoSync(5),function(){n.stopAutoSync()}},[n]),[n,i]},N=n(83438),U=n(76340),hooks_useCacheWireFrames=function(e){var t=(0,U.Z)().notify,n=(0,u._)((0,N.Z)("wireframeData",e||[]),2),r=n[0],i=n[1];return(0,f.useEffect)(function(){if(Array.isArray(r)){var e=new Date().getTime(),n=!1,s=r.filter(function(e){return Array.isArray(e)}).map(function(t){var r=t.map(function(t){return t?!t.isLoading||t.isLoading&&t.requestTime+12e4>e?t:(0,o._)((0,a._)({},t),{error:"Unable to load wireframe",isLoading:!1,retryId:new Date().getTime()}):null}).filter(Boolean);return r.length!==t.length&&(n=!0),r.map(function(t){return t?t.saveStatus===D.G3.IS_SAVING&&t.saveTime+3e4<e?(n=!0,(0,o._)((0,a._)({},t),{saveStatus:D.G3.UNSAVED})):t:null}).filter(Boolean)}).filter(function(e){return Array.isArray(e)&&e.length>0});n&&(i(s),t("Removed wireframes that were loading for more than 2 minutes","info"))}},[r,i,t]),[r,i]},H=n(52477),B=n(16972),J=n(60659),useWireframeMigration=function(e){var t,n,r=e.wireframesData,s=e.setWireframesData,a=e.setLoadingCurrentPage,o=e.getPagesData,d=(0,F.aC)().userInfo,c=(0,U.Z)().notify,p=(0,u._)((0,f.useState)(!1),2),m=p[0],g=p[1],h=(0,u._)((0,H.mm)(),1)[0],v=(0,u._)((0,B.mp)(),1)[0],y=(0,u._)((0,J.FK)(),1)[0],w=(t=(0,i._)(function(e,t){return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),0===t.length||!e)return[2];return[4,y({uid:e.uid,wireframes:t.map(function(e){return e.map(function(e){return e.id}).filter(Boolean)})})];case 1:return n.sent(),s([]),[3,3];case 2:return console.error("Error storing session:",n.sent()),[3,3];case 3:return[2]}})}),function(e,n){return t.apply(this,arguments)}),S=(n=(0,i._)(function(e,t){var n,r,i,s,d,p,f,m,y,S,_;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(0===e.length||!t)return[2];g(!0),a(!0),l.label=1;case 1:l.trys.push([1,13,14,15]),n=[],r=!0,i=!1,s=void 0,l.label=2;case 2:l.trys.push([2,7,8,9]),d=e.entries()[Symbol.iterator](),l.label=3;case 3:if(r=(p=d.next()).done)return[3,6];return m=(f=(0,u._)(p.value,2))[0],y=f[1],[4,h({name:"Group ".concat(m+1),uid:t.uid,wireframeIds:y.map(function(e){return e.id}).filter(Boolean)})];case 4:S=l.sent(),n.push(S.groupId),l.label=5;case 5:return r=!0,[3,3];case 6:return[3,9];case 7:return _=l.sent(),i=!0,s=_,[3,9];case 8:try{r||null==d.return||d.return()}finally{if(i)throw s}return[7];case 9:return[4,v({name:"Default Page",uid:t.uid,groupIds:n,wireframeIds:[]})];case 10:return l.sent(),[4,o()];case 11:return l.sent(),localStorage.setItem("backupWireframesData",JSON.stringify(e)),[4,w(t,e)];case 12:return l.sent(),[3,15];case 13:return console.error("Error migrating data:",l.sent()),c({message:"Failed to migrate data to new page",type:"error"}),[3,15];case 14:return g(!1),a(!1),[7];case 15:return[2]}})}),function(e,t){return n.apply(this,arguments)});(0,f.useEffect)(function(){r&&r.length>0&&!m&&S(r,d)},[r,d,m])},z=n(36061),j=n(83683),Y=n(28811),Z=n.n(Y),K=n(69075),X=n(30791),Q=n(36902),q=Z()(function(){return n.e(7337).then(n.t.bind(n,42692,23))},{loadableGenerated:{webpack:function(){return[42692]}}});function _updateWireframe(){return(_updateWireframe=(0,i._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,C.h.dispatch(Q.cr.endpoints.updateWireframeImage.initiate(e))];case 1:if((t=n.sent()).error)throw t.error;return[2,t.data];case 2:return console.error("Error in saving review:",n.sent()),[3,3];case 3:return[2]}})})).apply(this,arguments)}var $=(r=(0,i._)(function(e,t,n){var r,i,s,a,o,u,d;return(0,l.Jh)(this,function(l){switch(l.label){case 0:(r=document.createElement("iframe")).style.position="absolute",r.style.left="-9999px",document.body.appendChild(r),i=new Promise(function(e){r.onload=e}),(s=r.contentDocument||r.contentWindow.document).open(),s.write(n),s.close(),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.race([i,new Promise(function(e,t){return setTimeout(function(){return t(Error("iframe load timeout"))},1e4)})])];case 2:return l.sent(),[3,4];case 3:throw a=l.sent(),document.body.removeChild(r),a;case 4:return l.trys.push([4,10,11,12]),[4,q(s.documentElement,{height:800,width:1440,windowHeight:800,windowWidth:1440,logging:!1})];case 5:return o=l.sent().toDataURL("image/png"),u=X.tO.refFromURL("gs://uxpilot-auth.appspot.com/wireframes/".concat(e,".png")),[4,fetch(o).then(function(e){return e.blob()})];case 6:return d=l.sent(),[4,u.put(d)];case 7:return l.sent(),[4,u.getDownloadURL()];case 8:return[4,function(e){return _updateWireframe.apply(this,arguments)}({imageUrl:l.sent(),uid:t,wireframeId:e})];case 9:return l.sent(),[3,12];case 10:return console.error("Error processing or uploading image:",l.sent()),[3,12];case 11:return document.body.removeChild(r),[7];case 12:return[2]}})}),function(e,t,n){return r.apply(this,arguments)});(0,i._)(function(e){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return t=e.googleUID,n=e.setAllSavedWireframes,[4,(0,K.o_)({uid:t,isSaved:!0}).then(function(e){var t;if((null==e?void 0:null===(t=e.wireframes)||void 0===t?void 0:t.length)>0){var r=e.wireframes.sort(function(e,t){return new Date(t.date)-new Date(e.date)});n(r);var i=JSON.stringify(r);localStorage.setItem("savedWireframes",i)}else n([])}).catch(function(e){console.error("Error fetching saved scripts:",e)})];case 1:return r.sent(),[2]}})});var ee=n(2497),et={topic:"",flow:"",activeTab:"single-screen",genNumb:1,temperature:.7,selectedType:ee.ke.DESKTOP,selectedModel:"model-5",designSystem:"ds-2",modelVariant:"may-2025",isRegenerateModal:"",fineTune:!1,selectedFont:"",selectedColor:"cyan",isDarkMode:!1,customCollectionName:"",selectedDesignMode:"hifi",deepDesign:!1,useMaxLimit:!1,screenFlows:[],uploadedImage:null,uploadedDocument:null,itemsAttachedWithContext:[],themeId:null,numberOfVariants:1,isFigmaImport:!1,useCase:ee.ke.DESKTOP,lastUsedMode:"studio"},en={backgroundColor:"#f7f9fa",backgroundColorUnit:"HEX"},er={uploadedImage:null,prompt:"",contextForDesign:null,pickingContext:!1,designMode:"",selectedModel:"",modelVariant:"",designSystem:"",customCollectionName:"",itemsAttachedWithContext:[],useMaxLimit:!1,useVariation:!1,numberOfVersion:1,isTransformHifi:!1,createAFlow:!1,screenFlows:[],selectedType:"",selectedDesignMode:"",isHiFi:!1,mainScreenId:"",selectedFont:"",isFigmaImport:!1},ei=n(11981),es=n(72894),ea=n(74056);function ActionCard(e){var t=e.type,n=e.message,r={error:(0,c.jsx)(ei.Z,{className:"w-5 h-5 text-red-400"}),warning:(0,c.jsx)(es.Z,{className:"w-5 h-5 text-amber-400"}),info:(0,c.jsx)(ea.Z,{className:"w-5 h-5 text-blue-400"})};return(0,c.jsx)("div",{className:"".concat({error:"bg-red-50 border-red-400",warning:"bg-amber-50 border-amber-400",info:"bg-blue-50 border-blue-400"}[t]," border-l-4 rounded-l p-4"),children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:r[t]}),(0,c.jsx)("div",{className:"ml-3",children:(0,c.jsx)("p",{className:"text-sm ".concat({error:"text-red-700",warning:"text-amber-700",info:"text-blue-700"}[t]),children:n})})]})})}var eo=n(93046),eu=n(16958),ed=n(14699),el=n(35669),ec=(0,m.kr)(void 0),useWireframer=function(){var e=(0,m.Sz)(ec,function(e){return e});if(!e)throw Error("useWireframer must be used within a WireframerProvider");return e},WireframerProvider=function(e){var t,n,r,m,v,y,w,S,_,E,C,T,b,x,P,M,L,O,H,B,J,Y,Z,K,X,q,ei,es,ea,ep,ef,em,eg,eh,ev,ey,ew,eS,e_,eI,eE,eA,eC,eT,eD,eb,ex,eW,eP,eM,eL,eO,eG=e.children,eR=(0,U.Z)(),eF=eR.notify,eV=eR.notifyWithAction,ek=eR.managedToast,eN=(0,eo.I0)(),eU=(0,k.z)(),eH=(0,p.useRouter)(),eB=(0,f.useRef)(null),eJ=(0,p.useSearchParams)(),ez=(0,F.aC)(),ej=ez.googleUID,eY=ez.userInfo,eZ=(0,z.U)().openModal,eK=(0,j.useActionModal)().openModal,eX=(0,g.Sz)().sidebarVersion,eQ=(0,u._)((0,f.useState)(""),2),eq=eQ[0],e$=eQ[1],e0=(0,u._)((0,f.useState)(!1),2),e1=e0[0],e3=e0[1],e2=(0,u._)((0,f.useState)(null),2),e6=e2[0],e4=e2[1],e9=(0,u._)((0,f.useState)(null),2),e5=e9[0],e7=e9[1],e8=(0,u._)((0,f.useState)(!1),2),te=e8[0],tt=e8[1],tn=(0,u._)((0,f.useState)(!1),2),tr=tn[0],ti=tn[1],ts=(0,V.mU)(),ta=ts.isSubscribed,to=ts.counters,tu=ts.planType,td=ts.refetchSubscription,tl=(0,u._)((0,f.useState)(null),2),tc=tl[0],tp=tl[1],tf=(0,u._)((0,f.useState)([]),2),tm=tf[0],tg=tf[1],th=(0,u._)((0,f.useState)([]),2),tv=th[0],ty=th[1],tw=(0,u._)((0,f.useState)([]),2);tw[0],tw[1];var tS=(0,u._)((0,f.useState)(!1),2),t_=tS[0],tI=tS[1],tE=(0,u._)((0,f.useState)(!1),2),tA=tE[0],tC=tE[1],tT=(0,u._)((0,f.useState)(null),2),tD=tT[0],tb=tT[1],tx=(0,u._)((0,f.useState)(null),2),tW=tx[0],tP=tx[1],tM=(0,u._)((0,f.useState)(!0),2),tL=tM[0],tO=tM[1],tG=(0,u._)((0,f.useState)(null),2),tR=tG[0],tF=tG[1],tV=(0,u._)((0,f.useState)([]),2),tk=tV[0],tN=tV[1],tU=(0,u._)((0,f.useState)([]),2),tH=tU[0],tB=tU[1],tJ=(0,u._)(hooks_useCacheWireFrames([]),2),tz=tJ[0],tj=tJ[1],tY=(0,u._)((0,f.useState)(!1),2),tZ=tY[0],tK=tY[1],tX=(0,u._)((0,f.useState)(et),2),tQ=tX[0],tq=tX[1],t$=(0,u._)((0,f.useState)(en),2),t0=t$[0],t1=t$[1],t3=(0,u._)((0,f.useState)(null),2),t2=t3[0],t6=t3[1],t4=(0,u._)((0,f.useState)(null),2),t9=t4[0],t5=t4[1],t7=(0,u._)((0,f.useState)(null),2),t8=t7[0],ne=t7[1],nt=(0,u._)((0,f.useState)(null),2),nn=nt[0],nr=nt[1],ni=(0,u._)((0,f.useState)(null),2),ns=ni[0],na=ni[1],no=(0,u._)((0,f.useState)([]),2),nu=no[0],nd=no[1],nl=(0,u._)((0,f.useState)(null),2),nc=nl[0],np=nl[1],nf=(0,u._)((0,f.useState)(null),2),nm=nf[0],ng=nf[1],nh=(0,u._)((0,f.useState)([]),2),nv=nh[0],ny=nh[1],nw=(0,u._)((0,f.useState)([]),2),nS=nw[0],n_=nw[1],nI=(0,u._)((0,f.useState)(!1),2),nE=nI[0],nA=nI[1],nC=(0,u._)((0,f.useState)([]),2),nT=nC[0],nD=nC[1],nb=(0,u._)((0,f.useState)(null),2),nx=nb[0],nW=nb[1],nP=(0,u._)((0,f.useState)(null),2),nM=nP[0],nL=nP[1],nO=(0,u._)((0,f.useState)([]),2),nG=nO[0];nO[1];var nR=(0,u._)((0,f.useState)(void 0),2),nF=nR[0],nV=nR[1],nk=(0,u._)((0,f.useState)(!1),2),nN=nk[0],nU=nk[1],nH=(0,u._)((0,N.Z)("regenerateFormData",er),2),nB=nH[0],nJ=nH[1],nz=(0,u._)((0,f.useState)(!1),2),nj=nz[0],nY=nz[1],nZ=(0,u._)((0,f.useState)(new Map),2),nK=nZ[0],nX=nZ[1],nQ=(0,u._)((0,f.useState)({designSystem:"ds-2",customCollectionName:"",modelVariant:"may-2025"}),2),nq=nQ[0],n$=nQ[1],n0=(0,u._)((0,f.useState)([]),2),n1=n0[0],n3=n0[1],n2=(0,u._)((0,f.useState)(null),2),n6=n2[0],n4=n2[1],n9=(0,u._)((0,f.useState)([]),2),n5=n9[0],n7=n9[1],n8=(0,u._)((0,f.useState)([]),2),re=n8[0],rt=n8[1],rn=(0,u._)((0,f.useState)(!1),2),rr=rn[0],ri=rn[1],rs=(0,u._)((0,f.useState)(!1),2),ra=rs[0],ro=rs[1],ru=(0,u._)((0,f.useState)(null),2),rd=ru[0],rl=ru[1],rc=(0,u._)(hooks_useCachedDesignData(),2),rp=rc[0],rf=rc[1],rm=(0,u._)((0,f.useState)(null),2),rg=rm[0],rh=rm[1],rv=(0,u._)((0,f.useState)(!1),2),ry=rv[0],rw=rv[1],rS=(0,u._)((0,f.useState)(!1),2),r_=rS[0],rI=rS[1],rE=(0,u._)((0,f.useState)(!1),2),rA=rE[0],rC=rE[1],rT=(0,u._)((0,f.useState)(!1),2),rD=rT[0],rb=rT[1],rx=(0,u._)((0,f.useState)(!1),2),rW=rx[0],rP=rx[1],rM=(0,u._)((0,f.useState)([]),2),rL=rM[0],rO=rM[1],rG=(0,u._)((0,A.t7)(),1)[0],rR=(0,u._)((0,A.UC)(),1)[0],rF=(0,u._)((0,A.zV)(),1)[0],rV=(0,u._)((0,A.Ad)(),1)[0],rk=(0,u._)((0,A.mj)(),1)[0],rN=(0,u._)((0,A.Dr)(),1)[0],rU=(0,u._)((0,A.G7)(),1)[0],rH=(0,u._)((0,Q.Qy)(),1)[0],rB=(0,u._)((0,A.iK)(),1)[0],rJ=(0,u._)((0,A.At)(),1)[0],rz=(0,u._)((0,A.lT)(),1)[0],rj=(0,u._)((0,A.mm)(),1)[0],rY=(0,u._)((0,A.mp)(),1)[0],rZ=(0,u._)((0,A.qV)(),1)[0],rK=(0,u._)((0,A.N1)(),1)[0],rX=(0,u._)((0,A.Jo)(),1)[0],rQ=(0,u._)((0,A.L_)(),1)[0],rq=(0,u._)((0,A.Us)(),1)[0],r$=(0,u._)((0,A.g$)(),1)[0],r0=(0,u._)((0,A.H1)(),1)[0],r1=(0,u._)((0,A.KR)(),1)[0],r3=(0,u._)((0,A.s3)(),1)[0],r2=(0,u._)((0,A.wy)(),1)[0],r6=(0,u._)((0,A.PR)(),1)[0],r4=(0,u._)((0,A.og)(),1)[0],r9=(0,u._)((0,A.Av)(),1)[0],r5=(0,u._)((0,A.Zt)(),1)[0],r7=(0,u._)((0,A.ic)(),1)[0],r8=(0,u._)((0,A.iC)(),1)[0],ie=(0,u._)((0,A.Qu)(),1)[0],it=(0,u._)((0,A.Tm)(),1)[0],ir=(0,u._)((0,A.nY)(),1)[0],ii=(0,u._)((0,f.useState)({shapes:[],assets:[]}),2),is=ii[0],ia=ii[1],io=(0,f.useCallback)((t=(0,i._)(function(e){var t,n,r,i=arguments;return(0,l.Jh)(this,function(s){switch(s.label){case 0:t=i.length>1&&void 0!==i[1]?i[1]:null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,rj({name:t||"Group ".concat(rp.getAllGroups().length+1)}).unwrap()];case 2:return n=s.sent(),rf(function(t){return t.addGroup(e,n.group),t}),[2,n.groupId];case 3:throw console.error("Error creating new group:",r=s.sent()),eF({message:"Failed to create new group",type:"error"}),r;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[rp]),iu=(n={currentPageId:rg,designsData:rp,pageVersionGroups:nK,setDesignsData:rf,setPageVersionGroups:nX,createNewGroup:io,notify:eF,managedToast:ek},r=(0,F.aC)().userInfo,m=n.currentPageId,v=n.designsData,n.pageVersionGroups,y=n.setDesignsData,w=n.setPageVersionGroups,S=n.createNewGroup,_=n.notify,E=n.managedToast,T=(0,f.useCallback)((C=(0,i._)(function(e,t,n){var r,i,s,a,o,u,c,p;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(n){r=(0,d._)(n.versionScreens).concat([{id:n.mainScreen}]),i=!0,s=!1,a=void 0;try{for(o=r[Symbol.iterator]();!(i=(u=o.next()).done);i=!0)if((c=u.value).id!==e&&v.getWireframe(c.id)&&(p=v.findParentGroup(c.id)))return[2,p]}catch(e){s=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(s)throw a}}}return[4,S(m)];case 1:return[2,t.sent()]}})}),function(e,t,n){return C.apply(this,arguments)}),[m,v,S]),b=(0,f.useCallback)(function(e,t,n,r){var i,s=!(arguments.length>4)||void 0===arguments[4]||arguments[4];if(e){if(r){var u=[r.mainScreen].concat((0,d._)(r.versionScreens.map(function(e){return e.id})));i=e.getCurrentPageShapes().find(function(e){return"frame"===e.type&&u.includes(e.props.wireframeId)})}var l={w:n.w,h:n.h,name:t.screenTitle||t.prompt||"",wireframeId:t.id};if(i)e.updateShape((0,o._)((0,a._)({},i),{x:n.x,y:n.y,props:(0,a._)({},i.props,l)}));else if(s)(0,W.wf)(e,{title:l.name,wireframeId:t.id,status:(0,el.rh)(t),dimensions:{width:n.w,height:n.h},position:{x:n.x,y:n.y}}),e.zoomToBounds({x:n.x-100,y:n.y-100,w:n.w+150,h:n.h+150},{animation:{duration:500}});else{var c=e.getCurrentPageShapes().find(function(e){return"frame"===e.type&&e.props.wireframeId===t.id});c&&e.updateShape((0,o._)((0,a._)({},c),{x:n.x,y:n.y,props:(0,a._)({},c.props,l)}))}}},[]),P=(0,f.useCallback)((x=(0,i._)(function(e){var t,n,i,u,c,p,f,g,h,S,I,A,C;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(t=e.wireframe,n=e.shapeData,i=e.versionGroup,u=e.groupId,c=(0,W.W_)(),(p=E()).start("Restoring screen..."),!m)return _({message:"Failed to restore: No page selected",type:"error"}),[2];l.label=1;case 1:if(l.trys.push([1,4,,5]),f=v.getWireframe(t.id),g=null==c?void 0:c.getCurrentPageShapes().find(function(e){return"frame"===e.type&&e.props.wireframeId===t.id}),h=!f,S=!g,I=f||t,!h)return[3,3];return[4,T(t.id,u,i)];case 2:A=l.sent(),C=(0,o._)((0,a._)({},I),{status:(0,el.rh)(I),position:(0,o._)((0,a._)({},I.position),(0,s._)({},m,{x:n.x,y:n.y})),dimensions:(0,o._)((0,a._)({},I.dimensions),(0,s._)({},m,{width:n.w,height:n.h}))}),y(function(e){return e.addWireframe(A,C,!1),e.markAsUnsynced("group",A),e.markAsUnsynced("page",m),e}),l.label=3;case 3:return i?(w(function(e){var t=new Map(e),n=t.get(m)||[],r=new Set([i.mainScreen].concat((0,d._)(i.versionScreens.map(function(e){return e.id})))),s=n.filter(function(e){return![e.mainScreen].concat((0,d._)(e.versionScreens.map(function(e){return e.id}))).some(function(e){return r.has(e)})});return t.set(m,(0,d._)(s).concat([i])),t}),y(function(e){var t=new G(null==r?void 0:r.uid);Object.assign(t,e);var n=i.mainScreen;return i.versionScreens.forEach(function(e){if(t.getWireframe(e.id)){var r=t.getWireframe(e.id);t.updateWireframe(e.id,(0,o._)((0,a._)({},r),{parentId:n})),t.markAsUnsynced("wireframe",e.id)}}),t})):h&&w(function(e){var n=new Map(e),r=n.get(m)||[];if(!r.some(function(e){return e.mainScreen===t.id})){var i={versionScreens:[],mainScreen:t.id,currentVisible:t.id,expanded:!1,order:r.length,date:new Date().toISOString()};n.set(m,(0,d._)(r).concat([i]))}return n}),b(c,I,n,i,S),p.finish(),_({message:h?"Screen restored":"Screen position restored",type:"success"}),[3,5];case 4:return console.error("Restoration failed",l.sent()),_({message:"Failed to restore screen",type:"error"}),[3,5];case 5:return[2]}})}),function(e){return x.apply(this,arguments)}),[m,v,r,T,b,y,w,_]),L=(0,f.useCallback)((M=(0,i._)(function(e){var t,n,r,i,c,p,f,g,h,v,S,_,I,A,C,D;return(0,l.Jh)(this,function(x){switch(x.label){case 0:if(!m)return[2];(t=E()).start("Restoring screens..."),x.label=1;case 1:x.trys.push([1,19,,20]),n=(0,W.W_)(),r=new Map,i=[],e.forEach(function(e){var t;if(null===(t=e.versionGroup)||void 0===t?void 0:t.mainScreen){var n=e.versionGroup.mainScreen;r.has(n)||r.set(n,[]),r.get(n).push(e)}else i.push(e)}),c=!0,p=!1,f=void 0,x.label=2;case 2:x.trys.push([2,7,8,9]),g=function(){var e,t,r,i,c,p,f,g,h,S,_;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=(e=(0,u._)(v.value,2))[0],i=(r=e[1])[0].versionGroup,c=r.find(function(e){return e.wireframe.id===t})||r[0],[4,T(t,c.groupId,i)];case 1:if(p=l.sent(),y(function(e){return r.forEach(function(n){var r=n.wireframe,i=n.shapeData;if(!e.getWireframe(r.id)){var u=r.id===t,d=(0,o._)((0,a._)({},r),{parentId:u?null:t,status:(0,el.rh)(r),position:(0,o._)((0,a._)({},r.position),(0,s._)({},m,{x:i.x,y:i.y})),dimensions:(0,o._)((0,a._)({},r.dimensions),(0,s._)({},m,{width:i.w,height:i.h}))});e.addWireframe(p,d,!1)}}),e.markAsUnsynced("group",p),e.markAsUnsynced("page",m),e}),w(function(e){var n=new Map(e),r=n.get(m)||[],s=r.findIndex(function(e){return e.mainScreen===t});return -1!==s?(r[s]=i,n.set(m,(0,d._)(r))):n.set(m,(0,d._)(r).concat([i])),n}),!n||((f=i.expanded?r:r.filter(function(e){return e.wireframe.id===i.currentVisible})).forEach(function(e){b(n,e.wireframe,e.shapeData,i,!0)}),!(n&&f.length>0)))return[3,3];return g=1/0,h=1/0,S=-1/0,_=-1/0,f.forEach(function(e){var t=e.shapeData,n=t.x,r=t.y,i=t.w,s=t.h;n<g&&(g=n),r<h&&(h=r),n+i>S&&(S=n+i),r+s>_&&(_=r+s)}),g!==1/0&&n.zoomToBounds({x:g-100,y:h-100,w:S-g+200,h:_-h+200},{animation:{duration:500}}),[4,new Promise(function(e){return setTimeout(e,600)})];case 2:l.sent(),l.label=3;case 3:return[2]}})},h=r.entries()[Symbol.iterator](),x.label=3;case 3:if(c=(v=h.next()).done)return[3,6];return[5,(0,l.XA)(g())];case 4:x.sent(),x.label=5;case 5:return c=!0,[3,3];case 6:return[3,9];case 7:return S=x.sent(),p=!0,f=S,[3,9];case 8:try{c||null==h.return||h.return()}finally{if(p)throw f}return[7];case 9:_=!0,I=!1,A=void 0,x.label=10;case 10:x.trys.push([10,16,17,18]),C=i[Symbol.iterator](),x.label=11;case 11:if(_=(D=C.next()).done)return[3,15];return[4,P(D.value)];case 12:return x.sent(),[4,new Promise(function(e){return setTimeout(e,600)})];case 13:x.sent(),x.label=14;case 14:return _=!0,[3,11];case 15:return[3,18];case 16:return S=x.sent(),I=!0,A=S,[3,18];case 17:try{_||null==C.return||C.return()}finally{if(I)throw A}return[7];case 18:return t.update("Screens restored successfully","success"),[3,20];case 19:return console.error("Batch restore failed",x.sent()),t.update("Failed to restore some screens","error"),[3,20];case 20:return[2]}})}),function(e){return M.apply(this,arguments)}),[m,T,P,b,y,w,E]),{restoreWireframe:P,restoreMultipleWireframes:L}),id=iu.restoreWireframe,il=iu.restoreMultipleWireframes,ic=(O=(0,i._)(function(e){var t,n,r,i,s,u,d=arguments;return(0,l.Jh)(this,function(l){switch(l.label){case 0:t=d.length>1&&void 0!==d[1]?d[1]:"",n=d.length>2&&void 0!==d[2]&&d[2],r=d.length>3&&void 0!==d[3]?d[3]:{topic:"",selectedType:et.selectedType,selectedDesignMode:et.selectedDesignMode},ri(!0),l.label=1;case 1:return l.trys.push([1,8,9,10]),[4,rY({name:i=e||"Page ".concat(tv.length+1),pageAiContext:t,uid:null==eY?void 0:eY.uid}).unwrap()];case 2:if(s=l.sent(),!n)return[3,4];return[4,rZ({pageId:s.pageId,pageAiContext:t,formData:(0,a._)((0,o._)((0,a._)({},tQ),{topic:r.topic,selectedType:r.selectedType,selectedDesignMode:r.selectedDesignMode}),void 0!==r.deepDesign&&{deepDesign:r.deepDesign})})];case 3:l.sent(),l.label=4;case 4:return rf(function(e){e.addPage({id:s.pageId,name:i,pageAiContext:t},!0)}),eU.capture(D.Je.PAGE_CREATED,{page_name:i,user_id:ej,distinct_id:ej}),[4,iy()];case 5:if(l.sent(),!n)return[3,7];return[4,iL(null,void 0,{id:s.pageId,pageAiContext:t,topic:r.topic,selectedType:r.selectedType,selectedDesignMode:r.selectedDesignMode,deepDesign:r.deepDesign})];case 6:l.sent(),l.label=7;case 7:return n||tq(et),t1(en),[2,s.pageId];case 8:throw console.error("Error creating new page:",u=l.sent()),eF({message:"Failed to create new page",type:"error"}),u;case 9:return ri(!1),[7];case 10:return[2]}})}),function(e){return O.apply(this,arguments)}),ip=(H=(0,i._)(function(e){var t,n,r,i=arguments;return(0,l.Jh)(this,function(s){switch(s.label){case 0:t=i.length>1&&void 0!==i[1]?i[1]:"",n=i.length>2&&void 0!==i[2]?i[2]:{topic:"",selectedType:et.selectedType,selectedDesignMode:et.selectedDesignMode},ri(!0),s.label=1;case 1:return s.trys.push([1,6,7,8]),[4,rZ({pageId:e,formData:(0,a._)((0,o._)((0,a._)({},tQ),{topic:n.topic,selectedType:n.selectedType,selectedDesignMode:n.selectedDesignMode}),void 0!==n.deepDesign&&{deepDesign:n.deepDesign}),pageAiContext:t})];case 2:return s.sent(),[4,iE(e,!1)];case 3:return s.sent(),[4,iy()];case 4:return s.sent(),[4,iL(null,void 0,(0,a._)({id:e,pageAiContext:t,topic:n.topic,selectedType:n.selectedType,selectedDesignMode:n.selectedDesignMode},void 0!==n.deepDesign&&{deepDesign:n.deepDesign}))];case 5:return s.sent(),[3,8];case 6:throw console.error("Error creating new page:",r=s.sent()),eF({message:"Failed to generate screen on selected page",type:"error"}),r;case 7:return ri(!1),[7];case 8:return[2]}})}),function(e){return H.apply(this,arguments)}),im=(B=(0,i._)(function(e,t){var n,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),!(n=tv.find(function(t){return t.id===e})))throw Error("Page not found");return[4,rZ({pageId:e,pageAiContext:(null==t?void 0:t.pageAiContext)||"",name:n.name,groupIds:n.groupIds||[],wireframeIds:n.wireframeIds||[]})];case 1:return i.sent(),ty(tv.map(function(n){return n.id===e?(0,a._)({},n,t):n})),rf(function(n){return n.getPage(e)&&n.updatePage(e,(0,a._)({},n.getPage(e),t)),n}),eF({message:"Page settings updated successfully",type:"success"}),[2,{success:!0}];case 2:return console.error("Error updating page settings:",r=i.sent()),eF({message:"Error updating page settings",type:"error"}),[2,{success:!1,error:r}];case 3:return[2]}})}),function(e,t){return B.apply(this,arguments)}),ig=(J=(0,i._)(function(e){var t,n,r,i,u,c,p,f,m,g,h,v,y;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if((n=ek()).start("Adding wireframe to page..."),r=(0,W.W_)(),i={x:0,y:0},r&&(i=getTargetPosition(r)),c=(u=nK.get(rg)||[]).some(function(t){return t.versionScreens.some(function(t){return t.id===e.id})}),p=u.some(function(t){return t.mainScreen===e.id}),c||p)return n.update("Wireframe already on this page","info"),[2];return[4,io(rg)];case 1:return f=l.sent(),[4,r2({wireframeId:e.id}).unwrap()];case 2:return h=(null==(g=(null==(m=l.sent())?void 0:m.wireframe)||m)?void 0:null===(t=g.dimensions)||void 0===t?void 0:t.width)?null==g?void 0:g.dimensions:(0,el.Mi)(null==g?void 0:g.useCase,null==g?void 0:g.width,null==g?void 0:g.height),rf(function(t){t.addWireframe(f,(0,o._)((0,a._)({},g),{status:(0,el.rh)(g),position:(0,o._)((0,a._)({},e.position),(0,s._)({},rg,{x:i.x,y:i.y})),dimensions:(0,o._)((0,a._)({},h),(0,s._)({},rg,{width:h.width,height:h.height}))}))}),nX(function(e){var t=new Map(e),n=t.get(rg)||[],r={versionScreens:[],mainScreen:g.id,currentVisible:g.id,expanded:!1,order:0,date:new Date().toISOString()};return t.set(rg,(0,d._)(n).concat([r])),t}),r&&(y=(null==g?void 0:null===(v=g.dimensions)||void 0===v?void 0:v.width)?null==g?void 0:g.dimensions:(0,el.Mi)(null==g?void 0:g.useCase,null==g?void 0:g.width,null==g?void 0:g.height),(0,W.wf)(r,{title:(null==g?void 0:g.screenTitle)||(null==g?void 0:g.prompt)||"",wireframeId:g.id,status:(0,el.rh)(g),dimensions:y,position:i}),r.zoomToBounds({x:i.x-100,y:i.y-100,w:(null==h?void 0:h.width)+200||0,h:(null==h?void 0:h.height)+200||0},{animation:{duration:500}}),n.update("Design added successfully","success")),[2]}})}),function(e){return J.apply(this,arguments)}),ih=(0,f.useCallback)((0,i._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,rq().unwrap()];case 1:return(null==(e=t.sent())?void 0:e.status)==="success"&&tg(function(t){return(null==e?void 0:e.groups)||t}),[3,3];case 2:return console.error("Error fetching groups:",t.sent()),[3,3];case 3:return[2]}})}),[eY]),iv=(0,f.useCallback)((0,i._)(function(){return(0,l.Jh)(this,function(e){switch(e.label){case 0:if(!rg||null===rg)return console.warn("⚠️ getShapesData called with invalid currentPageId:",rg),[2];if(!(null==eY?void 0:eY.uid)||null===eY.uid)return console.warn("⚠️ getShapesData called with invalid uid:",null==eY?void 0:eY.uid),[2];e.label=1;case 1:return e.trys.push([1,3,4,5]),tC(!0),[4,r7({pageId:rg}).unwrap()];case 2:return e.sent(),[3,5];case 3:return console.error("Error fetching shapes:",e.sent()),[3,5];case 4:return tC(!1),[7];case 5:return[2]}})}),[rg,eY]),iy=(0,f.useCallback)((0,i._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!(null==eY?void 0:eY.uid))return[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),tI(!0),[4,r$().unwrap()];case 2:return(null==(e=t.sent())?void 0:e.status)==="success"&&ty(null==e?void 0:e.pages),[3,5];case 3:return console.error("Error in getting pages:",t.sent()),[3,5];case 4:return tI(!1),[7];case 5:return[2]}})}),[eY]),iw=(0,f.useCallback)((Y=(0,i._)(function(e){var t,n,r,i,s,u,c,p,f,m,g,h,v,y,w,S,_;return(0,l.Jh)(this,function(l){switch(l.label){case 0:(t=ek()).start("Restoring wireframe..."),l.label=1;case 1:return l.trys.push([1,4,,5]),[4,r2({wireframeId:e}).unwrap()];case 2:if(!(null==(r=(null==(n=l.sent())?void 0:n.wireframe)||n)?void 0:r.id))return t.update("Failed to restore wireframe","error"),[2,!1];if(!(i=(0,W.W_)()))return[2,!1];return[4,io(rg)];case 3:return s=l.sent(),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.addWireframe(s,r,!0),t}),u=i.getCurrentPageShapes(),c=100,p=100,u.length>0&&(c=((null==(h=u[u.length-1])?void 0:h.x)||0)+((null==h?void 0:null===(f=h.props)||void 0===f?void 0:f.w)||(null==h?void 0:null===(g=h.props)||void 0===g?void 0:null===(m=g.dimensions)||void 0===m?void 0:m.width)||1440)+200,p=(null==h?void 0:h.y)||100),y="object"==typeof(v=r.dimensions||{width:1440,height:840})&&"width"in v&&"height"in v?{width:v.width,height:v.height}:{width:1440,height:840},S={wireframeId:e,status:r.status||"completed",title:r.prompt||r.screenTitle||"Restored Wireframe",dimensions:y,position:{x:c,y:p},isPrototype:null!==(w=r.isPrototype)&&void 0!==w&&w},(0,W.wf)(i,S),nX(function(t){var n=new Map(t),r=n.get(rg)||[],i=r.find(function(t){return t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e})});if(i){var s=r.map(function(t){return t===i?(0,o._)((0,a._)({},t),{currentVisible:e}):t});n.set(rg,s)}else{var u={versionScreens:[],mainScreen:e,currentVisible:e,expanded:!1,order:r.length,date:new Date().toISOString()};n.set(rg,(0,d._)(r).concat([u]))}return n}),t.update("Wireframe restored successfully","success"),[2,!0];case 4:return _=l.sent(),console.error("[RESTORE] Error restoring wireframe ".concat(e,":"),_),t.update("Failed to restore wireframe","error"),[2,!1];case 5:return[2]}})}),function(e){return Y.apply(this,arguments)}),[rf,null==eY?void 0:eY.uid,rg,ek,nX,io]),iS=(0,f.useCallback)(function(e){try{var t,n,r,i,s,u,l,c,p,f=(0,W.W_)();if(!f)return;var m=e.wireframeId;if(!m)return;var g="shape:"+m,h=f.getCurrentPageShapes(),v=f.getShape(g)||h.find(function(e){var t;return(null==e?void 0:e.type)==="frame"&&(null==e?void 0:null===(t=e.props)||void 0===t?void 0:t.wireframeId)===m});if(!v){var y=nK.get(rg)||[],w=y.find(function(e){return e.mainScreen===m||e.versionScreens.some(function(e){return e.id===m})});if(w&&w.currentVisible!==m){var S=[w.mainScreen,w.currentVisible].concat((0,d._)(w.versionScreens.map(function(e){return e.id}))),_=h.find(function(e){var t;return(null==e?void 0:e.type)==="frame"&&S.includes(null==e?void 0:null===(t=e.props)||void 0===t?void 0:t.wireframeId)});if(_){var I=null==rp?void 0:rp.getWireframe(m);I&&((0,W.gT)(f,_.id,{wireframeId:m,status:I.status,dimensions:I.dimensions,title:I.prompt||I.topic||""}),nX(function(e){var t=new Map(e),n=y.map(function(e){return e===w?(0,o._)((0,a._)({},e),{currentVisible:m}):e});return t.set(rg,n),t}),v=_)}}}if(!v){iw(m).then(function(e){e?iS({wireframeId:m}):console.warn("Could not restore wireframe ".concat(m))});return}if(!v)return;var E=null!==(l=v.x)&&void 0!==l?l:0,A=null!==(c=v.y)&&void 0!==c?c:0,C=(null==v?void 0:null===(t=v.props)||void 0===t?void 0:t.w)||(null==v?void 0:null===(r=v.props)||void 0===r?void 0:null===(n=r.dimensions)||void 0===n?void 0:n.width)||1440,T=(null==v?void 0:null===(i=v.props)||void 0===i?void 0:i.h)||(null==v?void 0:null===(u=v.props)||void 0===u?void 0:null===(s=u.dimensions)||void 0===s?void 0:s.height)||840;f.zoomToBounds({x:E-100,y:A-100,w:C+200,h:T+200},{animation:{duration:500}}),f.setSelectedShapes([null!==(p=v.id)&&void 0!==p?p:g])}catch(e){console.error("focusWireframe error",e)}},[rp,nK,rg,nX,iw]);(0,f.useEffect)(function(){tR||nJ(function(e){return(0,o._)((0,a._)({},er),{selectedModel:e.selectedModel,modelVariant:e.modelVariant,designSystem:e.designSystem,customCollectionName:e.customCollectionName,itemsAttachedWithContext:[]})})},[nJ,tR]),(0,f.useEffect)(function(){var e=tu!==D.FD.STANDARD&&tu!==D.FD.INACTIVE;tu&&tQ.useMaxLimit&&!e&&tq(function(e){return(0,o._)((0,a._)({},e),{useMaxLimit:!1})})},[tu,tQ,tq]),(0,f.useEffect)(function(){var e=tu!==D.FD.STANDARD&&tu!==D.FD.INACTIVE;tu&&nB.useMaxLimit&&!e&&nJ(function(e){return(0,o._)((0,a._)({},e),{useMaxLimit:!1})})},[tu,nB.useMaxLimit,nJ]),(0,f.useEffect)(function(){var e=null==eJ?void 0:eJ.get("page");e&&!rr&&!t_&&e.length>0&&e!==rg&&tv.length>0&&tv.find(function(t){return t.id===e})&&iE(e,!0)},[eJ]),useWireframeMigration({wireframesData:tz,setWireframesData:tj,setLoadingCurrentPage:ri,getPagesData:iy}),(0,f.useEffect)(function(){var e=localStorage.getItem("mv-update-status");(null==eY?void 0:eY.uid)&&"done"!==e&&(tq(function(e){return(0,o._)((0,a._)({},e),{modelVariant:"oct-2024"===e.modelVariant?"may-2025":e.modelVariant})}),localStorage.setItem("mv-update-status","done"))},[eY]);var i_=(0,f.useCallback)((0,i._)(function(){return(0,l.Jh)(this,function(e){switch(e.label){case 0:return[4,Promise.all([ih(),iy(),iv()])];case 1:return e.sent(),[2]}})}),[eY]);(0,f.useEffect)(function(){(null==eY?void 0:eY.uid)&&(rf(function(e){e.setUID(null==eY?void 0:eY.uid)}),i_())},[eY]),(0,f.useEffect)(function(){eB.current!==rg&&rg&&!rr&&(iI(rg),eB.current=rg,eF({message:"Page loaded successfully",type:"success"}))},[rg]);var iI=(0,f.useCallback)(function(e){if(eJ){var t=new URLSearchParams(eJ);e&&t.set("page",e),eH.push("/a/ui-design?".concat(t.toString()))}},[eH,eJ]),iE=(Z=(0,i._)(function(e){var t,n,r,s,u,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T,b,x,W,P,M=arguments;return(0,l.Jh)(this,function(L){switch(L.label){case 0:t=M.length>1&&void 0!==M[1]&&M[1],ri(!0),L.label=1;case 1:return L.trys.push([1,5,6,7]),[4,r0({pageId:e}).unwrap()];case 2:if("success"!==(s=L.sent()).status)throw Error("Error fetching page");return[4,r8({pageId:e}).unwrap()];case 3:var O;return u=L.sent(),c=s.page,p=(0,d._)(c.groups||[]),f=(0,d._)(c.shapes||[]),t1({backgroundColor:null!==(m=null==c?void 0:null===(n=c.config)||void 0===n?void 0:n.backgroundColor)&&void 0!==m?m:en.backgroundColor,backgroundColorUnit:null!==(g=null==c?void 0:null===(r=c.config)||void 0===r?void 0:r.backgroundColorUnit)&&void 0!==g?g:en.backgroundColorUnit}),h=new Date().getTime(),v=function(e){var t,n=e.status||(0,el.rh)(e),r=null!==(t=e.dimensions)&&void 0!==t?t:(0,el.Mi)(null==e?void 0:e.useCase),i=(null==e?void 0:e.updatedAt)||(null==e?void 0:e.date),s=!1;return"generating"===n&&(s=h-new Date(i).getTime()>6e5),(0,o._)((0,a._)({},e),{status:s?"failed":n,dimensions:r})},O=(0,i._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!e.wireframeIds||0===e.wireframeIds.length)return[2,(0,o._)((0,a._)({},e),{wireframes:[]})];return[4,r3({wireframeIds:e.wireframeIds}).unwrap()];case 1:return t=n.sent().map(v),[2,(0,o._)((0,a._)({},e),{wireframes:t})]}})}),y=function(e){return O.apply(this,arguments)},[4,Promise.all((c.groups||[]).map(y))];case 4:if(w=L.sent(),!c||!p)throw Error("Error fetching page");return rf(function(t){t.addPage((0,o._)((0,a._)({},c),{id:e,name:c.name,type:D.Ty.PAGE}),!0)}),rf(function(t){p.forEach(function(n){t.addGroup(e,n,!0)})}),rf(function(e){null==w||w.forEach(function(t){t.wireframes.forEach(function(n){e.addWireframe(t.id,n,!0)})})}),(null==w?void 0:w.some(function(e){return e.wireframes.some(function(e){return"generating"===e.status||"generating"===(0,el.rh)((0,o._)((0,a._)({},e),{uid:null==eY?void 0:eY.uid}))})}))&&setTimeout(function(){ro(!0)},1e3),rf(function(t){f.forEach(function(n){t.addShape(e,n,!0)})}),rf(function(t){t.markPageAsSynced(e)}),t&&e!==rg&&(rh(e),t6(null),nY(!1),E=(null!==(I=null==(_=null!==(S=null==c?void 0:c.formData)&&void 0!==S?S:et)?void 0:_.itemsAttachedWithContext)&&void 0!==I?I:[]).filter(function(e){return!e.isLoading}),C=(null==c?void 0:c.formData)!==void 0&&(null==c?void 0:c.formData)!==null?null!==(A=_.deepDesign)&&void 0!==A&&A:tu===D.FD.FREE,tq(function(e){var t,n,r,i,s,u,d,l,c,p,f,m;return(0,o._)((0,a._)({},e),{topic:null!==(t=null==_?void 0:_.topic)&&void 0!==t?t:"",screenFlows:null!==(n=null==_?void 0:_.screenFlows)&&void 0!==n?n:e.screenFlows,selectedDesignMode:null!==(r=null==_?void 0:_.selectedDesignMode)&&void 0!==r?r:e.selectedDesignMode,selectedType:null!==(i=null==_?void 0:_.selectedType)&&void 0!==i?i:e.selectedType,modelVariant:null!==(s=null==_?void 0:_.modelVariant)&&void 0!==s?s:e.modelVariant,selectedModel:null!==(u=null==_?void 0:_.selectedModel)&&void 0!==u?u:e.selectedModel,designSystem:null!==(d=null==_?void 0:_.designSystem)&&void 0!==d?d:e.designSystem,customCollectionName:null!==(l=null==_?void 0:_.customCollectionName)&&void 0!==l?l:e.customCollectionName,useCase:null!==(c=null==_?void 0:_.selectedType)&&void 0!==c?c:e.useCase,deepDesign:C,useMaxLimit:null!==(p=null==_?void 0:_.useMaxLimit)&&void 0!==p?p:e.useMaxLimit,uploadedImage:null!==(f=null==_?void 0:_.uploadedImage)&&void 0!==f?f:null,itemsAttachedWithContext:E,lastUsedMode:null!==(m=null==_?void 0:_.lastUsedMode)&&void 0!==m?m:e.lastUsedMode})})),u&&(null==u?void 0:u.status)==="success"&&rf(function(t){var n;null==u||null===(n=u.assets)||void 0===n||n.forEach(function(n){t.addAsset(e,n,!0)})}),[3,7];case 5:if(console.error("Error loading page:",T=L.sent()),eF({message:(null===(x=T.response)||void 0===x?void 0:null===(b=x.data)||void 0===b?void 0:b.message)||"Error loading page data",type:"error"}),(null===(W=T.response)||void 0===W?void 0:W.status)===403&&(null===(P=T.response)||void 0===P?void 0:P.statusText)==="Forbidden")return e3(!0),ri(!1),[2];return eH.push("/a/ui-list"),e&&rf(function(t){return t.removePage(e),t}),[3,7];case 6:return ri(!1),[7];case 7:return[2]}})}),function(e){return Z.apply(this,arguments)}),iA=(K=(0,i._)(function(e){var t,n,r,i,u,c,p,f,m,g,v,y,w,S,_,I,E,A,C,T;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(tK(!0),(t=ek()).start("Adding wireframes to page..."),!tm.find(function(t){return t.id===e}))return t.update("Group not found","error"),[2];l.label=1;case 1:return l.trys.push([1,6,7,8]),[4,r1({groupId:e}).unwrap()];case 2:if(!(n=l.sent())||0===n.wireframes.length)return t.update("No wireframes found in group","info"),[2];if(!(n.wireframes.length>0))return[3,4];if(c=(0,h.c2)(n.wireframes),p=nK.get(rg)||[],0==(f=c.filter(function(e){return!p.some(function(t){return t.mainScreen===e.mainScreen})})).length)return t.update("All wireframes already on this page","info"),[2];return[4,io(rg,m="Group with ".concat(n.wireframes.length," wireframes"))];case 3:return g=l.sent(),rf(function(e){e.addGroup(rg,(0,a._)({id:g,name:m,type:D.Ty.GROUP},n))}),w=(y=getTargetPosition(v=(0,W.W_)())).x,S=y.y,_=w,E=(I=n.wireframes.map(function(e){var t,n,r=(0,o._)((0,a._)({},e),{status:(0,el.rh)(e),position:(0,o._)((0,a._)({},null==e?void 0:e.position),(0,s._)({x:_,y:S},rg,{x:_,y:S})),dimensions:(null==e?void 0:null===(t=e.dimensions)||void 0===t?void 0:t.width)?(0,o._)((0,a._)({},null==e?void 0:e.dimensions),(0,s._)({},rg,null==e?void 0:e.dimensions)):(0,o._)((0,a._)({},(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height)),(0,s._)({},rg,(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height)))});return _+=(null==r?void 0:null===(n=r.dimensions)||void 0===n?void 0:n.width)+((null==e?void 0:e.useCase)===ee.ke.DESKTOPLEGACY||(null==e?void 0:e.useCase)===ee.ke.DESKTOP||(null==e?void 0:e.useCase)===ee.ke.DESKTOPHD||(null==e?void 0:e.useCase)===ee.ke.TABLET?144:72),r})).reduce(function(e,t){var n;return e+(null==t?void 0:null===(n=t.dimensions)||void 0===n?void 0:n.width)},0),A=(r=Math).max.apply(r,(0,d._)(I.map(function(e){var t;return null==e?void 0:null===(t=e.dimensions)||void 0===t?void 0:t.height}))),C=(i=Math).min.apply(i,(0,d._)(I.map(function(e){var t;return null==e?void 0:null===(t=e.position)||void 0===t?void 0:t.x}))),T=(u=Math).max.apply(u,(0,d._)(I.map(function(e){var t;return null==e?void 0:null===(t=e.position)||void 0===t?void 0:t.y}))),rf(function(e){I.forEach(function(t){e.addWireframe(g,t)})}),nX(function(e){var t=new Map(e),n=t.get(rg)||[];return t.set(rg,(0,d._)(n).concat((0,d._)(f))),t}),v&&(I.forEach(function(e){var t,n=e.dimensions[rg],r=null===(t=e.position)||void 0===t?void 0:t[rg];(0,W.wf)(v,{title:(null==e?void 0:e.screenTitle)||(null==e?void 0:e.prompt)||"",wireframeId:e.id||e.wireframeId,status:e.status,dimensions:n,position:r})}),v.zoomToBounds({x:C-100,y:T-100,w:E+400,h:A+200},{animation:{duration:500}})),t.update("Wireframes added successfully","success"),[3,5];case 4:eF({message:"No wireframes found in group",type:"info"}),l.label=5;case 5:return[3,8];case 6:return console.error("Error in adding group wireframes:",l.sent()),t.update("Error in adding group wireframes","error"),[3,8];case 7:return tK(!1),[7];case 8:return[2]}})}),function(e){return K.apply(this,arguments)});(0,I.ZP)(I.zW.updateGroupsData,ih),(0,I.ZP)(I.zW.getPagesData,iy),(0,I.ZP)(I.zW.pageDeleted,function(e){var t=e.pageId;ty(tv.filter(function(e){return e.id!==t})),iy()}),(0,I.ZP)(I.zW.generateDeviceVersion,function(e){iR(e.wireframeId,e.targetDevice)});var iC=(X=(0,i._)(function(e){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t5(e),rf(function(t){t.setLoadingGroup(e,!0)}),[4,rp.saveGroup(e)];case 1:return r.sent(),(0,I.hb)(I.zW.exportGroupWireframe,{groupIdToExport:e}),rf(function(t){t.clearLoadingGroup(e)}),(t=rp.getGroup(e))&&tg(function(e){return(0,d._)(e).concat([(0,o._)((0,a._)({},t),{isSaved:!0})])}),[3,3];case 2:return console.error("Error in saving group:",n=r.sent()),eF({message:"Error in saving group",type:"error"}),rf(function(t){t.setLoadingGroup(e,!1,n.message)}),[3,3];case 3:return[2]}})}),function(e){return X.apply(this,arguments)}),iT=(q=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),rf(function(t){t.setLoadingGroup(e,!0)}),[4,rp.unsaveGroup(e)];case 1:return t.sent(),rf(function(t){t.clearLoadingGroup(e)}),tg(tm.map(function(t){return t.id===e?(0,o._)((0,a._)({},t),{isSaved:!1}):t})),[3,3];case 2:return console.error("Error in unsaving group:",t.sent()),[3,3];case 3:return[2]}})}),function(e){return q.apply(this,arguments)}),iD=(ei=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),rf(function(t){t.setLoadingGroup(e,!0)}),[4,rp.removeGroupFromDB(e)];case 1:return t.sent(),rg&&rf(function(t){t.removeGroup(rg,e)}),rf(function(t){t.clearLoadingGroup(e)}),[3,3];case 2:return console.error("Error in deleting group:",t.sent()),eF({message:"Error in deleting group",type:"error"}),[3,3];case 3:return[2]}})}),function(e){return ei.apply(this,arguments)});(0,f.useEffect)(function(){"custom"!=tQ.selectedModel&&tq(function(e){return(0,o._)((0,a._)({},e),(0,s._)({},e.selectedModel,""))})},[tQ.selectedModel]),(0,f.useEffect)(function(){var e,t=rp.getPage(rg),n=(null==t?void 0:t.formData)||{},r=Object.keys(tQ).every(function(e){return n[e]===tQ[e]}),i=null===(e=tQ.itemsAttachedWithContext)||void 0===e?void 0:e.filter(function(e){return!e.isLoading});!r&&rg&&rf(function(e){e.updatePage(rg,{formData:(0,o._)((0,a._)({},tQ),{itemsAttachedWithContext:i})})})},[rg,tQ,rf]);var ib=(es=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!rg)return[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,rZ({pageId:rg,config:e})];case 2:return t.sent(),[3,5];case 3:return console.warn("Failed to persist page config",t.sent()),[3,5];case 4:return rf(function(t){t.updatePage(rg,{config:(0,a._)({},e)})}),t1(e),[7];case 5:return[2]}})}),function(e){return es.apply(this,arguments)}),ix=(ea=(0,i._)(function(){return(0,l.Jh)(this,function(e){return tq(function(e){return(0,a._)({},et)}),[2]})}),function(){return ea.apply(this,arguments)}),iW=(0,f.useCallback)(function(e,t){tq(function(n){if(n[e]===t)return n;var r=(0,o._)((0,a._)({},n),(0,s._)({},e,t));return"selectedType"===e&&(r.useCase=t),"selectedDesignMode"===e&&("hifi"===t?(r.designSystem=nq.designSystem,r.customCollectionName=nq.customCollectionName,r.modelVariant=nq.modelVariant):(r.designSystem="ds-2",r.customCollectionName="",r.modelVariant="may-2025")),"hifi"===n.selectedDesignMode&&n$({designSystem:n.designSystem,customCollectionName:n.customCollectionName,modelVariant:n.modelVariant}),r})},[tq,nq]);function getWireframeDataObject(e,t,n,r){return{id:e.id,order:t,type:D.Ty.WIREFRAME,isHiFi:e.isHiFi,isL1:!e.isWireFrame&&"ds-1"===n.designSystem,uid:ej,designSystem:n.designSystem,prompt:e.prompt?e.prompt:n.topic,screenTitle:e.title,saveStatus:D.G3.UNSAVED,useCase:n.selectedType,model:n.selectedModel,status:e.status||"generating",customCollectionName:n.customCollectionName,wireframeId:e.id,fineTune:n.fineTune,date:new Date().toISOString(),position:(0,o._)((0,a._)({},e.position||getWireframeShapePositionByWireframeId(e.id)),(0,s._)({},r,e.position||getWireframeShapePositionByWireframeId(e.id))),isLoading:!0,dimensions:(0,o._)((0,a._)({},(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height)),(0,s._)({},r,(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height)))}}(0,f.useEffect)(function(){var handleSectionSelected=function(e){tP(e.detail)};return document.addEventListener("sectionSelected",handleSectionSelected),function(){document.removeEventListener("sectionSelected",handleSectionSelected)}},[]);var iP=(ep=(0,i._)(function(e,t,n,r){return(0,l.Jh)(this,function(i){return e&&e.length>0&&(rf(function(i){var s=new G(null==eY?void 0:eY.uid);return Object.assign(s,i),e.forEach(function(e,i){var a=getWireframeDataObject(e.design,i,t,n);s.addWireframe(r,a,!0),s.removeWireframe(r,e.tempId),iV(e.tempId,a.id)}),s}),e.forEach(function(e,i){var s=getWireframeDataObject(e.design,i,t,n),a=(0,W.W_)();a&&a.getCurrentPageShapes().forEach(function(t){"frame"===t.type&&t.props.wireframeId===e.tempId&&(0,W.gT)(a,t.id,{wireframeId:s.id,groupId:r,status:s.status,dimensions:s.dimensions,position:{x:t.x,y:t.y},title:s.screenTitle||s.prompt})})}),setTimeout(function(){ro(!0)},1e3)),[2]})}),function(e,t,n,r){return ep.apply(this,arguments)});(0,i._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!ta)return eZ("save-ui"),[2];if(!(t=rp.getWireframe(e)))return[2];rf(function(n){n.updateWireframe(e,(0,o._)((0,a._)({},t),{saveStatus:D.G3.IS_SAVING}))}),n.label=1;case 1:return n.trys.push([1,5,,6]),[4,rz({data:{wireframeId:t.id,isSaved:!0,isL1:t.isL1,isHiFi:t.isHiFi}}).unwrap()];case 2:if("success"!==n.sent().status)return[3,4];return[4,$(t.id,ej,t.wireframeOutputHtml)];case 3:n.sent(),rf(function(n){n.updateWireframe(e,(0,o._)((0,a._)({},t),{saveStatus:D.G3.SAVED}))}),n.label=4;case 4:return[3,6];case 5:return console.error("Save error:",n.sent()),eF({message:"Error saving wireframe",type:"error"}),rf(function(n){n.updateWireframe(e,(0,o._)((0,a._)({},t),{saveStatus:D.G3.UNSAVED}))}),[3,6];case 6:return[2]}})}),(0,i._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:t={wireframeId:e.id,isSaved:!0,isL1:e.isL1||!1,isHiFi:e.isHiFi||"hifi"===tQ.selectedDesignMode},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,rz({data:t}).unwrap()];case 2:return[2,n.sent()];case 3:return n.sent(),[2,!1];case 4:return[2]}})});var iM=(ef=(0,i._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:if(!ta||tu===D.FD.INACTIVE)return eZ(D.GY.SAVE_TO_FIGMA),[2];if(!e)return eF({message:"Wireframe not found",type:"error"}),[2];t=e.id||e.wireframeId,r=(n=rp.isWireframeSaved(t))?D.G3.UNSAVED:D.G3.SAVED,rf(function(e){e.setLoadingWireframe(t,!0)}),s.label=1;case 1:if(s.trys.push([1,6,,7]),!n)return[3,3];return[4,rX({wireframeId:t})];case 2:return s.sent(),(0,I.hb)(I.zW.unSaveWireframeFromToolbar,{wireframeId:t}),[3,5];case 3:return[4,rK({wireframeId:t}).unwrap()];case 4:s.sent(),(0,I.hb)(I.zW.saveWireframe,{wireframeId:t}),s.label=5;case 5:return rf(function(i){i.updateWireframe(t,(0,o._)((0,a._)({},e),{isSaved:!n,saveStatus:r})),i.clearLoadingWireframe(e.id)}),[3,7];case 6:return console.error("Error toggling save:",i=s.sent()),rf(function(t){t.setLoadingWireframe(e.id,!1,i.message)}),eF({message:"Failed to ".concat(n?"unsave":"save"," wireframe"),type:"error"}),[3,7];case 7:return[2]}})}),function(e){return ef.apply(this,arguments)}),getTargetPosition=function(e){if(!e)return{x:0,y:0};var t=e.getCurrentPageShapes(),n=0,r=0;return t.forEach(function(e){e.x<r&&(r=e.x);var t,i=(null===(t=e.props)||void 0===t?void 0:t.h)||840,s=e.y+i;s>n&&(n=s)}),n+=500,{x:r,y:n}},processAttachments=function(e){var t,n,r,i=null==e?void 0:null===(t=e.filter(function(e){return"image"===e.type||"image-shape"===e.type}))||void 0===t?void 0:t.map(function(e){var t=e.content;return{type:t.split(".").pop()||"",url:t}}),s=null==e?void 0:null===(n=e.filter(function(e){return"sticky-note-shape"===e.type}))||void 0===n?void 0:n.map(function(e){return e.id.startsWith("shape:")?e.id.split(":")[1]:e.id}),a=null==e?void 0:null===(r=e.filter(function(e){return"document"===e.type}))||void 0===r?void 0:r.map(function(e){return e.id});return{attachedImages:i,stickyNoteIds:s,documentId:(null==a?void 0:a.length)>0?a[0]:void 0}},iL=(em=(0,i._)(function(e,t,n){var r,u,p,f,m,h,v,y,w,S,_,I,E,A,C,T,b,x,P,M,L,O,G,F,V,k,N,U,H,B,J,z;return(0,l.Jh)(this,function(j){switch(j.label){case 0:if(e&&e.preventDefault(),m="single-screen",tQ.numberOfVariants&&tQ.numberOfVariants>1&&(eX===g.MM.V1&&0===tQ.screenFlows.length||"single-screen"===tQ.activeTab))return[2,iO(void 0,"new")];if(f=eX===g.MM.V1?tQ.topic:"create-flow"===(m=tQ.activeTab)?tQ.flow:tQ.topic,h=eU.isFeatureEnabled("use-gm"),null===(r=tQ.screenFlows)||void 0===r?void 0:r.some(function(e){var t;return!(null===(t=e.prompt)||void 0===t?void 0:t.trim())}))return eK({title:"Action Required",children:(0,c.jsx)(ActionCard,{type:"warning",message:"Describe the Screen or Remove the screen from Create Flow before proceeding."})}),[2];if("ds-1"===tQ.designSystem&&"hifi"===tQ.selectedDesignMode&&tu!==D.FD.PRO&&tu!==D.FD.ENTERPRISE)return eZ(D.GY.FLOWBITE),[2];if(v=tQ.isHiFi?"ds-0"===tQ.designSystem?R.Sw.UI_00:"ds-1"===tQ.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20,to.totalAvailableCredits<v)return eZ("save-ui"),[2];return eU.capture(D.Je.CREDITS_USED,{amount:v,reason:"generation",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email,use_gm:h}),y=Date.now(),eU.capture(D.Je.GENERATION_STARTED,{distinct_id:ej,user_id:ej,design_mode:tQ.selectedDesignMode,deep_design:tQ.deepDesign,design_system:tQ.designSystem,model:tQ.selectedModel,device_type:tQ.selectedType,num_generations:tQ.genNumb,has_screen_flows:tQ.screenFlows.length>0,num_screen_flows:tQ.screenFlows.length,has_context:!!t2,temperature:tQ.temperature,is_fine_tune:tQ.fineTune,custom_collection:tQ.customCollectionName,use_gm:h}),eU.capture(D.Je.PROMPT_DETAILS,{prompt:f,design_mode:tQ.selectedDesignMode,deep_design:tQ.deepDesign,design_system:tQ.designSystem,custom_collection:tQ.customCollectionName,timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email,active_tab:tQ.activeTab||"single-screen",use_gm:h}),rw(!0),(null==(w=processAttachments(null==tQ?void 0:tQ.itemsAttachedWithContext))?void 0:w.documentId)&&eU.capture(D.Je.GENERATION_WITH_DOCUMENT_ATTACHED,{document_id:w.documentId,design_mode:tQ.selectedDesignMode,user_id:ej,email:null==eY?void 0:eY.email,use_gm:h}),(null==w?void 0:null===(u=w.attachedImages)||void 0===u?void 0:u.length)>0&&w.attachedImages.forEach(function(e){eU.capture(D.Je.GENERATION_WITH_IMAGE_ATTACHED,{image_url:e.url,image_type:e.type,design_mode:tQ.selectedDesignMode,user_id:ej,email:null==eY?void 0:eY.email,use_gm:h})}),S=(null==n?void 0:n.id)||rg,_=tv.find(function(e){return e.id===S}),I=(null==n?void 0:n.pageAiContext)||(null==_?void 0:_.pageAiContext)||"",[4,io(S)];case 1:var Y;if(E=j.sent(),P=(0,a._)((0,o._)((0,a._)({},tQ),{useMaxLimit:void 0!==tQ.useMaxLimit&&tQ.useMaxLimit}),n?{topic:null!==(A=null==n?void 0:n.topic)&&void 0!==A?A:et.topic,selectedType:null!==(C=null==n?void 0:n.selectedType)&&void 0!==C?C:et.selectedType,selectedDesignMode:null!==(T=null==n?void 0:n.selectedDesignMode)&&void 0!==T?T:et.selectedDesignMode,useCase:null!==(b=null==n?void 0:n.selectedType)&&void 0!==b?b:et.selectedType,selectedModel:et.selectedModel,designSystem:et.designSystem,modelVariant:et.modelVariant,genNumb:et.genNumb,fineTune:et.fineTune,customCollectionName:et.customCollectionName,selectedFont:et.selectedFont,selectedColor:et.selectedColor,isDarkMode:et.isDarkMode,deepDesign:null!==(x=null==n?void 0:n.deepDesign)&&void 0!==x&&x,useMaxLimit:!1,screenFlows:[]}:{}),"single-screen"===m&&eX===g.MM.V2&&(P.flow="",P.screenFlows=[]),M=[],L=[],G=getTargetPosition(O=(0,W.W_)()),("create-flow"===m||eX===g.MM.V1)&&tQ.screenFlows&&tQ.screenFlows.length>0?L=tQ.screenFlows.map(function(e,t){var n="temp_".concat(Date.now(),"_").concat(t);M.push(n);var r=(0,s._)({x:G.x,y:G.y},S,{x:G.x,y:G.y}),i=(0,o._)((0,a._)({},P),{uploadedDocument:void 0,id:n,order:t,wireframeId:n,type:D.Ty.WIREFRAME,isLoading:!0,requestTime:new Date().getTime(),saveStatus:D.G3.UNSAVED,useCase:P.selectedType,status:"generating",screenTitle:e.title,prompt:e.prompt,dimensions:(0,o._)((0,a._)({},(0,el.Mi)(null==P?void 0:P.useCase,null==P?void 0:P.width,null==P?void 0:P.height)),(0,s._)({},S,(0,el.Mi)(null==P?void 0:P.useCase,null==P?void 0:P.width,null==P?void 0:P.height))),position:r});rf(function(e){e.addWireframe(E,i)}),O&&(0,W.wf)(O,{wireframeId:i.id,groupId:E,status:i.status,dimensions:i.dimensions,position:{x:r.x,y:r.y},title:i.screenTitle||i.prompt});var u=i.dimensions.width+100;return G.x+=u,(0,o._)((0,a._)({},e),{position:r,id:void 0,tempId:n})}):(F="temp_".concat(Date.now()),M.push(F),V=(0,o._)((0,a._)({},P),{uploadedDocument:void 0,itemsAttachedWithContext:void 0,id:F,order:0,wireframeId:F,type:D.Ty.WIREFRAME,isLoading:!0,requestTime:new Date().getTime(),saveStatus:D.G3.UNSAVED,useCase:P.selectedType,date:new Date().toISOString(),uid:null==eY?void 0:eY.uid,prompt:P.topic,designMode:P.selectedDesignMode,isHiFi:"hifi"===P.selectedDesignMode,isWireFrame:"wireframe"===P.selectedDesignMode,status:"generating",width:null==P?void 0:P.width,height:null==P?void 0:P.height,dimensions:(0,el.Mi)(null==P?void 0:P.useCase,null==P?void 0:P.width,null==P?void 0:P.height),position:(0,s._)({x:G.x,y:G.y},S,{x:G.x,y:G.y}),isL1:"wireframe"!==P.selectedDesignMode&&"ds-1"===P.designSystem}),rf(function(e){e.addWireframe(E,V,!0)}),O&&((0,W.wf)(O,{wireframeId:V.id,groupId:E,status:V.status,dimensions:V.dimensions,position:{x:G.x,y:G.y},title:V.screenTitle||V.prompt}),O.zoomToBounds({x:G.x,y:G.y,w:(0,el.A3)(null==P?void 0:P.useCase,null==P?void 0:P.width)+1e3,h:(0,el.jv)(null==P?void 0:P.useCase,null==P?void 0:P.height)+1e3},{animation:{duration:500}}))),addNewGroupOnCurrentPage(M,!0,S),k=t2&&rp.getWireframe(t2)?"Context Code To Generate New: \n"+(null===(p=rp.getWireframe(t2))||void 0===p?void 0:p.wireframeOutputHtml):"",N=function(e){var t="Command by user: \n".concat(e,"\n").concat(k);return I&&(t="".concat(t,"\n Project Context (Context for the overall project):\n").concat(I)),t},Y=(0,i._)(function(e){var t,n,r,i,s,o,u,c,p;return(0,l.Jh)(this,function(l){return t=e.result,n=e.isWireframe,r=e.tempId,i=t.id||t.wireframeId||t.uiId,s=(0,a._)({id:i,wireframeId:i,order:0,type:D.Ty.WIREFRAME,isHiFi:!n,isWireFrame:n,isL1:!n&&"ds-1"===P.designSystem,uid:ej,designSystem:P.designSystem,prompt:P.topic,screenTitle:P.topic,saveStatus:D.G3.UNSAVED,useCase:P.selectedType,model:P.selectedModel,customCollectionName:P.customCollectionName,fineTune:P.fineTune,date:new Date().toISOString(),isLoading:!0,uploadedDocument:void 0},t.design),u=(null==(o=rp.getGroup(E))?void 0:o.wireframeIds)||[],c=new Set((0,d._)(u).concat([s.id])),(p=(0,W.W_)())&&p.getCurrentPageShapes().forEach(function(e){"frame"===e.type&&e.props.wireframeId===r&&(0,W.gT)(p,e.id,{wireframeId:s.id,groupId:E,status:s.status,dimensions:s.dimensions,position:{x:e.x,y:e.y},title:s.screenTitle||s.prompt})}),rf(function(e){e.removeWireframe(E,r),e.updateGroup(E,{wireframeIds:Array.from(c)}),e.addWireframe(E,s,!0)}),iV(r,s.id),setTimeout(function(){ro(!0)},1e3),[2]})}),U=function(e){return Y.apply(this,arguments)},t2||(P.selectedFont=""),!(("create-flow"===m||eX===g.MM.V1)&&tQ.screenFlows&&tQ.screenFlows.length>=2))return[3,4];return[4,rN((0,o._)((0,a._)({},P),{topic:N(tQ.flow),userInputPrompt:[tQ.flow],uploadedDocument:void 0,uploadedImage:void 0,itemsAttachedWithContext:void 0,attachments:w,isS:ta,pageId:rg,flows:L,themeId:t||P.themeId,useGM:h})).unwrap()];case 2:return[4,iP(j.sent(),P,S,E)];case 3:case 6:return j.sent(),[3,8];case 4:return j.trys.push([4,7,,8]),[4,("wireframe"===P.selectedDesignMode?rG:rR)((0,o._)((0,a._)({},P),{uploadedDocument:void 0,uploadedImage:void 0,itemsAttachedWithContext:void 0,attachments:w,topic:N(P.topic),userInputPrompt:[P.topic],isS:ta,pageId:S,screenOrder:0,order:0,themeId:t||P.themeId,position:(0,s._)({x:G.x,y:G.y},S,{x:G.x,y:G.y}),useGM:h})).unwrap()];case 5:return H=j.sent(),[4,U({result:H,isWireframe:"wireframe"===P.selectedDesignMode,tempId:M[0]})];case 7:return console.error("Error generating wireframe:",B=j.sent()),eF({message:"Error generating wireframe",type:"error"}),rf(function(e){var t;e.updateWireframe(M[0],{error:null!==(t=null==B?void 0:B.message)&&void 0!==t?t:"Error in generating wireframe",retryId:new Date().getTime(),isLoading:!1})}),[3,8];case 8:rw(!1),J=P.screenFlows.length>0?P.screenFlows.length:1;try{eU.capture(D.Je.GENERATION_COMPLETED,{distinct_id:ej,design_mode:P.selectedDesignMode,design_system:P.designSystem,num_generated:J,has_screen_flows:P.screenFlows.length>0,generation_time:Date.now()-y,timestamp:Date.now(),prompt:P.topic,plan_type:tu,deep_design:P.deepDesign,custom_collection:P.customCollectionName,model:P.selectedModel,device_type:P.selectedType,temperature:P.temperature,is_fine_tune:P.fineTune,uploaded_image:!!P.uploadedImage,user_id:ej,email:null==eY?void 0:eY.email,use_gm:h}),eU.capture(D.Je.GENERATION_CREATED,{distinct_id:ej,design_mode:P.selectedDesignMode,design_system:P.designSystem,num_generated:J,has_screen_flows:P.screenFlows.length>0,generation_time:Date.now()-y,timestamp:Date.now(),prompt:P.topic,plan_type:tu,deep_design:P.deepDesign,custom_collection:P.customCollectionName,model:P.selectedModel,device_type:P.selectedType,temperature:P.temperature,is_fine_tune:P.fineTune,uploaded_image:!!P.uploadedImage,user_id:ej,email:null==eY?void 0:eY.email,use_gm:h}),(z=localStorage.getItem("signupTimestamp"))&&!localStorage.getItem("firstDesignGenerated")&&(eU.capture("TIME_TO_FIRST_DESIGN",{distinct_id:ej,time_ms:Date.now()-Number(z),timestamp:Date.now()}),localStorage.setItem("firstDesignGenerated","true"))}catch(e){eU.capture(D.Je.GENERATION_FAILED,{distinct_id:ej,design_mode:P.selectedDesignMode,design_system:P.designSystem,error_message:e.message,prompt:P.topic,plan_type:tu,deep_design:P.deepDesign,custom_collection:P.customCollectionName,model:P.selectedModel,device_type:P.selectedType,temperature:P.temperature,is_fine_tune:P.fineTune,uploaded_image:!!P.uploadedImage,user_id:ej,email:null==eY?void 0:eY.email,use_gm:h}),console.error("Generation error:",e),eF({message:e.message||"An error occurred while generating wireframes",type:"error"})}return[2]}})}),function(e,t,n){return em.apply(this,arguments)}),getLeftAndRightScreenOrder=function(e,t){var n=rp.findParentGroup(e),r=rp.getGroupWireframes(n).map(function(e){return e.id}),i=iF();if(!i)return 0;var s=i.filter(function(e){return null==r?void 0:r.includes(e.mainScreen)}).sort(function(e,t){return e.order-t.order}),a=-1;if(-1===(a=s.findIndex(function(t){return t.mainScreen===e}))){var o=i.find(function(t){var n;return null===(n=t.versionScreens.map(function(e){return e.id}))||void 0===n?void 0:n.includes(e)});if(-1===(a=s.findIndex(function(e){return e.mainScreen===(null==o?void 0:o.mainScreen)})))return 0}var u=s[a],d=s[a-1],l=s[a+1],c=d?(d.order+u.order)/2:u.order-1,p=l?(l.order+u.order)/2:u.order+1;return"left"===t?c:p},findRootParentPrompt=function(e){for(var t=new Set,n=e.id,r=null,i=[];n&&!t.has(n);){t.add(n);var s=rp.getWireframe(n);if(i.push(n),s&&s.parentId)n=s.parentId;else{r=(null==s?void 0:s.prompt)||null;break}}return r},iO=(eg=(0,i._)(function(e){var t,n,r,u,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T,b,x,P,M,L,O,F,V,k,N,U,H,B,J,z,j,Y,Z,K,X,Q,q,$,et,en,er,ei,es,ea,eo,eu,ed,ec,ep=arguments;return(0,l.Jh)(this,function(ef){switch(ef.label){case 0:if(n="new"===(t=ep.length>1&&void 0!==ep[1]?ep[1]:"regenerate")?tQ.numberOfVariants||2:nB.numberOfVersion||2,r="new"===t?tQ:nB,c="new"===t?"hifi"===tQ.selectedDesignMode:null!==(u=null==e?void 0:e.isHiFi)&&void 0!==u&&u,p="new"===t?tQ.designSystem:nB.designSystem,m="new"===t?tQ.selectedType:null!==(f=null==e?void 0:e.useCase)&&void 0!==f?f:ee.ke.DESKTOP,g="new"===t?tQ.selectedModel:nB.selectedModel,h="new"===t?tQ.customCollectionName:nB.customCollectionName,v=c?"ds-0"===p?R.Sw.UI_00:"ds-1"===p?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20,y="new"===t?tQ.deepDesign:nB.deepDesign,w="new"===t?tQ.uploadedImage:nB.uploadedImage,S=1,r.useMaxLimit?S=3:y&&!w&&(S=2),_=v*S*n,I=eU.isFeatureEnabled("use-gm"),"ds-1"===p&&c&&tu!==D.FD.PRO&&tu!==D.FD.ENTERPRISE)return eZ(D.GY.FLOWBITE),[2];if(to.totalAvailableCredits<_)return eZ("save-ui"),[2];eU.capture(D.Je.CREDITS_USED,{amount:_,reason:"new"===t?"new_variation_generation":"variation_generation",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email,number_of_variations:n,use_gm:I}),E="","new"===t?E=tQ.topic||"":(E=(null==e?void 0:e.prompt)||"",(null==e?void 0:e.parentId)&&(A=findRootParentPrompt(e))&&(E=A)),C=[],ef.label=1;case 1:if(ef.trys.push([1,10,,11]),"new"===t?rw(!0):rC(!0),x=(null==(b="new"===t?processAttachments(null==tQ?void 0:tQ.itemsAttachedWithContext):processAttachments(null==nB?void 0:nB.itemsAttachedWithContext))?void 0:b.attachedImages)&&b.attachedImages.length>0,!(("new"===t?t2:null==nB?void 0:nB.contextForDesign)||x))return[3,2];return P=Array(n).fill(E||""),[3,6];case 2:if("regenerate"!==t)return[3,4];return eU.capture(D.Je.GENERATE_VARIATIONS,{user_id:ej,email:null==eY?void 0:eY.email,number_of_variations:n,page_id:rg}),[4,rB({existingPrompt:E||"",numberOfVersions:n,htmlContent:(null==e?void 0:e.wireframeOutputHtml)||""}).unwrap()];case 3:return P=ef.sent().versions.map(function(e){return e.prompt}),[3,6];case 4:return eU.capture(D.Je.GENERATE_VARIATIONS,{user_id:ej,email:null==eY?void 0:eY.email,number_of_variations:n-1,page_id:rg}),[4,rB({existingPrompt:M=E||"",numberOfVersions:n-1,htmlContent:""}).unwrap()];case 5:L=ef.sent().versions.map(function(e){return e.prompt}),P=[M].concat((0,d._)(L)),ef.label=6;case 6:return[4,io(rg)];case 7:var em;return O=ef.sent(),F=(0,W.W_)(),k=(null==(V="regenerate"===t?null==F?void 0:F.getShape(tR):null)?void 0:V.x)||0,null==V||V.y,N=(0,el.A3)(m),U=(0,el.jv)(m),H=((null==F?void 0:F.getCurrentPageShapes())||[]).filter(function(e){return"frame"===e.type}).map(function(e){var t,n;return{x:e.x,y:e.y,w:(null===(t=e.props)||void 0===t?void 0:t.w)||N,h:(null===(n=e.props)||void 0===n?void 0:n.h)||U}}),B=getTargetPosition(F),H.some(function(e){return Math.abs(e.y-B.y)<U+100&&e.x+e.w+100>B.x})&&(B={x:k,y:(J=Math).max.apply(J,(0,d._)(H.map(function(e){return e.y+e.h})).concat([B.y]))+100}),z=P.map(function(n,i){var u="temp_".concat(Date.now(),"_").concat(i);C.push(u);var d=(0,s._)({x:B.x,y:B.y},rg,{x:B.x,y:B.y}),l=(0,o._)((0,a._)({},"regenerate"===t&&e?e:{},r),{id:u,order:i,wireframeId:u,type:D.Ty.WIREFRAME,isLoading:!0,requestTime:new Date().getTime(),saveStatus:D.G3.UNSAVED,status:"generating",prompt:n,screenTitle:P[i],isVariation:!0,originalWireframeId:"regenerate"===t?tR:void 0,isHiFi:c,isWireFrame:!c,useCase:m,selectedModel:g,modelVariant:r.modelVariant,designSystem:p,customCollectionName:h,useMaxLimit:r.useMaxLimit,isL1:!!c&&"ds-1"===p,dimensions:(0,s._)({width:N,height:U},rg,{width:N,height:U}),position:d});return rf(function(e){e.addWireframe(O,l)}),F&&(0,W.wf)(F,{wireframeId:l.id,groupId:O,status:l.status,dimensions:l.dimensions,position:{x:d.x,y:d.y},title:l.screenTitle||l.prompt}),B.x+=N+100,B.x+N>8e3&&(B.x=k,B.y+=U+100),{tempId:u,prompt:n,position:d,index:i}}),addNewGroupOnCurrentPage(C,!0,rg),F&&z.length>0&&(X=(j=Math).min.apply(j,(0,d._)(z.map(function(e){return e.position.x}))),Q=(Y=Math).max.apply(Y,(0,d._)(z.map(function(e){return e.position.x})))+N,q=(Z=Math).min.apply(Z,(0,d._)(z.map(function(e){return e.position.y}))),$=(K=Math).max.apply(K,(0,d._)(z.map(function(e){return e.position.y})))+U,F.zoomToBounds({x:X-100,y:q-100,w:Q-X+200,h:$-q+200},{animation:{duration:800}})),em=(0,i._)(function(e){return(0,l.Jh)(this,function(n){return e&&e.length>0&&(rf(function(n){var i=new G(null==eY?void 0:eY.uid);return Object.assign(i,n),e.forEach(function(e,n){var u=(0,a._)({id:e.design.id||e.design.wireframeId||e.design.uiId,wireframeId:e.design.id||e.design.wireframeId||e.design.uiId,order:n,type:D.Ty.WIREFRAME,isHiFi:c,isWireFrame:!c,isL1:!!c&&"ds-1"===p,uid:ej,designSystem:p,prompt:e.prompt,screenTitle:P[n],saveStatus:D.G3.UNSAVED,useCase:m,model:g,customCollectionName:h,fineTune:r.fineTune||!1,date:new Date().toISOString(),isLoading:!1,status:"completed",isVariation:!0,originalWireframeId:"regenerate"===t?tR:void 0,position:(0,o._)((0,a._)({},e.position),(0,s._)({},rg,e.position)),dimensions:(0,s._)({width:N,height:U},rg,{width:N,height:U})},e.design);i.addWireframe(O,u,!0),i.removeWireframe(O,e.tempId),iV(e.tempId,u.id)}),i}),e.forEach(function(e,t){var n={id:e.design.id||e.design.wireframeId||e.design.uiId,status:"completed"};F&&F.getCurrentPageShapes().forEach(function(r){"frame"===r.type&&r.props.wireframeId===e.tempId&&(0,W.gT)(F,r.id,{wireframeId:n.id,groupId:O,status:n.status,dimensions:{width:N,height:U},position:{x:r.x,y:r.y},title:P[t]})})}),setTimeout(function(){ro(!0)},1e3)),[2]})}),et=function(e){return em.apply(this,arguments)},er=(null==(en=tv.find(function(e){return e.id===rg}))?void 0:en.pageAiContext)||"",ei=t2&&rp.getWireframe(t2)?"Context Code To Generate New: \n"+(null===(T=rp.getWireframe(t2))||void 0===T?void 0:T.wireframeOutputHtml):"",es=function(e){var t="Command by user: \n".concat(e,"\n").concat(ei);return er&&(t="".concat(t,"\n Project Context (Context for the overall project):\n").concat(er)),t},ea=z.map(function(e,t){return{title:P[t],prompt:e.prompt,position:e.position,id:void 0,tempId:e.tempId}}),eo=es(E),eu="regenerate"===t&&e?(0,o._)((0,a._)({},e),{selectedModel:g,modelVariant:r.modelVariant,designSystem:p,customCollectionName:h,useMaxLimit:r.useMaxLimit,selectedType:m||ee.ke.DESKTOP,selectedDesignMode:c?"hifi":"wireframe"}):(0,o._)((0,a._)({},r),{selectedType:m||ee.ke.DESKTOP,selectedDesignMode:c?"hifi":"wireframe"}),[4,rU((0,o._)((0,a._)({},eu),{topic:eo,userInputPrompt:[E],attachments:b,isS:ta,uid:ej,pageId:rg,flows:ea,useGM:I})).unwrap()];case 8:return ed=ef.sent(),[4,et(ed)];case 9:return ef.sent(),rC(!1),rw(!1),tF(null),eF({message:"Generated ".concat(P.length," variations successfully!"),type:"success"}),[3,11];case 10:return console.error("Error generating variations:",ec=ef.sent()),eF({message:(null==ec?void 0:ec.message)||"Failed to generate variations",type:"error"}),rC(!1),rw(!1),[3,11];case 11:return[2]}})}),function(e){return eg.apply(this,arguments)});(0,f.useEffect)(function(){nE&&!ra&&nv.length>0&&(nv.filter(function(e){var t,n=null===(t=e.props)||void 0===t?void 0:t.wireframeId;return n&&!nS.includes(n)}).forEach(function(e){var t,n=null===(t=e.props)||void 0===t?void 0:t.wireframeId;n&&(handleRemoveVersionScreen(n,e),eF({message:"Generation complete successfully.",type:"success"}))}),ny([])),nA(ra)},[ra,nv,nS,nE]);var iG=(eh=(0,i._)(function(e,t,n,r){var u,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T,b,x,P,M,L,O,F,V,k,N,U,H,B,J,z,j,Y,Z,K,X,Q,q,$,ee,et,en,er,ei,es,ea,eo,eu,ed,ec,ep;function getFormValue(e,t){return p?null==f?void 0:f[t]:null==nB?void 0:nB[e]}return(0,l.Jh)(this,function(ef){switch(ef.label){case 0:if(null==e||e.preventDefault(),!(c=t||tR))return[2];if(n_(function(e){return e.filter(function(e){return e!==c})}),p=n===D.cN,!(f=rp.getWireframe(c)))return eF({message:"Design not found",type:"error"}),rI(!1),[2];if(!getFormValue("useVariation","useVariation"))return[3,2];return[4,iO(f)];case 1:return ef.sent(),[2];case 2:m=Date.now(),g=getFormValue("designMode","designMode"),h=p?null==f?void 0:f.itemsAttachedWithContext:null==nB?void 0:nB.itemsAttachedWithContext,eU.capture(D.Je.REGENERATION_STARTED,{distinct_id:ej,wireframe_id:c,original_prompt:null==f?void 0:f.prompt,new_prompt:eq,design_type:null==f?void 0:f.designSystem,is_hifi:null==f?void 0:f.isHiFi}),(null==(v=processAttachments(h))?void 0:v.documentId)&&eU.capture(D.Je.GENERATION_WITH_DOCUMENT_ATTACHED,{document_id:v.documentId,design_mode:g,user_id:ej,email:null==eY?void 0:eY.email}),(null==v?void 0:null===(u=v.attachedImages)||void 0===u?void 0:u.length)>0&&v.attachedImages.forEach(function(e){eU.capture(D.Je.GENERATION_WITH_IMAGE_ATTACHED,{image_url:e.url,image_type:e.type,design_mode:g,user_id:ej,email:null==eY?void 0:eY.email})}),ef.label=3;case 3:var em;if(ef.trys.push([3,9,10,11]),_=f.isHiFi?"ds-0"===f.designSystem?R.Sw.UI_00:"ds-1"===f.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20,to.totalAvailableCredits<_)return eZ("save-ui"),[2];if(eU.capture(D.Je.CREDITS_USED,{amount:_,reason:"regeneration",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email}),rI(!0),!(I=rp.findParentGroup(c)))return eF({message:"Parent group not found",type:"error"}),rI(!1),[2];if(E=f.order||f.screenOrder,!e6)return[2];A=getLeftAndRightScreenOrder(f.id,e6.direction),"new-screen"===e6.type?E=A:"edit-screen"===e6.type&&(E=E?E-1:0),C=(0,W.W_)(),T="temp_".concat(Date.now()),rf(function(e){e.addWireframe(I,{id:T,order:E,screenOrder:E,type:D.Ty.WIREFRAME,isLoading:!0,status:"generating",useCase:f.useCase,saveStatus:D.G3.UNSAVED,requestTime:new Date().getTime(),parentId:r?c:(null==e6?void 0:e6.type)==="edit-screen"?c:void 0},!0)}),"edit-screen"===e6.type?addWireframeInVersionGroup(c,T,E):addNewScreenOnPage(T,E),C&&((null==e6?void 0:e6.shiftedWireframes)&&e6.shiftedWireframes.length>0&&(b=e6.shiftedWireframes.map(function(e){var t=e.wireframeId,n=e.newX,r=e.newY,i=C.getCurrentPageShapes().find(function(e){var n,r;return(null===(n=e.meta)||void 0===n?void 0:n.wireframeId)===t||(null===(r=e.props)||void 0===r?void 0:r.wireframeId)===t});return i?{id:i.id,type:i.type,x:n,y:r}:null}).filter(Boolean)).length>0&&C.updateShapes(b),x=p?f.prompt:nB.prompt,P=(0,el.Mi)(null==f?void 0:f.useCase,null==f?void 0:f.width,null==f?void 0:f.height),"new-screen"===e6.type&&e6.targetPosition?((0,W.Fe)(C),(0,W.wf)(C,{title:x,wireframeId:T,status:"generating",dimensions:P,groupId:I,position:{x:e6.targetPosition.x,y:e6.targetPosition.y}})):(M=C.getCurrentPageShapes().find(function(e){return"frame"===e.type&&e.props.wireframeId===c}))&&(0,W.gT)(C,M.id,{title:x,wireframeId:T,status:"generating",dimensions:P})),O=(null==(L=tv.find(function(e){return e.id===rg}))?void 0:L.pageAiContext)||"",em=(0,i._)(function(e){var t,i,u,m,h,v,y,w,S,_,A,b,x,P;return(0,l.Jh)(this,function(M){switch(M.label){case 0:if(i={id:t=e.id||e.wireframeId||e.uiId,type:D.Ty.WIREFRAME,isHiFi:f.isHiFi,order:E,isWireFrame:f.isWireFrame,prompt:eq,isL1:"ds-1"===f.designSystem,designSystem:f.designSystem,saveStatus:D.G3.UNSAVED,status:"generating",useCase:f.useCase,useMaxLimit:f.useMaxLimit||!1,model:f.model,customCollectionName:f.customCollectionName,isLoading:!0,wireframeId:t,screenOrder:E,fineTune:f.fineTune,date:new Date().toISOString(),parentId:r?c:(null==e6?void 0:e6.type)==="edit-screen"?c:void 0},m=(null==(u=rp.getGroup(I))?void 0:u.wireframeIds)||[],h=new Set((0,d._)(m).concat([i.id])),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.removeWireframe(I,T),n!==D.cN||r||handleRemoveScreen(c,n===D.cN),iV(T,i.id),t.addWireframe(I,i,!0),t.updateGroup(I,{wireframeIds:Array.from(h)}),t}),C&&(v=C.getCurrentPageShapes(),y=p?f.prompt:nB.prompt,v.forEach(function(e){"frame"===e.type&&e.props.wireframeId===T&&((0,W.gT)(C,e.id,{wireframeId:t,status:"generating",title:y,position:{x:e.x,y:e.y}}),"hifi"===g&&C.zoomToBounds({x:e.x,y:e.y,w:(0,el.A3)(null==f?void 0:f.useCase,null==f?void 0:f.width)+1e3,h:(0,el.jv)(null==f?void 0:f.useCase,null==f?void 0:f.height)+1e3},{animation:{duration:500}}))})),setTimeout(function(){ro(!0)},1e3),!((null==e6?void 0:e6.shiftedWireframes)&&e6.shiftedWireframes.length>0))return[3,8];w=!0,S=!1,_=void 0,M.label=1;case 1:M.trys.push([1,6,7,8]),A=function(){var e,t,n,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:e=x.value,i.label=1;case 1:if(i.trys.push([1,3,,4]),!(t=rp.getWireframe(e.wireframeId)))return[2,"continue"];return n=(0,a._)((0,o._)((0,a._)({},t.position),{x:e.newX,y:e.newY}),rg&&(0,s._)({},rg,{x:e.newX,y:e.newY})),[4,rQ({wireframeId:e.wireframeId,data:{position:n}}).unwrap()];case 2:return i.sent(),rf(function(t){return t.updateWireframe(e.wireframeId,{position:n}),t}),[3,4];case 3:return r=i.sent(),console.error("❌ Failed to save position for wireframe ".concat(e.wireframeId,":"),r),[3,4];case 4:return[2]}})},b=e6.shiftedWireframes[Symbol.iterator](),M.label=2;case 2:if(w=(x=b.next()).done)return[3,5];return[5,(0,l.XA)(A())];case 3:M.sent(),M.label=4;case 4:return w=!0,[3,2];case 5:return[3,8];case 6:return P=M.sent(),S=!0,_=P,[3,8];case 7:try{w||null==b.return||b.return()}finally{if(S)throw _}return[7];case 8:return[2]}})}),F=function(e){return em.apply(this,arguments)},V="hifi"===f.designMode||"hifi"===g||f.isHiFi?rR:rG,k=getFormValue("contextForDesign","contextForDesign"),U=N=p?f.prompt:nB.prompt,k&&(null==(H=null==rp?void 0:rp.getWireframe(k))?void 0:H.wireframeOutputHtml)&&("hifi"===g?U="Context of Screen: ".concat(H.prompt," /n ###").concat(U," /n Wireframe Code: ").concat(H.wireframeOutputHtml):U+="\nCode of Context design chosen by User:\n"+H.wireframeOutputHtml),O&&(U="".concat(U,"\n### Project Context (Apply these guidelines to this design):\n").concat(O)),tW&&"edit-screen"===e6.type&&"section-add"===e6.initAction&&e6.sectionPosition&&(U=getAddSectionPrompt(U,e6.sectionPosition,null==tW?void 0:tW.id)),j="new-screen"===e6.type?{x:null!==(B=null===(y=e6.targetPosition)||void 0===y?void 0:y.x)&&void 0!==B?B:0,y:null!==(J=null===(w=e6.targetPosition)||void 0===w?void 0:w.y)&&void 0!==J?J:0}:null!==(z=null==f?void 0:null===(S=f.position)||void 0===S?void 0:S[rg])&&void 0!==z?z:null==f?void 0:f.position,Y=getFormValue("designSystem","designSystem")||f.designSystem,Z=getFormValue("selectedModel","selectedModel")||f.model||"",K=getFormValue("modelVariant","modelVariant")||"",Q=null!==(X=getFormValue("useMaxLimit","useMaxLimit"))&&void 0!==X&&X,$=null!==(q=getFormValue("deepDesign","deepDesign"))&&void 0!==q&&q,ee=getFormValue("customCollectionName","customCollectionName")||f.customCollectionName||"",et=p?f.font||f.selectedFont||"":(k?null==nB?void 0:nB.selectedFont:f.font||f.selectedFont)||"",er=null!==(en=getFormValue("isFigmaImport","isFigmaImport"))&&void 0!==en&&en,es=null!==(ei=null==f?void 0:f.figmaFrameScreenshot)&&void 0!==ei?ei:null,ea={wireframeId:c,topic:n||U,userInputPrompt:[N],attachments:v,selectedType:f.useCase,designSystem:p?"ds-2":Y,selectedModel:Z,modelVariant:K,useMaxLimit:Q,deepDesign:$,selectedSection:"section-add"===e6.initAction?void 0:tW,isL1:f.isL1,fineTune:!0,order:E,isS:ta,screenOrder:E,pageId:rg,position:j,customCollectionName:ee,isFigmaImport:er,figmaFrameScreenshot:es,isNewScreen:(null==e6?void 0:e6.type)==="new-screen",editMode:!!p||(null==e6?void 0:e6.type)==="edit-screen",selectedFont:et,forCompletion:!!p},ef.label=4;case 4:return ef.trys.push([4,7,,8]),[4,V(ea).unwrap()];case 5:return eo=ef.sent(),[4,F(eo.design)];case 6:return ef.sent(),[3,8];case 7:return eu=ef.sent(),n_(function(e){return e.includes(c)?e:(0,d._)(e).concat([c])}),ny(function(e){return e.filter(function(e){var t;return(null===(t=e.props)||void 0===t?void 0:t.wireframeId)!==c})}),rf(function(e){var t;e.updateWireframe(T,{error:null!==(t=null==eu?void 0:eu.message)&&void 0!==t?t:"Error in regenerating wireframe",retryId:new Date().getTime(),isLoading:!1})}),eF({message:null!==(ed=null==eu?void 0:eu.message)&&void 0!==ed?ed:"Error in regenerating wireframe",type:"error"}),[3,8];case 8:return eU.capture(D.Je.REGENERATION_COMPLETED,{distinct_id:ej,wireframe_id:c,generation_time:Date.now()-m,design_type:null==f?void 0:f.designSystem,is_hifi:null==f?void 0:f.isHiFi}),tF(null),tP(null),null==C||C.setEditingShape(null),p||nJ(function(e){return(0,o._)((0,a._)({},e),{uploadedImage:null})}),eF({message:"Design generation started successfully",type:"info"}),[3,11];case 9:return ec=ef.sent(),eU.capture(D.Je.REGENERATION_FAILED,{distinct_id:ej,wireframe_id:c,error_message:ec.message,design_type:null==f?void 0:f.designSystem,is_hifi:null==f?void 0:f.isHiFi}),console.error("Error in regenerating wireframe:",ec),eF({message:null!==(ep=null==ec?void 0:ec.message)&&void 0!==ep?ep:"Error in regenerating wireframe",type:"error"}),n_(function(e){return e.includes(c)?e:(0,d._)(e).concat([c])}),[3,11];case 10:return rI(!1),[7];case 11:return[2]}})}),function(e,t,n,r){return eh.apply(this,arguments)}),iR=(ev=(0,i._)(function(e,t){var n,r,u,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T,b,x,P,M,L,O,F,V;return(0,l.Jh)(this,function(k){switch(k.label){case 0:if(console.log("sourceWireframe",n=rp.getWireframe(e)),!n)return console.error("Source wireframe not found"),[2];if((r=(0,el.ds)(n.useCase)?"desktop":"mobile")===t)return eF({message:"Screen is already a ".concat(t," design"),type:"warning"}),[2];if(u=n.isHiFi?"ds-0"===n.designSystem?R.Sw.UI_00:"ds-1"===n.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20,to.totalAvailableCredits<u)return eZ("save-ui"),[2];eU.capture(D.Je.CREDITS_USED,{amount:u,reason:"device_version_generation",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email}),eU.capture(D.Je.GENERATE_DEVICE_VERSION_STARTED,{wireframe_id:e,source_device:r,target_device:t,user_id:ej}),rI(!0),c=null,p=null,k.label=1;case 1:var N;if(k.trys.push([1,7,8,9]),!(p=rp.findParentGroup(e)))return eF({message:"Parent group not found",type:"error"}),rI(!1),[2];if(m=(n.order||n.screenOrder||0)+1,g=(0,W.W_)(),c="temp_".concat(Date.now()),rf(function(e){e.addWireframe(p,{id:c,order:m,screenOrder:m,type:D.Ty.WIREFRAME,isLoading:!0,status:"generating",useCase:"mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP,saveStatus:D.G3.UNSAVED,requestTime:new Date().getTime()},!0)}),addNewScreenOnPage(c,m),ro(!0),g){if(!(h=g.getCurrentPageShapes().find(function(t){var n,r;return(null===(n=t.meta)||void 0===n?void 0:n.wireframeId)===e||(null===(r=t.props)||void 0===r?void 0:r.wireframeId)===e})))return rI(!1),[2];y=(v=(0,el.Mi)("mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP)).width,w=h.props.w,_={x:S=h.x+w+250,y:h.y},I=g.getCurrentPageShapes().filter(function(e){return"frame"===e.type&&e.id!==h.id}).filter(function(e){return 50>=Math.abs(e.y-h.y)&&e.x>h.x}),E=[],I.length>0&&(A=I.sort(function(e,t){return e.x-t.x}),C=S+y+250,A.forEach(function(e,t){var n,r,i;0===t?r=S+y+250:(null===(i=e.props)||void 0===i||i.w,r=C+250),C=r+((null===(n=e.props)||void 0===n?void 0:n.w)||1440),E.push({id:e.id,type:e.type,x:r,y:e.y})})),E.length>0&&g.updateShapes(E),(0,W.wf)(g,{title:"".concat(n.screenTitle||n.prompt," — ").concat("mobile"===t?"Mobile":"Desktop"),wireframeId:c,status:"generating",dimensions:v,groupId:p,position:_})}if(b=(null==(T=tv.find(function(e){return e.id===rg}))?void 0:T.pageAiContext)||"",P=x="mobile"===t?"Convert this desktop screen into a mobile version. Keep the same user goal, information architecture, and content (labels, fields, actions), but redesign the layout for a phone viewport. Use a single-column layout, prioritize the primary CTA, and ensure touch-friendly spacing. Replace multi-column sections with vertical stacking, collapse sidebars into top/bottom navigation, and use progressive disclosure (accordions/tabs) when needed to reduce clutter. Preserve visual style tokens (typography, colors) where applicable. Output only the updated mobile screen.":"Convert this mobile screen into a desktop version. Keep the same user goal, information architecture, and content (labels, fields, actions), but redesign the layout for a desktop viewport. Use wider layouts where helpful (2–3 columns), introduce a sidebar or top navigation if appropriate, and place supporting information alongside primary content. Keep the primary CTA prominent and maintain consistent styling (typography, colors). Avoid unnecessary scrolling by using available horizontal space. Output only the updated desktop screen.",n.wireframeOutputHtml&&(P="".concat(x,"\n\n### Source Screen Code:\n").concat(n.wireframeOutputHtml)),b&&(P="".concat(P,"\n### Project Context (Apply these guidelines to this design):\n").concat(b)),M={wireframeId:e,topic:P,userInputPrompt:[x],selectedType:"mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP,useCase:"mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP,designSystem:n.designSystem,selectedModel:n.model||tQ.selectedModel,modelVariant:n.modelVariant||tQ.modelVariant||"",useMaxLimit:n.useMaxLimit||!1,deepDesign:n.deepDesign||!1,selectedSection:{},isL1:n.isL1,fineTune:!0,order:m,isS:ta,screenOrder:m,pageId:rg,position:(null===(f=n.position)||void 0===f?void 0:f[rg])||n.position||{x:0,y:0},customCollectionName:n.customCollectionName||null,isNewScreen:!0,editMode:!1,selectedFont:n.font||n.selectedFont||"",forCompletion:!1},N=(0,i._)(function(i){var u,f,h,v,y,w,S,_;return(0,l.Jh)(this,function(l){return v={id:h=i.id||i.wireframeId||i.uiId,type:D.Ty.WIREFRAME,uid:ej,isHiFi:n.isHiFi,order:m,isWireFrame:n.isWireFrame,prompt:x,screenTitle:"".concat(n.screenTitle||n.prompt," — ").concat("mobile"===t?"Mobile":"Desktop"),isL1:n.isL1,designSystem:n.designSystem,saveStatus:D.G3.UNSAVED,status:"generating",useCase:"mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP,model:n.model||tQ.selectedModel,modelVariant:n.modelVariant||tQ.modelVariant||"",customCollectionName:n.customCollectionName||null,isLoading:!0,wireframeId:h,screenOrder:m,fineTune:!0,date:new Date().toISOString(),dimensions:(0,el.Mi)("mobile"===t?ee.ke.MOBILE:ee.ke.DESKTOP),position:(0,o._)((0,a._)({},(null===(u=n.position)||void 0===u?void 0:u[rg])||n.position||{x:0,y:0}),(0,s._)({},rg,(null===(f=n.position)||void 0===f?void 0:f[rg])||n.position||{x:0,y:0})),font:n.font||n.selectedFont||""},w=(null==(y=rp.getGroup(p))?void 0:y.wireframeIds)||[],S=new Set((0,d._)(w).concat([v.id])),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.removeWireframe(p,c),iV(c,v.id),t.addWireframe(p,v,!0),t.updateGroup(p,{wireframeIds:Array.from(S)}),t}),g&&(_=g.getCurrentPageShapes().find(function(e){var t,n;return(null===(t=e.meta)||void 0===t?void 0:t.wireframeId)===c||(null===(n=e.props)||void 0===n?void 0:n.wireframeId)===c}))&&(0,W.gT)(g,_.id,{title:v.screenTitle,wireframeId:h,status:"generating",dimensions:v.dimensions}),setTimeout(function(){ro(!0)},1e3),eU.capture(D.Je.GENERATE_DEVICE_VERSION_STARTED,{wireframe_id:e,new_wireframe_id:h,source_device:r,target_device:t,user_id:ej}),eF({message:"".concat("mobile"===t?"Mobile":"Desktop"," version generation started"),type:"info"}),[2]})}),L=function(e){return N.apply(this,arguments)},!n.isHiFi)return[3,3];return[4,rR(M).unwrap()];case 2:return O=k.sent(),[3,5];case 3:return[4,rG(M).unwrap()];case 4:O=k.sent(),k.label=5;case 5:return[4,L(O.design)];case 6:return k.sent(),[3,9];case 7:return F=k.sent(),eU.capture(D.Je.GENERATE_DEVICE_VERSION_FAILED,{wireframe_id:e,source_device:r,target_device:t,error_message:null==F?void 0:F.message,user_id:ej}),c&&p?rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.getWireframe(c)&&(t.removeWireframe(p,c),nX(function(e){var t=new Map(e),n=(iF()||[]).map(function(e){return e.mainScreen===c?null:(e.versionScreens=e.versionScreens.filter(function(e){return e.id!==c}),e)}).filter(Boolean);return t.set(rg,n),t})),t}):rf(function(t){var n;t.updateWireframe(e,{error:null!==(n=null==F?void 0:F.message)&&void 0!==n?n:"Error generating device version",retryId:new Date().getTime(),isLoading:!1})}),eF({message:null!==(V=null==F?void 0:F.message)&&void 0!==V?V:"Error generating device version",type:"error"}),[3,9];case 8:return rI(!1),[7];case 9:return[2]}})}),function(e,t){return ev.apply(this,arguments)}),iF=(0,f.useCallback)(function(){return nK.get(rg)},[nK,rg]),iV=(0,f.useCallback)(function(e,t){nX(function(n){var r=new Map(n),i=iF();return i||(i=[]),i.forEach(function(n){n.currentVisible===e&&(n.currentVisible=t),n.mainScreen===e?n.mainScreen=t:(n.versionScreens.forEach(function(n){n.id===e&&(n.id=t)}),n.currentVisible===e&&(n.currentVisible=t))}),r.set(rg,i),r})},[rg,iF]),addNewGroupOnCurrentPage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(t){Array.isArray(e)||(e=[e]);var r=[];e.forEach(function(e,t){r.push({mainScreen:e,versionScreens:[],expanded:!1,currentVisible:e,order:t+1,date:new Date().toISOString()})}),nX(function(e){var t=new Map(e),i=e.get(n)||[];return r.forEach(function(e){i.push(e)}),t.set(n,i),t})}else nX(function(t){var r=new Map(t),i=t.get(n);return i&&i.length>0?(i.push({mainScreen:e,versionScreens:[],expanded:!1,currentVisible:e,order:0,date:new Date().toISOString()}),r.set(n,i)):r.set(n,[{mainScreen:e,versionScreens:[],expanded:!1,currentVisible:e,order:0,date:new Date().toISOString()}]),r})},ik=(0,f.useCallback)((ey=(0,i._)(function(e,t){var n,r,u,c,p,f,m,g,h,v,y;return(0,l.Jh)(this,function(w){switch(w.label){case 0:n=[],r="temp_".concat(Date.now()),n.push(r),w.label=1;case 1:return w.trys.push([1,5,,6]),[4,io(rg)];case 2:var S;return u=w.sent(),p=getTargetPosition(c=(0,W.W_)()),f=(0,el.A3)(t),m=(0,el.jv)(t),g={id:r,order:0,wireframeId:r,type:D.Ty.WIREFRAME,isLoading:!0,requestTime:Date.now(),saveStatus:D.G3.UNSAVED,status:"generating",prompt:e[0].query,screenTitle:e[0].screenTitle,useCase:t,designMode:"wireframe",date:new Date().toISOString(),isHiFi:!1,isWireFrame:!1,isPrototype:!0,uid:null==eY?void 0:eY.uid,dimensions:{width:f,height:m},position:(0,s._)({x:p.x,y:p.y},rg,{x:p.x,y:p.y})},rf(function(e){e.addWireframe(u,g,!0)}),c&&((0,W.wf)(c,{wireframeId:g.id,groupId:u,status:g.status,dimensions:g.dimensions,position:{x:p.x,y:p.y},title:g.screenTitle||g.prompt,isPrototype:!0}),c.zoomToBounds({x:p.x,y:p.y,w:f+1e3,h:m+1e3},{animation:{duration:500}})),addNewGroupOnCurrentPage(n,!0,rg),S=(0,i._)(function(e){var t,n,i,c,h;return(0,l.Jh)(this,function(l){return t=(0,a._)((0,o._)((0,a._)({},g),{wireframeId:e.design.id,dimensions:{width:f,height:m},position:(0,s._)({x:p.x,y:p.y},rg,{x:p.x,y:p.y})}),e.design),i=(null==(n=rp.getGroup(u))?void 0:n.wireframeIds)||[],c=new Set((0,d._)(i).concat([t.id])),(h=(0,W.W_)())&&h.getCurrentPageShapes().forEach(function(e){"frame"===e.type&&e.props.wireframeId===r&&(0,W.gT)(h,e.id,{wireframeId:t.id,groupId:u,status:t.status,dimensions:t.dimensions,position:{x:e.x,y:e.y},title:t.screenTitle||t.prompt,isPrototype:!0})}),rf(function(e){e.removeWireframe(u,r),e.updateGroup(u,{wireframeIds:Array.from(c)}),e.addWireframe(u,t,!0)}),iV(r,t.id),setTimeout(function(){ro(!0)},1e3),[2]})}),h=function(e){return S.apply(this,arguments)},[4,rH({entryFile:e[0].id,pageId:rg,prototypeScreens:e,useCase:t,position:{x:p.x,y:p.y},dimensions:{width:f,height:m}}).unwrap()];case 3:return v=w.sent(),[4,h(v)];case 4:return w.sent(),[3,6];case 5:return console.error("Error generating prototype:",y=w.sent()),eF({message:y.message||"An error occurred while generating prototype",type:"error"}),rf(function(e){var t;e.updateWireframe(r,{error:null!==(t=null==y?void 0:y.message)&&void 0!==t?t:"Error in generating prototype",retryId:Date.now(),isLoading:!1,status:"failed"})}),[3,6];case 6:return[2]}})}),function(e,t){return ey.apply(this,arguments)}),[io,rg,rp,rH,iV,eF,rf,null==eY?void 0:eY.uid]),addWireframeInVersionGroup=function(e,t,n){nX(function(r){var i=new Map(r),s=iF(),a=!1;if(s&&s.length>0){a=!1,s.some(function(r){if(r.mainScreen===e?(r.versionScreens.unshift({id:t,parentId:e,order:n,date:new Date().toDateString()}),r.currentVisible=t,a=!0):r.versionScreens.some(function(i){if(i.id===e)return r.versionScreens.unshift({id:t,parentId:e,order:n,date:new Date().toDateString()}),r.currentVisible=t,a=!0,!0}),a)return!0});var o=(0,h._O)(s);i.set(rg,o)}return i})},addNewScreenOnPage=function(e,t){nX(function(n){var r=new Map(n),i=iF()||[];i.push({mainScreen:e,versionScreens:[],expanded:!1,currentVisible:e,order:t,date:new Date().toISOString()});var s=i.sort(function(e,t){return e.order-t.order});return r.set(rg,s),r})},handleRetryResponse=function(e){if(null==e?void 0:e.success){eF({message:"Wireframe regeneration has been started successfully",type:"success"}),console.log("Calling updateWireframe..."),rf(function(t){return t.updateWireframe(e.wireframeId,{status:"generating",isLoading:!0,error:null}),t});var t=(0,W.W_)();t&&t.getCurrentPageShapes().forEach(function(n){n.props.wireframeId===e.wireframeId&&t.updateShape((0,o._)((0,a._)({},n),{props:(0,o._)((0,a._)({},n.props),{status:"generating"})}))}),setTimeout(function(){ro(!0)},3e3)}},iN=(ew=(0,i._)(function(e){var t,n,r;return(0,l.Jh)(this,function(i){switch(i.label){case 0:if(!(t=iX(e)))return console.log("Wireframe not found"),[2];n=t.designMode,r=void 0,r=n&&n.length>0?n:t.isHiFi?"hifi":t.isPrototype?"prototype":"wireframe",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,("hifi"===r?rF:"prototype"===r?rk:rV)({wireframeId:e}).unwrap()];case 2:return handleRetryResponse(i.sent()),[3,4];case 3:return console.error("Error in retrying wireframe generation:",i.sent()),eF({message:"Error in retrying wireframe generation",type:"error"}),[3,4];case 4:return[2]}})}),function(e){return ew.apply(this,arguments)}),handleRemoveScreen=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(checkIfVersionExists(e)){handleRemoveVersionScreen(e,void 0,{silent:t});return}if(ry){eF({message:"Please wait for the generation process to complete",type:"error"});return}if(te){ti(!0);return}e7(null),tF(null);var n=iX(e),r=rp.findParentGroup(e),i=(0,W.W_)(),s={x:0,y:0,w:1440,h:840};if(i&&n){var o,u,d=i.getCurrentPageShapes().find(function(t){return"frame"===t.type&&t.props.wireframeId===e});d&&(s={x:d.x,y:d.y,w:d.props.w||(null===(o=n.dimensions)||void 0===o?void 0:o.width)||1440,h:d.props.h||(null===(u=n.dimensions)||void 0===u?void 0:u.height)||840})}var l=(iF()||[]).find(function(t){return t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e})}),c={wireframe:n,shapeData:s,groupId:r,versionGroup:l?(0,a._)({},l):void 0};updatePageVersion({wireframeId:e,currentPageId:rg}),rf(function(t){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,t),n.removeWireframeAndCleanup(e),n}),t||eV({message:"Screen removed successfully",type:"success",actionText:"Undo",onAction:function(){return id(c)}})},removeWireframesFromVersionGroup=function(e){var t=(iF()||[]).filter(function(t){return!t.versionScreens.some(function(n){return e.includes(n.id)||e.includes(t.mainScreen)})});nX(function(e){var n=new Map(e);return n.set(rg,t),n})},handleRemoveVersionScreen=function(e,t,n){var r,i=null!==(f=null==n?void 0:n.silent)&&void 0!==f&&f;if(ry){eF({message:"Please wait for the generation process to complete",type:"error"});return}if(te){ti(!0);return}e7(null),tF(null);var s=(0,W.W_)(),u=rp.findParentGroup(e),l=(iF()||[]).find(function(t){return t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e})});if(l){var c=iX(e),p={x:0,y:0,w:1440,h:840};if(s&&c){var f,m,g,h=t||s.getCurrentPageShapes().find(function(t){return"frame"===t.type&&t.props.wireframeId===e});h&&(p={x:h.x,y:h.y,w:h.props.w||(null===(m=c.dimensions)||void 0===m?void 0:m.width)||1440,h:h.props.h||(null===(g=c.dimensions)||void 0===g?void 0:g.height)||840})}var v={wireframe:c,shapeData:p,groupId:u,versionGroup:(0,a._)({},l),parentId:null==c?void 0:c.parentId},y=[l.mainScreen].concat((0,d._)(l.versionScreens.map(function(e){return e.id})));if(1===y.length&&s){var w=t||s.getCurrentPageShapes().find(function(t){return"frame"===t.type&&t.props.wireframeId===e});w&&s.deleteShape(w.id),u&&updateVersionGroups({wireframeId:e,groupId:u,type:"wireframe",currentPageId:rg}),rf(function(t){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,t),n.removeWireframeAndCleanup(e),n}),nW(null),i||eV({message:"Screen removed successfully",type:"success",actionText:"Undo",onAction:function(){return id(v)}});return}var S=l.versionScreens.map(function(e){return e.id}),_=l.mainScreen===e,I=S.includes(e);if(_&&S.length>0){if(t){var E=(0,d._)(l.versionScreens).sort(function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})[0];r=(null==E?void 0:E.id)||S[S.length-1]}else r=S[S.length-1]}else if(I){var A=S.indexOf(e),C=S.filter(function(t){return t!==e});if(t&&C.length>0){var T=(0,d._)(l.versionScreens).filter(function(t){return t.id!==e}).sort(function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})[0];r=(null==T?void 0:T.id)||C[C.length-1]}else{var D=A>0?S[A-1]:void 0,b=A<S.length-1?S[A+1]:void 0;r=D||b||l.mainScreen}}else r=l.mainScreen;var x=iX(r);if(s&&x){var P=s.getCurrentPageShapes(),M=t||P.find(function(e){return"frame"===e.type&&e.props.wireframeId===l.currentVisible})||P.find(function(e){return"frame"===e.type&&e.props.wireframeId===l.mainScreen})||P.find(function(e){return"frame"===e.type&&l.versionScreens.some(function(t){return t.id===e.props.wireframeId})});!M||(s.updateShape((0,o._)((0,a._)({},M),{props:(0,o._)((0,a._)({},M.props),{wireframeId:r,name:x.screenTitle||x.prompt,w:(0,el.A3)(null==x?void 0:x.useCase,null==x?void 0:x.width),h:(0,el.jv)(null==x?void 0:x.useCase,null==x?void 0:x.height)})})),u&&updateVersionGroups({wireframeId:e,groupId:u,type:"wireframe",currentPageId:rg}),rf(function(t){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,t),n.removeWireframeAndCleanup(e),n}),2===y.length?nW(null):nW(function(t){return t===e?r:t}),t||i||eV({message:"Screen removed successfully",type:"success",actionText:"Undo",onAction:function(){return id(v)}}))}}};function updateVersionGroups(e){var t=e.wireframeId,n=(e.groupId,e.type,e.currentPageId),r=!1,i=iF()||[];if(i.forEach(function(e){e.versionScreens.find(function(e){return e.id===t})&&(r=!0,e.versionScreens=e.versionScreens.filter(function(e){return e.id!==t}),0===e.versionScreens.length&&(e.expanded=!1),e.currentVisible===t&&(e.currentVisible=e.versionScreens.length>0?e.versionScreens[e.versionScreens.length-1].id:e.mainScreen),rf(function(n){var r=new G(null==eY?void 0:eY.uid);return Object.assign(r,n),e.versionScreens.forEach(function(n){n.parentId===t&&(n.parentId=e.mainScreen,r.updateWireframe(n.id,(0,o._)((0,a._)({},iX(n.id)),{parentId:e.mainScreen})),r.markAsUnsynced("wireframe",n.id))}),r}))}),r)nX(function(e){var t=new Map(e);return t.set(n,i),t});else{var s=i.find(function(e){return e.mainScreen===t});if(s){var u=s.versionScreens;if(u.length>0){var d=u[u.length-1],l=u.slice(0,-1)||[];rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.updateWireframe(d.id,(0,o._)((0,a._)({},iX(d.id)),{parentId:null})),t.markAsUnsynced("wireframe",d.id),l.forEach(function(e){t.updateWireframe(e.id,(0,o._)((0,a._)({},iX(e.id)),{parentId:d.id})),t.markAsUnsynced("wireframe",e.id)}),t}),nX(function(e){var r=new Map(e),s=i.map(function(e){return e.mainScreen===t?(0,o._)((0,a._)({},e),{mainScreen:d.id,versionScreens:l,currentVisible:e.currentVisible===t?d.id:e.currentVisible,expanded:l.length>0&&e.expanded}):e});return r.set(n,s),r})}else nX(function(e){var r=new Map(e),s=i.filter(function(e){return e.mainScreen!==t});return r.set(n,s),r})}}}var updatePageVersion=function(e){var t=e.wireframeId,n=e.currentPageId,r=(0,W.W_)(),i=iF()||[],s=null==r?void 0:r.getOnlySelectedShape(),u=i.find(function(e){return e.currentVisible===t});if(u){var d=u.versionScreens;if(d.length>0){var l,c,p="",f=[];u.mainScreen===t?(p=d.at(-1).id,f=d.slice(0,-1)||[]):(p=u.mainScreen,f=d.filter(function(e){return e.id!==t}));var m=iX(p);r&&s&&r.updateShape((0,o._)((0,a._)({},s),{props:(0,o._)((0,a._)({},s.props),{h:null==m?void 0:null===(l=m.dimensions)||void 0===l?void 0:l.height,w:null==m?void 0:null===(c=m.dimensions)||void 0===c?void 0:c.width,name:null==m?void 0:m.prompt,wireframeId:p})})),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.updateWireframe(p,(0,o._)((0,a._)({},iX(p)),{parentId:null})),t.markAsUnsynced("wireframe",p),f.forEach(function(e){t.updateWireframe(e.id,(0,o._)((0,a._)({},iX(e.id)),{parentId:p})),t.markAsUnsynced("wireframe",e.id)}),t}),nX(function(e){var r=new Map(e),s=i.map(function(e){return e.currentVisible===t?(0,o._)((0,a._)({},e),{mainScreen:u.mainScreen===t?p:e.mainScreen,versionScreens:f,currentVisible:p,expanded:f.length>0&&e.expanded}):e});return r.set(n,s),r})}else{if(r){var g=r.getCurrentPageShapes().find(function(e){return"frame"===e.type&&e.props.wireframeId===t});g&&r.deleteShape(g.id)}nX(function(e){var r=new Map(e),s=i.filter(function(e){return e.currentVisible!==t});return r.set(n,s),r})}}},iU=(0,u._)((0,f.useState)(!1),2),iH=iU[0],iB=iU[1],iJ=(0,f.useRef)(null);(0,I.ZP)(I.zW.toggleSavedDesignsPanel,function(e){var t=e.action;"toggle"===t?iB(function(e){return!e}):"open"===t?iB(!0):"close"===t&&iB(!1)}),(0,f.useEffect)(function(){if(iH){var e=iJ.current;if(null!=e){var t=document.getElementsByClassName("tlui-navigation-panel");if(t.length>0){var n=!0,r=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)s.value.style.setProperty("left","".concat(Math.round(e+10),"px"),"important")}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}var o=document.getElementsByClassName("canvas-color-picker").item(0);o&&o.style.setProperty("left","".concat(Math.round(e+118),"px"),"important");var u=document.getElementsByClassName("tlui-helper-buttons").item(0);u&&u.style.setProperty("left","".concat(Math.round(e+6),"px"),"important")}}},[iH]),(0,I.ZP)(I.zW.leftPanelWidthChanged,function(e){var t=e.width;if("number"==typeof t&&(iJ.current=t),iH){var n=iJ.current;if(null==n)return;var r=document.getElementsByClassName("tlui-navigation-panel");if(r.length>0){var i=!0,s=!1,a=void 0;try{for(var o,u=r[Symbol.iterator]();!(i=(o=u.next()).done);i=!0)o.value.style.setProperty("left","".concat(Math.round(n+10),"px"),"important")}catch(e){s=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw a}}}var d=document.getElementsByClassName("canvas-color-picker").item(0);d&&d.style.setProperty("left","".concat(Math.round(n+118),"px"),"important");var l=document.getElementsByClassName("tlui-helper-buttons").item(0);l&&l.style.setProperty("left","".concat(Math.round(n+6),"px"),"important");return}if(tL&&"number"==typeof t){var c=document.getElementsByClassName("tlui-navigation-panel");if(c.length>0){var p=!0,f=!1,m=void 0;try{for(var g,h=c[Symbol.iterator]();!(p=(g=h.next()).done);p=!0)g.value.style.setProperty("left","".concat(Math.round(t+10),"px"),"important")}catch(e){f=!0,m=e}finally{try{p||null==h.return||h.return()}finally{if(f)throw m}}}var v=document.getElementsByClassName("canvas-color-picker").item(0);v&&v.style.setProperty("left","".concat(Math.round(t+118),"px"),"important");var y=document.getElementsByClassName("tlui-helper-buttons").item(0);y&&y.style.setProperty("left","".concat(Math.round(t+6),"px"),"important")}});var iz=(0,f.useCallback)(function(e,t,n){if(tR&&(ry||r_)){eF({message:"Please wait for the current generation to complete before opening a new modal",type:"warning"});return}if("new-screen"!==t)e4(function(e){return{type:t,direction:null==e?void 0:e.direction,targetPosition:null==e?void 0:e.targetPosition,initAction:null==e?void 0:e.initAction,sectionPosition:null==e?void 0:e.sectionPosition}});else if((null==e6?void 0:e6.direction)==="left"||(null==e6?void 0:e6.direction)==="right"){var r,i;(0,W.W_)()&&(null==e6?void 0:null===(r=e6.targetPosition)||void 0===r?void 0:r.x)&&(null==e6||null===(i=e6.targetPosition)||void 0===i||i.y)}if(e$(""),te){ti(!0);return}e7(null),np(null),ng(null),nJ(function(e){return(0,o._)((0,a._)({},e),{prompt:"",contextForDesign:null,selectedFont:"",uploadedImage:null,itemsAttachedWithContext:[],useVariation:n||!1})}),null!==e&&tF(null!=e?e:null)},[tR,e6,ry,r_,te]),ij=(eS=(0,i._)(function(e){return(0,l.Jh)(this,function(t){return rf(function(t){t.updateWireframe(e5,{wireframeOutputHtml:e})}),[2]})}),function(e){return eS.apply(this,arguments)}),iY=(e_=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,iD(e)];case 1:return t.sent(),rf(function(t){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,t),rg&&n.removeGroup(rg,e),n}),eF({message:"Group removed successfully",type:"success"}),[2]}})}),function(e){return e_.apply(this,arguments)});(0,f.useEffect)(function(){var handleEscKey=function(e){"Escape"===e.key&&nY(!1)};return document.addEventListener("keydown",handleEscKey),function(){document.removeEventListener("keydown",handleEscKey)}},[]);var getVersionsByWireframeId=function(e){var t=iF()||[],n=[];return t.forEach(function(t){(t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e}))&&(n.push(t.mainScreen),n.push.apply(n,(0,d._)(t.versionScreens.map(function(e){return e.id}))))}),n},iZ=(0,f.useCallback)(function(e){return nK.get(e)},[nK]),iK=(0,f.useCallback)(function(e){var t=[];function vGroupExists(e){var n=!1;return t.forEach(function(t){t.mainScreen===e&&(n=!0),t.versionScreens.some(function(t){return t.id===e})&&(n=!0)}),n}var n=iF();if(!n)return[];var r=e.wireframes.map(function(e){return e.id});return r?(n.forEach(function(e){(null==r?void 0:r.includes(e.mainScreen))&&!vGroupExists(e.mainScreen)?t.push(e):e.versionScreens.forEach(function(n){(null==r?void 0:r.includes(n))&&!vGroupExists(n)&&t.push(e)})}),t):[]},[iF,nK,tm]),checkIfVersionExists=function(e){var t=iF()||[],n=!1;return t.forEach(function(t){t.mainScreen===e&&t.versionScreens.length>0&&(n=!0),t.versionScreens.some(function(t){return t.id===e})&&(n=!0)}),n},iX=(0,f.useCallback)(function(e){return rp.getWireframe(e)},[rp]),iQ=(0,f.useMemo)(function(){return rg?rp.getPageGroups(rg).flatMap(function(e){return rp.getGroupWireframes(e.id)}).filter(function(e){return("generating"===e.status||e.isLoading)&&!e.id.includes("temp")}).map(function(e){return e.id}):[]},[rg,rp]),getWireframeShapePositionByWireframeId=function(e){var t=(0,W.W_)();if(!t)return{x:0,y:0};var n=t.getCurrentPageShapes().find(function(t){return"frame"===t.type&&t.props.wireframeId===e});return n?{x:n.x,y:n.y}:{x:0,y:0}};(0,I.ZP)(I.zW.itemAttachedWithContext,function(e){var t=e.tempId,n=e.update,r=e.isRegenerate,i=((r?null==nB?void 0:nB.itemsAttachedWithContext:null==tQ?void 0:tQ.itemsAttachedWithContext)||[]).map(function(e){return e.id===t?n:e});r?nJ(function(e){return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:i})}):tq(function(e){return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:i})})});var iq=(0,A.NF)({wireframeIds:iQ},{pollingInterval:ra?3e3:0,skip:!ra||0===iQ.length}).data;(0,f.useEffect)(function(){if(iq&&0!==iq.length){var e=new Map;if(iq.forEach(function(t){var n=(0,o._)((0,a._)({},t),{isLoading:!1});"completed"===t.status?e.set(t.id,(0,o._)((0,a._)({},n),{status:"completed"})):"failed"===t.status&&e.set(t.id,(0,o._)((0,a._)({},n),{status:"failed",error:t.error||"Generation failed",retryId:Date.now()}))}),e.size>0){var t=(0,W.W_)();rf(function(e){return iq.forEach(function(t){if("completed"===t.status){var n=t.id||t.wireframeId,r=t.isPrototype,i=getWireframeShapePositionByWireframeId(n);e.syncUpdateWireframe(n,(0,o._)((0,a._)({},t),{position:(0,o._)((0,a._)({},i),(0,s._)({},rg,i)),isLoading:!1,isPrototype:r}))}if("failed"===t.status){var u=t.id||t.wireframeId,d=getWireframeShapePositionByWireframeId(u),l=(0,el.Mi)(null==t?void 0:t.useCase,null==t?void 0:t.width,null==t?void 0:t.height),c=t.isPrototype;e.syncUpdateWireframe(u,(0,o._)((0,a._)({},t),{position:(0,o._)((0,a._)({},d),(0,s._)({},rg,d)),dimensions:l,isLoading:!1,isPrototype:c}))}}),e}),iq.forEach(function(e){if("completed"===e.status||"failed"===e.status){var n=e.id||e.wireframeId;t&&t.getCurrentPageShapes().forEach(function(r){if("frame"===r.type&&r.props.wireframeId===n){var i="completed"===e.status?{width:e.dimensions.width,height:e.dimensions.height}:(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height);(0,W.gT)(t,r.id,{wireframeId:n,title:e.screenTitle||e.prompt,dimensions:i,position:{x:r.x,y:r.y},status:e.status,isPrototype:e.isPrototype})}})}})}var n=iq.some(function(e){return"generating"===e.status});ro(n),n||(setTimeout(function(){rf(function(e){return e.cleanupPendingAfterSync(),e})},500),setTimeout(function(){eN(A.aG.util.invalidateTags([{type:eu.q.PROMPTS,id:ej}]))},2e3),rw(!1))}},[rg,eN,ej,rf,iq]);var i$=(eI=(0,i._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:if(!(t=(0,W.W_)())||!e||!(n=t.getShape(e))||!rg||!(null==eY?void 0:eY.uid))return[2];return[4,i0({id:e,pageId:rg,uid:null==eY?void 0:eY.uid,type:n.type,props:n.props,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})];case 1:return(r=s.sent())&&(e=r.id,i=(0,o._)((0,a._)({},r,n),{props:(0,o._)((0,a._)({},(null==r?void 0:r.props)||{},n.props),{shapeId:r.id})}),t.updateShape((0,o._)((0,a._)({},n),{props:(0,a._)({},i.props)})),rf(function(e){return e.addShape(rg,(0,o._)((0,a._)({},i),{id:r.id,type:"sticky-note"})),e})),eU.capture(D.Je.STICKY_NOTE_CREATED,{distinct_id:ej,page_id:rg,shape_id:null==r?void 0:r.id,shape_type:n.type}),[2]}})}),function(e){return eI.apply(this,arguments)});(0,I.ZP)(ed.cj.CREATE_CANVAS_SHAPE,i$);var i0=(eE=(0,i._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r4(e).unwrap()];case 1:if("success"===(t=n.sent()).status)return[2,t.shape];return[2,null];case 2:return console.error("Error creating canvas shape:",n.sent()),[2,null];case 3:return[2]}})}),function(e){return eE.apply(this,arguments)}),i1=(0,f.useCallback)((eA=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r9({shapeId:e.id,data:e}).unwrap()];case 1:return t.sent(),[3,3];case 2:return console.error("Error updating canvas shape:",t.sent()),[3,3];case 3:return[2]}})}),function(e){return eA.apply(this,arguments)}),[r9,eY,rg,rp]),i3=(0,f.useCallback)((eC=(0,i._)(function(e){var t,n;return(0,l.Jh)(this,function(r){try{if(!(t=null==e?void 0:e.pageId)||"null"===t||"undefined"===t||""===t.trim())return console.warn("⚠️ updateFlowchartShape called without a valid pageId:",t),[2];n=(0,o._)((0,a._)({shapeId:e.id},e),{props:(0,o._)((0,a._)({},e.props),{position:{x:e.x,y:e.y},typeName:e.typeName,fromId:null==e?void 0:e.fromId,toId:null==e?void 0:e.toId})}),rf(function(r){return r.syncUpsertShape(t,e.id,n),r})}catch(e){console.error("Error updating canvas shape:",e)}return[2]})}),function(e){return eC.apply(this,arguments)}),[eY,rp]),i2=(eT=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,,3]),!rg||!(null==eY?void 0:eY.uid)||!e)return[2];return removeAttachedItemFromContext(e,!1),[4,r5({shapeId:e,pageId:rg}).unwrap()];case 1:return t.sent(),rf(function(t){return t.removeShape(rg,e),t}),[3,3];case 2:return console.error("Error deleting canvas shape:",t.sent()),[3,3];case 3:return[2]}})}),function(e){return eT.apply(this,arguments)}),i6=(eD=(0,i._)(function(e,t){return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(!e)return[2];rf(function(n){return n.queueShapeDelete(null!=t?t:null,e),n}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r5((0,a._)({shapeId:e},t?{pageId:t}:{})).unwrap()];case 2:return n.sent(),rf(function(t){return t.resolveShapeDelete(e),t}),[3,4];case 3:return console.error("Error deleting flowchart shape:",n.sent()),[3,4];case 4:return[2]}})}),function(e,t){return eD.apply(this,arguments)}),i4=(eb=(0,i._)(function(e,t,n,r){var i,s,u,d,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T,b,x,P,M,L,O,G,R,F,V,k;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(!n||!(i=(0,W.W_)())||!(s=i.getShape(n))||!t||isItemInProgressQueue("shape",n)||isItemInProgressQueue("asset",e.id))return[2];addItemInProgressQueue("shape",n),addItemInProgressQueue("asset",e.id),l.label=1;case 1:if(l.trys.push([1,12,,13]),"string"!=typeof t)return[3,4];return[4,fetch(t)];case 2:return[4,l.sent().blob()];case 3:return y=(v=l.sent()).type.split("/")[1]||"png",w="heatmap_".concat(Date.now(),".").concat(y),h=new File([v],w,{type:v.type||"image/png"}),[3,5];case 4:h=t,l.label=5;case 5:return S=(null===(u=e.props)||void 0===u?void 0:u.w)||(null===(d=s.props)||void 0===d?void 0:d.w)||1440,_=(null===(c=e.props)||void 0===c?void 0:c.h)||(null===(p=s.props)||void 0===p?void 0:p.h)||840,[4,ie({pageId:r,uid:null==eY?void 0:eY.uid,props:{name:h.name,w:S,h:_,fileSize:h.size,mimeType:h.type,isAnimated:!1,src:null},file:h})];case 6:return I=null===(f=l.sent().data)||void 0===f?void 0:f.asset.id,[4,i0({id:n,pageId:r,uid:null==eY?void 0:eY.uid,type:s.type,props:(0,o._)((0,a._)({},s.props),{assetId:I,dimensions:{width:e.props.w||(null===(m=s.props)||void 0===m?void 0:m.w)||1440,height:e.props.h||(null===(g=s.props)||void 0===g?void 0:g.h)||840},position:{x:s.x,y:s.y},shapeId:""}),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})];case 7:E=l.sent(),A=!1,C=20,l.label=8;case 8:if(!(C>0&&!A)||A)return[3,11];return[4,it({assetId:I}).unwrap()];case 9:if((null==(T=l.sent())?void 0:null===(b=T.asset)||void 0===b?void 0:b.status)==="completed")return A=!0,[3,11];if((null==T?void 0:null===(x=T.asset)||void 0===x?void 0:x.status)==="error")return eF({message:"Error uploading image",type:"error"}),[3,11];return[4,new Promise(function(e){return setTimeout(e,2e3)})];case 10:return l.sent(),C--,[3,8];case 11:if(0===C&&!A)return eF({message:"Error uploading image",type:"error"}),removeItemInProgressQueue("shape",n),removeItemInProgressQueue("asset",e.id),[2];if(E&&T&&Object.keys(T).length>0){if(!(null==(O=null==T?void 0:null===(P=T.asset)||void 0===P?void 0:P.props)?void 0:O.src))return console.error("Asset uploaded but no src URL found!"),eF({message:"Image uploaded but URL is missing",type:"error"}),removeItemInProgressQueue("asset",e.id),removeItemInProgressQueue("shape",n),[2];rf(function(e){return e.addAsset(r,(0,o._)((0,a._)({},null!=T?T:{}),{id:I})),e.addShape(r,(0,o._)((0,a._)({},E),{type:"image"})),e}),G=i.getShape(n),i.updateShape((0,o._)((0,a._)({},s),{x:null!==(R=null==G?void 0:G.x)&&void 0!==R?R:s.x,y:null!==(F=null==G?void 0:G.y)&&void 0!==F?F:s.y,props:(0,o._)((0,a._)({},s.props),{h:null!==(V=null===(M=null==G?void 0:G.props)||void 0===M?void 0:M.h)&&void 0!==V?V:s.props.h,w:null!==(k=null===(L=null==G?void 0:G.props)||void 0===L?void 0:L.w)&&void 0!==k?k:s.props.w,assetId:"asset:".concat(I),shapeId:E.id})})),i.createAssets([{id:"asset:".concat(I),type:"image",typeName:"asset",meta:{},props:{name:(null==O?void 0:O.name)||(null==h?void 0:h.name),src:null==O?void 0:O.src,w:(null==O?void 0:O.w)||S,h:(null==O?void 0:O.h)||_,fileSize:(null==O?void 0:O.fileSize)||(null==h?void 0:h.size),mimeType:(null==O?void 0:O.mimeType)||(null==h?void 0:h.type),isAnimated:(null==O?void 0:O.isAnimated)||!1}}]),i.deleteAssets([e.id]),removeItemInProgressQueue("asset",e.id),removeItemInProgressQueue("shape",n)}else console.log("Else Block Running...");return eU.capture(D.Je.IMAGE_SHAPE_CREATED,{distinct_id:ej,page_id:r,shape_id:null==E?void 0:E.id,shape_type:s.type}),[3,13];case 12:return console.error("Error processing image:",l.sent()),eF({message:"Failed to process image",type:"error"}),removeItemInProgressQueue("shape",n),removeItemInProgressQueue("asset",e.id),[3,13];case 13:return[2]}})}),function(e,t,n,r){return eb.apply(this,arguments)}),addItemInProgressQueue=function(e,t){var n="".concat(e,"s");is[n].includes(t)||ia(function(e){return(0,o._)((0,a._)({},e),(0,s._)({},n,(0,d._)(e[n]).concat([t])))})},removeItemInProgressQueue=function(e,t){var n="".concat(e,"s");is[n].includes(t)&&ia(function(e){return(0,o._)((0,a._)({},e),(0,s._)({},n,e[n].filter(function(e){return e!==t})))})},isItemInProgressQueue=function(e,t){var n="".concat(e,"s");return!!is[n]&&is[n].includes(t)},i9=(ex=(0,i._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:if(isItemInProgressQueue("shape",e))return eF({message:"Image is being processed",type:"error"}),[2];if(!(t=rp.getShape(e)))return eF({message:"Shape not found",type:"error"}),[2];if(isItemInProgressQueue("asset",n=t.props.assetId.includes("asset:")?t.props.assetId.split("asset:")[1]:t.props.assetId))return eF({message:"Asset is being processed",type:"error"}),[2];if(rp.getAsset(n)||eF({message:"Asset not found",type:"error"}),!(r=(0,W.W_)()))return[2];return i=r.getCurrentPageShapes().filter(function(t){return t.props.shapeId===e}),r.deleteShapes(i.map(function(e){return e.id})),r.deleteAssets(["asset:".concat(n)]),[4,i2(e)];case 1:return s.sent(),[4,i7(n)];case 2:return s.sent(),[2]}})}),function(e){return ex.apply(this,arguments)}),i5=(eW=(0,i._)(function(e){var t,n,r,i,s;return(0,l.Jh)(this,function(a){switch(a.label){case 0:if(t=function(t){var s=e[t];if(isItemInProgressQueue("shape",s))return eF({message:"Image is being processed",type:"error"}),"continue";var a=rp.getShape(s);if(!a)return eF({message:"Shape not found",type:"error"}),"continue";var o=a.props.assetId.includes("asset:")?a.props.assetId.split("asset:")[1]:a.props.assetId;if(isItemInProgressQueue("asset",o))return eF({message:"Asset is being processed",type:"error"}),"continue";if(!rp.getAsset(o))return eF({message:"Asset not found",type:"error"}),"continue";var u=n.getCurrentPageShapes().filter(function(e){return e.props.shapeId===s}),d=u.length>0?u[0].id:void 0;n.deleteShapes(d?[d]:[]),n.deleteAssets(o?["asset:".concat(o)]:[]),i.push(o),r.push(s)},!(n=(0,W.W_)()))return[2];for(s=0,r=[],i=[];s<e.length;s++)t(s);return[4,Promise.all(r.map(function(e){return i2(e)}))];case 1:return a.sent(),[4,Promise.all(i.map(function(e){return i7(e)}))];case 2:return a.sent(),[2]}})}),function(e){return eW.apply(this,arguments)}),i7=(eP=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,,3]),!rg||!(null==eY?void 0:eY.uid))return[2];return[4,ir({assetId:e,uid:null==eY?void 0:eY.uid,pageId:rg}).unwrap()];case 1:return console.log("Result:",t.sent()),rf(function(t){return t.removeAsset(rg,e),t}),[3,3];case 2:return console.error("Error deleting canvas asset:",t.sent()),[3,3];case 3:return[2]}})}),function(e){return eP.apply(this,arguments)}),removeAttachedItemFromContext=function(e,t){t?nJ(function(t){var n;return(0,o._)((0,a._)({},t),{itemsAttachedWithContext:null==t?void 0:null===(n=t.itemsAttachedWithContext)||void 0===n?void 0:n.filter(function(t){return t.id!==e})})}):tq(function(t){var n;return(0,o._)((0,a._)({},t),{itemsAttachedWithContext:null==t?void 0:null===(n=t.itemsAttachedWithContext)||void 0===n?void 0:n.filter(function(t){return t.id!==e})})})},i8=(eM=(0,i._)(function(){var e,t,n,r,i,u,d,p,f,m,g,h,v,y,w,S;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(null===(e=nB.screenFlows)||void 0===e?void 0:e.some(function(e){var t;return!(null===(t=e.prompt)||void 0===t?void 0:t.trim())}))return eK({title:"Action Required",children:(0,c.jsx)(ActionCard,{type:"warning",message:"Describe the Screens before proceeding."})}),[2];if("ds-1"===nB.designSystem&&"hifi"===nB.selectedDesignMode&&tu!==D.FD.PRO&&tu!==D.FD.ENTERPRISE)return eZ(D.GY.FLOWBITE),[2];if(n=nB.isHiFi?"ds-0"===nB.designSystem?R.Sw.UI_00:"ds-1"===nB.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20,to.totalAvailableCredits<n)return eZ("save-ui"),[2];return i=[],p=(d=getTargetPosition(u=(0,W.W_)())).x,f=d.y,[4,io(rg)];case 1:if(m=l.sent(),g=t2&&rp.getWireframe(t2)?"Context Code To Generate New: \n"+(null===(t=rp.getWireframe(t2))||void 0===t?void 0:t.wireframeOutputHtml):"",eU.capture(D.Je.CREDITS_USED,{amount:n,reason:"create_flow_from_single_screen_generation",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email}),rP(!0),!(h=tv.find(function(e){return e.id===rg})))throw Error("Page not found");if(v=(null==h?void 0:h.pageAiContext)||"",y=function(e){var t="Command by user: \n".concat(e,"\n").concat(g);return v&&(t="".concat(t,"\n Project Context (Context for the overall project):\n").concat(v)),t},w=(0,el.A3)(nB.selectedType),S=(0,el.jv)(nB.selectedType),nB.screenFlows&&nB.screenFlows.length>0&&(r=nB.screenFlows.map(function(e,t){var n="temp_".concat(Date.now(),"_").concat(t);i.push(n);var r=(0,s._)({x:p,y:f},rg,{x:p,y:f}),d=(0,o._)((0,a._)({},nB),{uploadedDocument:void 0,id:n,order:t,wireframeId:n,type:D.Ty.WIREFRAME,isLoading:!0,requestTime:new Date().getTime(),saveStatus:D.G3.UNSAVED,useCase:nB.selectedType,status:"generating",screenTitle:e.title,prompt:e.prompt,dimensions:(0,s._)({width:w,height:S},rg,{width:w,height:S}),position:r});return rf(function(e){e.addWireframe(m,d)}),u&&((0,W.wf)(u,{wireframeId:d.id,groupId:m,status:d.status,dimensions:d.dimensions,position:{x:r.x,y:r.y},title:d.screenTitle||d.prompt}),0===t&&u.zoomToBounds({x:r.x-300,y:r.y-300,w:w+1200||0,h:S+1200||0},{animation:{duration:500}})),p+=w+100,(0,o._)((0,a._)({},e),{position:r,id:void 0,tempId:n})})),!(nB.screenFlows.length>0))return[3,3];return[4,rN((0,o._)((0,a._)({},nB),{topic:y(nB.prompt),userInputPrompt:[nB.prompt],isS:ta,pageId:rg,flows:r})).unwrap()];case 2:iP(l.sent(),m,nB,m),l.label=3;case 3:return rP(!1),[2]}})}),function(){return eM.apply(this,arguments)}),se=(eL=(0,i._)(function(e){var t,n,r,i,s,a,o,u,d,c,p,f,m,g;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(t=(0,W.W_)(),n="loading_".concat(Date.now()),r="image_".concat(Date.now()),!t)return[3,7];if(nU(!0),a=(null==e?void 0:null===(i=e.dimensions)||void 0===i?void 0:i.width)?null==e?void 0:e.dimensions:(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height),!rg)return console.error("currentPageId is null"),[2];o=null==e?void 0:e.useCase,u=(null===(s=e.position)||void 0===s?void 0:s[rg])||{x:0,y:0},d=o===ee.ke.MOBILE||o===ee.ke.MOBILELEGACY?500:o===ee.ke.TABLET?1200:o===ee.ke.DESKTOPHD?2100:1600,c=u.x+d,p=u.y,(0,W.jL)(t,{wireframeId:n,dimensions:a,position:{x:c,y:p},useCase:(null==e?void 0:e.useCase)||ee.ke.DESKTOP}),l.label=1;case 1:return l.trys.push([1,5,6,7]),[4,r6({uid:ej,imageUrl:null==nF?void 0:nF.previewUrl,isSubscribed:ta}).unwrap()];case 2:return f=l.sent().url,[4,t.getAssetForExternalContent({type:"url",url:f})];case 3:if(!(m=l.sent()))throw Error("Failed to create temporary asset");return(0,W.Sh)(t,n),g="shape:".concat(r),t.createAssets([m]),t.createShape({id:g,type:"image",x:c,y:p,props:{w:a.width,h:a.height,assetId:m.id}}),[4,i4(m,f,g,rg)];case 4:return l.sent(),td(),eU.capture(D.Je.HEATMAP_CREDITS_USED,{amount:R.gF.heatmap.credits,reason:"heatmap",generated_from_canvas:!0,timestamp:Date.now(),user_id:ej}),eF({message:"Heatmap generated successfully!",type:"success"}),[3,7];case 5:return console.error("Heatmap generation failed:",l.sent()),(0,W.Sh)(t,n),eF({message:"Failed to generate heatmap",type:"error"}),[3,7];case 6:return nU(!1),[7];case 7:return[2]}})}),function(e){return eL.apply(this,arguments)}),toggleBulkWireframesEdit=function(e){rL.length>0?rO([]):(rO(e),e$(""),e7(null),np(null),ng(null),nJ(function(e){return(0,o._)((0,a._)({},e),{contextForDesign:null,uploadedImage:null,itemsAttachedWithContext:[],useVariation:!1})}))},st=(eO=(0,i._)(function(e){var t,n,r,i,s,u,c,p,f,m,g,h,v,y,w,S,_,I,E,A,C,T;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(e.preventDefault(),0===rL.length)return[2];if(n=rL.map(function(e){return rp.getWireframe(e)}).filter(Boolean),r=Date.now(),eU.capture(D.Je.BULK_REGENERATION_STARTED,{distinct_id:ej,wireframe_ids:rL,original_prompts:n.map(function(e){return null==e?void 0:e.prompt}),new_prompt:eq,design_type:n.map(function(e){return null==e?void 0:e.designSystem}),is_hifi:n.map(function(e){return null==e?void 0:e.isHiFi})}),(null==(i=processAttachments(null==nB?void 0:nB.itemsAttachedWithContext))?void 0:i.documentId)&&eU.capture(D.Je.GENERATION_WITH_DOCUMENT_ATTACHED,{document_id:i.documentId,design_mode:tQ.selectedDesignMode,user_id:ej,email:null==eY?void 0:eY.email}),(null==i?void 0:null===(t=i.attachedImages)||void 0===t?void 0:t.length)>0&&i.attachedImages.forEach(function(e){eU.capture(D.Je.GENERATION_WITH_IMAGE_ATTACHED,{image_url:e.url,image_type:e.type,design_mode:tQ.selectedDesignMode,user_id:ej,email:null==eY?void 0:eY.email})}),s=n.reduce(function(e,t){return t?e+(t.isHiFi?"ds-0"===t.designSystem?R.Sw.UI_00:"ds-1"===t.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20):e},0),to.totalAvailableCredits<s)return eZ("save-ui"),[2];eU.capture(D.Je.CREDITS_USED,{amount:s,reason:"bulk_regeneration",timestamp:Date.now(),user_id:ej,email:null==eY?void 0:eY.email}),rI(!0),u=(0,W.W_)(),c=n.map(function(e,t){var n=rp.findParentGroup(null==e?void 0:e.id);if(!n)return eF({message:"Parent group not found for wireframe ".concat(t+1),type:"error"}),null;var r=((null==e?void 0:e.order)||(null==e?void 0:e.screenOrder))-1;r=r?r-1:0;var i="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));if(rf(function(t){t.addWireframe(n,{id:i,order:r,screenOrder:r,type:D.Ty.WIREFRAME,isLoading:!0,status:"generating",useCase:null==e?void 0:e.useCase,saveStatus:D.G3.UNSAVED,requestTime:new Date().getTime(),parentId:null==e?void 0:e.id},!0)}),(null==e?void 0:e.id)&&addWireframeInVersionGroup(e.id,i,r),u){var s=u.getCurrentPageShapes().find(function(t){var n;return"frame"===t.type&&(null===(n=t.props)||void 0===n?void 0:n.wireframeId)===(null==e?void 0:e.id)});s&&(0,W.gT)(u,s.id,{title:nB.prompt,wireframeId:i,status:"generating",dimensions:(0,el.Mi)(null==e?void 0:e.useCase,null==e?void 0:e.width,null==e?void 0:e.height)})}return{tempId:i,parentGroupId:n,originalWireframe:e,order:r}}).filter(function(e){return!!e}),l.label=1;case 1:return l.trys.push([1,3,4,5]),g=nB.contextForDesign,v=h=nB.prompt||eq,w=(null==(y=tv.find(function(e){return e.id===rg}))?void 0:y.pageAiContext)||"",g&&(null==(S=null==rp?void 0:rp.getWireframe(g))?void 0:S.wireframeOutputHtml)&&("hifi"===tQ.selectedDesignMode?v="Context of Screen: ".concat(S.prompt," /n ###").concat(v," /n Wireframe Code: ").concat(S.wireframeOutputHtml):v+="\nCode of Context design chosen by User:\n"+S.wireframeOutputHtml),w&&(v="".concat(v,"\n### Project Context (Apply these guidelines to this design):\n").concat(w)),_=c.map(function(e){e.tempId;var t,n,r,i=e.originalWireframe;return e.order,{wireframeId:i.id,editPrompt:h,isPrimary:!0,selectedSection:tW||{},position:null!==(r=null!==(n=null==i?void 0:null===(t=i.position)||void 0===t?void 0:t[rg])&&void 0!==n?n:null==i?void 0:i.position)&&void 0!==r?r:{x:0,y:0},title:(null==i?void 0:i.title)||(null==i?void 0:i.prompt)||"Screen"}}),[4,rJ({type:null!==(I=null===(p=n[0])||void 0===p?void 0:p.designMode)&&void 0!==I?I:(null===(f=n[0])||void 0===f?void 0:f.isHiFi)?"hifi":"wireframe",screens:_,topic:v,designSystem:nB.designSystem,selectedFont:nB.selectedFont,selectedType:null===(m=n[0])||void 0===m?void 0:m.useCase,selectedColor:nB.selectedColor||tQ.selectedColor,colorMode:tQ.isDarkMode?"dark":"light",userInputPrompt:[h],prompt:h,selectedModel:null!==(E=nB.selectedModel)&&void 0!==E?E:tQ.selectedModel,modelVariant:null!==(A=nB.modelVariant)&&void 0!==A?A:tQ.modelVariant,useMaxLimit:nB.useMaxLimit,deepDesign:!1,fineTune:!0,customCollectionName:null,isS:ta,pageId:rg,attachments:processAttachments(null==nB?void 0:nB.itemsAttachedWithContext)}).unwrap()];case 2:return(C=l.sent())&&C.length>0&&(C.forEach(function(e){var t,n=c.find(function(t){return t.originalWireframe.id===e.wireframeId});if(n){var r=e.design.id||e.wireframeId,i=(0,o._)((0,a._)({},e.design),{id:r,wireframeId:r,type:D.Ty.WIREFRAME,prompt:e.editPrompt,order:n.order,screenOrder:n.order,parentId:e.design.parentId||n.originalWireframe.id,isHiFi:e.design.isHiFi,isWireFrame:e.design.isWireFrame,isL1:e.design.isL1,designSystem:e.design.designSystem,saveStatus:D.G3.UNSAVED,status:e.design.status||"generating",useCase:e.design.useCase,useMaxLimit:null!==(t=e.design.useMaxLimit)&&void 0!==t&&t,model:e.design.model,customCollectionName:e.design.customCollectionName,isLoading:!1,fineTune:e.design.fineTune,date:e.design.date||new Date().toISOString(),originalWireframeData:e.originalWireframeData});rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t.removeWireframe(n.parentGroupId,n.tempId),t.addWireframe(n.parentGroupId,i,!0),t}),nX(function(t){var i=new Map(t),s=iF()||[];return s.forEach(function(t){t.mainScreen===n.originalWireframe.id&&(t.versionScreens=[{id:r,parentId:n.originalWireframe.id,order:n.order,date:e.design.date||new Date().toISOString()}].concat((0,d._)(t.versionScreens)),t.currentVisible=r,t.expanded=!0)}),i.set(rg,s),i}),u&&u.getCurrentPageShapes().forEach(function(t){var i;"frame"===t.type&&(null===(i=t.props)||void 0===i?void 0:i.wireframeId)===n.tempId&&(0,W.gT)(u,t.id,{wireframeId:r,status:e.design.status||"generating",title:e.title||e.editPrompt,position:e.position||{x:t.x,y:t.y}})})}}),setTimeout(function(){ro(!0)},1e3),eU.capture(D.Je.BULK_REGENERATION_COMPLETED,{distinct_id:ej,wireframe_ids:rL,generation_time:Date.now()-r,total_wireframes:n.length,successful_wireframes:C.length,failed_wireframes:0}),eF({message:"All designs re-generation started successfully",type:"info"})),[3,5];case 3:return console.error("Error in bulk regeneration:",T=l.sent()),c.forEach(function(e){var t=e.tempId,n=e.parentGroupId;rf(function(e){e.removeWireframe(n,t)})}),eU.capture(D.Je.BULK_REGENERATION_FAILED,{distinct_id:ej,wireframe_ids:rL,generation_time:Date.now()-r,total_wireframes:n.length,successful_wireframes:0,failed_wireframes:n.length,error_message:T.message||"Failed to regenerate designs"}),eF({message:"Failed to start designs re-generation. Please try again.",type:"error"}),[3,5];case 4:return toggleBulkWireframesEdit([]),rI(!1),null==u||u.setEditingShape(null),null==u||u.setSelectedShapes([]),nB.prompt="",nB.uploadedImage=null,nB.contextForDesign=null,nB.useMaxLimit=!1,nB.useVariation=!1,nB.numberOfVersion=void 0,nB.pickingContext=!1,nJ(function(e){return(0,a._)({},e)}),[7];case 5:return[2]}})}),function(e){return eO.apply(this,arguments)}),sn=(0,f.useMemo)(function(){if(!rp||"function"!=typeof rp.getAllWireframes)return{totalGeneratedScreens:0,isAnyGenerating:!1};var e=rp.getAllWireframes()||[];return{totalGeneratedScreens:e.length,isAnyGenerating:e.some(function(e){return(!(null==e?void 0:e.id)||(null==e?void 0:e.isLoading)||(null==e?void 0:e.status)==="generating")&&!(null==e?void 0:e.wireframeOutputHtml)})}},[rp]),sr={showCodeId:e5,formData:tQ,newPrompt:eq,loadingAi:ry,loadingRegenrationAI:r_,loadingVariationAI:rA,isGlobalUploading:rD,showExportId:tc,shareDesignId:tD,isSidebarOpen:tL,showEditPrompt:tR,showGeneratePrototypeModal:tk,toggleShowGeneratePrototypeModal:function(e){tN(e)},handlePrototypeGeneration:ik,wireframesData:tz,groupPreviewURL:n1,setWireframesData:tj,setDesignsData:rf,allSavedWireframes:tH,exportGroupId:n6,groupsData:tm,pages:tv,tempFont:nM,setTempFont:nL,setPages:ty,getPagesData:iy,loadingGroupWireframes:tZ,isGroupSaved:function(e){var t=rp.getGroup(e);return(null==t?void 0:t.saveStatus)===D.G3.SAVED},addGroupWireframesData:iA,handleGroupSave:iC,handleGroupUnSave:iT,saveGroupId:t9,getGroupsData:ih,setSaveGroupId:t5,toggleSave:iM,handleSubmit:iL,setLoadingAi:rw,setIsGlobalUploading:rb,setNewPrompt:e$,toggleExport:function(e){if(!ta||tu===D.FD.INACTIVE){eZ(D.GY.EXPORT_TO_FIGMA);return}if(e===tc){tp(null);return}tp(e)},toggleSidebar:function(){var e=document.getElementsByClassName("tlui-navigation-panel");if(e.length>0){var t=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;tL?a.style.setProperty("left","12px","important"):a.style.setProperty("left","322px","important")}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}}var o=document.getElementsByClassName("canvas-color-picker").item(0);o&&(tL?o.style.setProperty("left","120px","important"):o.style.setProperty("left","430px","important"));var u=document.getElementsByClassName("tlui-helper-buttons").item(0);u&&(tL?u.style.setProperty("left","4px","important"):u.style.setProperty("left","318px","important")),tO(!tL)},setGroupPreviewURL:n3,toggleShowCode:function(e){var t;if(!ta||tu===D.FD.INACTIVE){eZ(D.GY.SOURCE_CODE);return}if(e!==e5){if(te){ti(!0);return}tF(null),np(null),ng(null),e7(e),eU.capture(D.Je.SHOW_CODE_VIEW,{distinct_id:ej,wireframe_id:e,design_type:null===(t=rp.getWireframe(e))||void 0===t?void 0:t.designSystem,user_id:ej})}},toggleShareDesign:function(e){if(!ta||tu===D.FD.INACTIVE){eZ(D.GY.SHARE_DESIGN);return}if(e===tD){tb(null);return}tb(e)},handleUpdateCode:ij,setShareDesignId:tb,toggleShowPrompt:iz,selectedSectionInfo:tW,contextForDesign:t2,setFontWireframeId:ng,fontWireframeId:nm,pickingContext:nj,togglePickingContext:function(e){if(!ta||tu===D.FD.INACTIVE){eZ(D.GY.REFERENCE_FEATURE);return}e===nj?nY(null):nY(e)},setContextForDesign:t6,setSelectedSectionInfo:tP,setSelectedTopic:function(e){tq(function(t){return(0,o._)((0,a._)({},t),{topic:e})})},refreshWireframes:function(){rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),t})},setShowEditPrompt:tF,handleRemoveScreen:handleRemoveScreen,handleRemoveVersionScreen:handleRemoveVersionScreen,handleRegeneration:iG,handleGenerateDeviceVersion:iR,handleFormDataChange:iW,setRegenerateFormData:nJ,regenerateFormData:nB,handleUploadedImage:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?nJ(function(t){return(0,o._)((0,a._)({},t),{uploadedImage:e})}):tq(function(t){return(0,o._)((0,a._)({},t),{uploadedImage:e})})},setAllSavedWireframes:tB,handleClearWireframes:function(){if(ry){eF({message:"Please wait for the generation process to complete",type:"error"});return}if(te){ti(!0);return}e7(null),tF(null),rw(!1),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),rg&&t.clearPage(rg),t}),eF({message:"Canvas cleared successfully",type:"success"})},deleteWireframeGroup:iY,handleRetry:iN,setExportGroupId:n4,deleteFailedWireframe:function(e){rf(function(t){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,t),n.removeWireframeByRetryId(e,!0),n})},addGroupPreviewURL:function(e,t){n3(function(n){for(var r=(0,d._)(n);r.length<=t;)r.push("");return r[t]=e,r})},SAVE_STATUS:D.G3,promptList:nG,designsData:rp,currentPageId:rg,fontGroupId:nc,setFontGroupId:np,createNewPage:ic,resetFormData:ix,isFlowBiteNotAllowed:function(){return"ds-1"===tQ.designSystem&&"hifi"===tQ.selectedDesignMode&&tu!==D.FD.PRO&&tu!==D.FD.ENTERPRISE},haveLessCredits:function(){var e=tQ.isHiFi?"ds-0"===tQ.designSystem?R.Sw.UI_00:"ds-1"===tQ.designSystem?R.Sw.UI_10:R.Sw.UI_20:R.Sw.WIREFRAMES_20;return to.totalAvailableCredits<e},addScreenOnSelectedPage:ip,deleteGroup:iD,setCurrentPageId:rh,addWireframeToScreen:ig,addPageWireframesData:iE,loadingPages:t_,loadingCurrentPage:rr,loadingShapes:tA,handleMoveUpdate:function(e){var t=e.wireframeId,n=e.wireframeIds,r=e.groupId,i=e.type,s=e.currentPageId;if(eU.capture(D.Je.DESIGN_MOVED,(0,a._)({distinct_id:ej,user_id:ej,type:i},r&&{group_id:r},t&&{wireframe_id:t},n&&{wireframe_ids:n})),te){ti(!0);return}if(e7(null),tF(null),np(null),ng(null),"multiple-wireframes"===i){rf(function(e){return null==n||n.forEach(function(t){var n=rp.findParentGroup(t);n&&e.removeWireframe(n,t)}),e});var o=(0,W.W_)();if(o){var u=[];o.getCurrentPageShapes().forEach(function(e){"frame"===e.type&&(null==n?void 0:n.includes(e.props.wireframeId))&&u.push(e)}),o.deleteShapes(u)}removeWireframesFromVersionGroup(n||[])}else if("group"===i)rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),s&&t.removeGroup(s,r),t});else if("wireframe"===i){rf(function(e){var n=new G(null==eY?void 0:eY.uid);return Object.assign(n,e),n.removeWireframe(r,t),n});var d=(0,W.W_)();if(d){var l=d.getCurrentPageShapes().find(function(e){return"frame"===e.type&&e.props.wireframeId===t});l&&d.deleteShape(l.id)}updateVersionGroups({wireframeId:t,groupId:r,type:i,currentPageId:s})}else if("versionGroup"===i){var c,p,f=null===(c=iF())||void 0===c?void 0:c.find(function(e){return e.mainScreen===t||e.versionScreens.some(function(e){return e.id===t})});if(!f){console.warn("Target version group not found");return}var m=f.versionScreens.map(function(e){return e.id});m.push(f.mainScreen);var g=(0,W.W_)(),h=[];g&&(g.getCurrentPageShapes().forEach(function(e){"frame"===e.type&&m.includes(e.props.wireframeId)&&h.push(e.id)}),null==g||g.deleteShapes(h)),rf(function(e){var t=new G(null==eY?void 0:eY.uid);return Object.assign(t,e),m.forEach(function(e){t.removeWireframe(r,e)}),t});var v=(null===(p=iF())||void 0===p?void 0:p.filter(function(e){return e.mainScreen!==f.mainScreen}))||[];nX(function(e){var t=new Map(e);return t.set(s,v),t})}},setLoadingCurrentPage:ri,handleDesignContext:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("regenerate"===nj&&t){if(nB.contextForDesign===e)nJ(function(e){return(0,o._)((0,a._)({},e),{contextForDesign:null,selectedFont:""})});else{var n,r=rp.getWireframe(e),i=(null==r?void 0:null===(n=r.wireframeOutputHtml)||void 0===n?void 0:n.length)||0,s=tu!==D.FD.STANDARD&&tu!==D.FD.INACTIVE,u=nB.useMaxLimit,d=(i>22e3||u)&&s;nJ(function(t){return(0,o._)((0,a._)({},t),{contextForDesign:e,useMaxLimit:d,deepDesign:!1,selectedFont:(null==r?void 0:r.selectedFont)||(null==r?void 0:r.font)||(null==r?void 0:r.suggestedFont)||""})})}}else if(t2===e)t6(null);else if(t6(e),e){var l=rp.getWireframe(e);if(null==l?void 0:l.useCase){var c,p=(null===(c=l.wireframeOutputHtml)||void 0===c?void 0:c.length)||0,f=tu!==D.FD.STANDARD&&tu!==D.FD.INACTIVE,m=l.useMaxLimit||l.deepDesign,g=(p>22e3||m)&&f;tq(function(e){return(0,o._)((0,a._)({},e),{selectedType:l.useCase,useMaxLimit:!!e.useMaxLimit||g,deepDesign:!1,selectedFont:(null==l?void 0:l.selectedFont)||(null==l?void 0:l.font)||(null==l?void 0:l.suggestedFont)||""})})}}},toggleShowFont:function(e,t,n){if("group"===t){if(nc===e)np(null);else{if(te){ti(!0);return}e7(null),tF(null),ng(null),np(e),eU.capture(D.Je.SHOW_FONT_VIEW,{distinct_id:ej,group_id:e,user_id:ej,type:D.Ty.GROUP})}}else if("multiple-wireframes"===t){if(te){ti(!0);return}e7(null),n&&n.length>0?nD(n):nD([])}else if(nm===e)ng(null);else{if(np(null),te){ti(!0);return}e7(null),tF(null),ng(e),eU.capture(D.Je.SHOW_FONT_VIEW,{distinct_id:ej,wireframe_id:e,user_id:ej,type:D.Ty.WIREFRAME})}},getCurrentPageVersionGroups:iF,pageVersionGroups:nK,setPageVersionGroups:nX,getVersionGroupById:iK,getWireframeById:iX,handleExpandVersionGroup:function(e){eU.capture(D.Je.VERSION_EXPANDED,{distinct_id:ej,main_screen_id:e,user_id:ej}),nX(function(t){var n=new Map(t),r=iF();if(!r)return n;var i=r.map(function(t){return t.mainScreen===e?(0,o._)((0,a._)({},t),{expanded:!t.expanded}):t});return n.set(rg,i),n})},handleNextVScreen:function(e){eU.capture(D.Je.VERSION_SWITCHED,{distinct_id:ej,main_screen_id:e,user_id:ej,type:"next"});var t=void 0,n=iF()||[];return n.forEach(function(n){if(n.mainScreen===e){if(n.currentVisible===n.mainScreen&&n.versionScreens.length>0)n.currentVisible=n.versionScreens[n.versionScreens.length-1].id,t=n.versionScreens[n.versionScreens.length-1].id;else{var r=-1;if(n.versionScreens.forEach(function(e,t){e.id===n.currentVisible&&(r=t)}),-1===r||0===r)return;var i=r-1;i<0?(n.currentVisible=n.mainScreen,t=n.mainScreen):(n.currentVisible=n.versionScreens[i].id,t=n.versionScreens[i].id)}}}),nX(function(e){var t=new Map(e);return t.set(rg,n),t}),t},handlePreviousVScreen:function(e){eU.capture(D.Je.VERSION_SWITCHED,{distinct_id:ej,main_screen_id:e,user_id:ej,type:"prev"});var t=iF()||[],n=void 0;return t.forEach(function(t){if(t.mainScreen===e){if(t.currentVisible===t.mainScreen){n=t.mainScreen;return}var r=-1;if(t.versionScreens.forEach(function(e,n){e.id===t.currentVisible&&(r=n)}),-1!==r){var i=r+1;i>=t.versionScreens.length?(t.currentVisible=t.mainScreen,n=t.mainScreen):(t.currentVisible=t.versionScreens[i].id,n=t.versionScreens[i].id)}}}),nX(function(e){var n=new Map(e);return n.set(rg,t),n}),n},getVisibleScreenIndex:function(e){var t=iF()||[],n=-1;return t.forEach(function(t){t.mainScreen===e&&(t.currentVisible===t.mainScreen?n=t.versionScreens.length:t.versionScreens.forEach(function(e,r){e.id===t.currentVisible&&(n=r)}))}),n},quickEditModalConfig:e6,setQuickEditModalConfig:e4,updatePageSettings:im,isPageAccessNotAllowed:e1,updateAndSyncWireframe:function(e,t){rf(function(n){return n.syncUpdateWireframe(e,t),n})},historyWireframeId:rd,setHistoryWireframeId:rl,selectedWireframeOnCanvas:nF,setSelectedWireframeOnCanvas:nV,checkIfVersionExists:checkIfVersionExists,sectionEditDesign:t8,setSectionEditDesign:ne,interactiveDesign:ns,setInteractiveDesign:na,textEditDesign:nn,setTextEditDesign:nr,contentChanges:nu,setContentChanges:nd,showVersionsPreviewPanelId:nx,setShowVersionsPreviewPanelId:nW,getGroupIdByWireframeId:function(e){var t=null;return rp.getPageGroups(rg).forEach(function(n){n.wireframes.forEach(function(r){r.id===e&&(t=n.id)})}),t},createCanvasShape:i0,updateCanvasShape:i1,deleteCanvasShape:i2,updateFlowchartShape:i3,deleteFlowchartShape:i6,updateAndSyncCanvasShape:function(e,t){if(!e||null===e||""===e.trim()){console.warn("⚠️ updateAndSyncCanvasShape called with invalid shapeId:",e);return}rf(function(n){return n.syncUpdateShape(e,t),n})},getShapeFromContextById:function(e){return e&&"null"!==e&&"undefined"!==e&&""!==e.trim()&&rp.getShape(e)||null},createNewGroup:io,fontWireframeIds:nT,setFontWireframeIds:nD,getVersionsByWireframeId:getVersionsByWireframeId,exportWireframeIds:n5,setExportWireframeIds:n7,exportWireframePreviewURL:re,setExportWireframePreviewURL:rt,addWireframePreviewURL:function(e){rt(function(t){return(0,d._)(t).concat([e])})},setShowCodeId:e7,isSourceCodeDirty:te,setIsSourceCodeDirty:tt,openUnsavedSourceCodeModal:tr,setOpenUnsavedSourceCodeModal:ti,handleRemoveMultipleScreens:function(e){var t=ek();t.start("Removing screens...");var n=[],r=(0,W.W_)(),i=iF()||[],s=[],o=new Set;if(null==e||e.forEach(function(e){if(checkIfVersionExists(e)){var t=getVersionsByWireframeId(e);s.push.apply(s,(0,d._)(t));var n=i.find(function(t){return t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e})});n&&o.add(n.mainScreen)}else s.push(e)}),s.forEach(function(e){var t=iX(e),s=rp.findParentGroup(e),o={x:0,y:0,w:1440,h:840},u=i.find(function(t){return t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e})});if(r&&t){var d,l,c=r.getCurrentPageShapes().find(function(t){return"frame"===t.type&&t.props.wireframeId===e});c&&(o={x:c.x,y:c.y,w:c.props.w||(null===(d=t.dimensions)||void 0===d?void 0:d.width)||1440,h:c.props.h||(null===(l=t.dimensions)||void 0===l?void 0:l.height)||840})}if(t){var p=u&&u.mainScreen===e;n.push({wireframe:t,shapeData:o,groupId:s,versionGroup:p?(0,a._)({},u):void 0,parentId:t.parentId})}}),rf(function(e){return s.forEach(function(t){e.removeWireframeAndCleanup(t)}),e}),r){var u=[];r.getCurrentPageShapes().forEach(function(t){"frame"===t.type&&(null==e?void 0:e.includes(t.props.wireframeId))&&u.push(t)}),r.deleteShapes(u)}removeWireframesFromVersionGroup(e||[]),t.finish(),eV({message:"".concat(e.length," screen").concat(e.length>1?"s":""," removed successfully"),type:"success",actionText:"Undo",onAction:function(){return il(n)}})},pageConfig:t0,setPageConfig:t1,updatePageConfig:ib,itemsInProgressQueue:is,setItemsInProgressQueue:ia,addItemInProgressQueue:addItemInProgressQueue,removeItemInProgressQueue:removeItemInProgressQueue,isItemInProgressQueue:isItemInProgressQueue,startProcessingImageShape:i4,getCanvasAssetsOnCurrentPage:function(){return rg&&(null==eY?void 0:eY.uid)?null==rp?void 0:rp.getPageAssets(rg):[]},handleRemoveImageFromCanvas:i9,handleUploadedDocument:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?nJ(function(t){return(0,o._)((0,a._)({},t),{uploadedDocument:null!=e?e:void 0})}):tq(function(t){return(0,o._)((0,a._)({},t),{uploadedDocument:null!=e?e:void 0})})},attachItemWithContext:function(e,t){var n,r,i=e.type,s=e.id,u=e.content,l=e.color,c=void 0===l?"":l,p=e.fileType,f=void 0===p?void 0:p,m=e.isLoading,g=void 0!==m&&m;if(t){if(null==nB?void 0:null===(n=nB.itemsAttachedWithContext)||void 0===n?void 0:n.some(function(e){return e.id===s}))return;nJ(function(e){var t;return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:[{type:i,id:s,content:u,color:c,fileType:f,isLoading:g}].concat((0,d._)(null!==(t=null==e?void 0:e.itemsAttachedWithContext)&&void 0!==t?t:[]))})})}else{if(null==tQ?void 0:null===(r=tQ.itemsAttachedWithContext)||void 0===r?void 0:r.some(function(e){return e.id===s}))return;tq(function(e){var t;return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:[{type:i,id:s,content:u,color:c,fileType:f,isLoading:g}].concat((0,d._)(null!==(t=null==e?void 0:e.itemsAttachedWithContext)&&void 0!==t?t:[]))})})}},attachBulkItemsWithContext:function(e,t){if(t){var n=e.filter(function(e){var t;return!(null==nB?void 0:null===(t=nB.itemsAttachedWithContext)||void 0===t?void 0:t.some(function(t){return t.id===e.id}))});nJ(function(e){var t;return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:(0,d._)(n).concat((0,d._)(null!==(t=null==e?void 0:e.itemsAttachedWithContext)&&void 0!==t?t:[]))})})}else{var r=e.filter(function(e){var t;return!(null==tQ?void 0:null===(t=tQ.itemsAttachedWithContext)||void 0===t?void 0:t.some(function(t){return t.id===e.id}))});tq(function(e){var t;return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:(0,d._)(r).concat((0,d._)(null!==(t=null==e?void 0:e.itemsAttachedWithContext)&&void 0!==t?t:[]))})})}},removeAttachedItemFromContext:removeAttachedItemFromContext,removeMultipleImagesFromCanvas:i5,updatedAttachedStickyNoteContent:function(e,t){var n=null==tQ?void 0:tQ.itemsAttachedWithContext;if(null==n?void 0:n.some(function(t){return"sticky-note-shape"===t.type&&t.id===e})){var r=null==n?void 0:n.map(function(n){return n.id===e?(0,o._)((0,a._)({},n),{content:t}):n});tq(function(e){return(0,o._)((0,a._)({},e),{itemsAttachedWithContext:r})})}},handleCreateAFlowFromSingleScreen:i8,isCreateAFlowLoading:rW,generatePredictiveHeatmap:se,isHeatmapGenerating:nN,updateWireframeMutation:rQ,focusWireframe:iS,wireframesToRemoveFromGroup:nv,setWireframesToRemoveFromGroup:ny,isPolling:ra,toggleBulkWireframesEdit:toggleBulkWireframesEdit,bulkWireframesEdit:rL,handleBulkRegeneration:st,setLoadingRegenrationAI:rI,getVersionsByWireframeIdAndPageId:function(e,t){var n=iZ(t)||[],r=[];return n.forEach(function(t){(t.mainScreen===e||t.versionScreens.some(function(t){return t.id===e}))&&(r.push(t.mainScreen),r.push.apply(r,(0,d._)(t.versionScreens.map(function(e){return e.id}))))}),r},getVersionGroupsByPageId:iZ,checkIfVersionExistsByPageId:function(e,t){var n=iZ(t)||[],r=!1;return n.forEach(function(t){t.mainScreen===e&&t.versionScreens.length>0&&(r=!0),t.versionScreens.some(function(t){return t.id===e})&&(r=!0)}),r},wireframesInfo:sn};return(0,c.jsx)(ec.Provider,{value:sr,children:eG})},useWireframerLoading=function(){return{loadingGroupWireframes:(0,m.Sz)(ec,function(e){return null==e?void 0:e.loadingGroupWireframes}),loadingPages:(0,m.Sz)(ec,function(e){return null==e?void 0:e.loadingPages}),loadingCurrentPage:(0,m.Sz)(ec,function(e){return null==e?void 0:e.loadingCurrentPage}),loadingShapes:(0,m.Sz)(ec,function(e){return null==e?void 0:e.loadingShapes})}},usePageStructure=function(){var e=(0,m.Sz)(ec,function(e){return null==e?void 0:e.designsData}),t=(0,m.Sz)(ec,function(e){return null==e?void 0:e.currentPageId});return t?null==e?void 0:e.getPageStructure(t):null}},74798:function(e,t,n){n.d(t,{A:function(){return s},O:function(){return a}});var r,i=n(21575),s={COLOR_001:"color-001",COLOR_002:"color-002",COLOR_003:"color-003",COLOR_004:"color-004",COLOR_005:"color-005",COLOR_006:"color-006",COLOR_007:"color-007",COLOR_008:"color-008",COLOR_009:"color-009",COLOR_010:"color-010"},a=(r={},(0,i._)(r,s.COLOR_001,{name:"White",rgb:"rgb(248,248,248)"}),(0,i._)(r,s.COLOR_002,{name:"Gray",rgb:"rgb(210,210,210)"}),(0,i._)(r,s.COLOR_003,{name:"Red",rgb:"rgb(240,155,143)"}),(0,i._)(r,s.COLOR_004,{name:"Orange",rgb:"rgb(240,191,148)"}),(0,i._)(r,s.COLOR_005,{name:"Yellow",rgb:"rgb(255,253,204)"}),(0,i._)(r,s.COLOR_006,{name:"Green",rgb:"rgb(159,219,169)"}),(0,i._)(r,s.COLOR_007,{name:"Teal",rgb:"rgb(159,224,219)"}),(0,i._)(r,s.COLOR_008,{name:"Blue",rgb:"rgb(148,198,235)"}),(0,i._)(r,s.COLOR_009,{name:"Violet",rgb:"rgb(191,169,235)"}),(0,i._)(r,s.COLOR_010,{name:"Pink",rgb:"rgb(235,148,199)"}),r)},14699:function(e,t,n){n.d(t,{R3:function(){return canvasActions},Xb:function(){return c},cj:function(){return l}});var r=n(21575),i=n(41369),s=n(43654),a=n(44313),o=n(60453),u=n(46095),d=n(27107),l={CREATE_CANVAS_SHAPE:"create-canvas-shape",UPDATE_CANVAS_SHAPE:"update-canvas-shape",DELETE_CANVAS_SHAPE:"delete-canvas-shape"},c={SAVE_WIREFRAME:"save-wireframe",GLOBAL_EDIT:"global-edit",SECTION_EDIT:"section-edit",SECTION_ADD:"section-add",MANUAL_EDIT:"manual-edit",USE_AS_CONTEXT:"use-as-context",USE_AS_SOURCE_CODE:"use-as-source-code",DELETE:"delete",PROMPT_HISTORY:"prompt-history",CHANGE_FONT:"change-font",EXPORT_WIREFRAME:"export-wireframe",MOVE_TO_PAGE:"move-to-page",SHARE_WIREFRAME:"share-wireframe",PREVIEW_WIREFRAME:"preview-wireframe",EXPORT_MULTIPLE_WIREFRAMES:"export-multiple-wireframes",MOVE_TO_PAGE_MULTIPLE_WIREFRAMES:"move-to-page-multiple-wireframes",SAVE_MULTIPLE_WIREFRAMES:"save-multiple-wireframes",CHANGE_FONT_MULTIPLE_WIREFRAMES:"change-font-multiple-wireframes",DELETE_MULTIPLE_WIREFRAMES:"delete-multiple-wireframes",TRANSFORM_WIREFRAME_TO_HI_FI:"transform-wireframe-to-hi-fi",DELETE_IMAGE:"delete-image",GENERATE_VARIATIONS:"generate-variations",CREATE_A_FLOW:"create-a-flow",GENERATE_PREDICTIVE_HEATMAP:"generate-predictive-heatmap",GENERATE_PROTOTYPE:"generate-prototype"},getToolbarActionsList=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[{id:c.GLOBAL_EDIT,kbd:"?g"},{id:c.SECTION_EDIT,kbd:"?s"},{id:c.SECTION_ADD,kbd:"?a"},{id:c.MANUAL_EDIT,kbd:"?m"},{id:c.USE_AS_SOURCE_CODE,kbd:"?c"},{id:c.PREVIEW_WIREFRAME,kbd:"?p"}].concat((0,a._)(e?[{id:c.USE_AS_CONTEXT,kbd:"?r"}]:[]),[{id:c.SAVE_WIREFRAME,kbd:"?b"},{id:c.PROMPT_HISTORY,kbd:"?h"},{id:c.CHANGE_FONT,kbd:"?f"},{id:c.EXPORT_WIREFRAME,kbd:"?e"},{id:c.MOVE_TO_PAGE,kbd:"?x"},{id:c.SHARE_WIREFRAME,kbd:"?l"},{id:c.DELETE,kbd:"backspace"},{id:c.TRANSFORM_WIREFRAME_TO_HI_FI,kbd:"?d"},{id:c.EXPORT_MULTIPLE_WIREFRAMES,kbd:"?e"},{id:c.MOVE_TO_PAGE_MULTIPLE_WIREFRAMES,kbd:"?x"},{id:c.SAVE_MULTIPLE_WIREFRAMES,kbd:"?b"},{id:c.CHANGE_FONT_MULTIPLE_WIREFRAMES,kbd:"?f"},{id:c.DELETE_MULTIPLE_WIREFRAMES,kbd:"backspace"},{id:c.GENERATE_VARIATIONS,kbd:"?o"},{id:c.CREATE_A_FLOW,kbd:"?w"},{id:c.GENERATE_PREDICTIVE_HEATMAP,kbd:"?j"},{id:c.GENERATE_PROTOTYPE,kbd:"?p"},{id:"override-copy",kbd:"$c"},{id:"override-cut",kbd:"$x"},{id:"override-paste",kbd:"$v"},{id:c.DELETE_IMAGE,kbd:"backspace"}])},p=["back-to-content","select-all","undo","redo","zoom-in","zoom-in-on-cursor","zoom-out","zoom-out-on-cursor","zoom-to-100","zoom-to-fit","zoom-to-selection"],canvasActions=function(e,t){var n=getToolbarActionsList((0,d.f)(u.GY.REFERENCE_FEATURE)).reduce(function(n,a){var u=a.id,d=a.kbd;return(0,s._)((0,i._)({},n),(0,r._)({},u,(0,s._)((0,i._)({},t[u]),{kbd:d,onSelect:function(){var t=e.getSelectedShapeIds();t.length>0&&(0,o.hb)(u,{selectedShapeIds:t})}})))},{}),a=p.reduce(function(e,n){return(0,s._)((0,i._)({},e),(0,r._)({},n,t[n]))},{});return(0,s._)((0,i._)({},a,n),{undo:(0,s._)((0,i._)({},t.undo),{onSelect:function(){}})})}},15680:function(e,t,n){n.d(t,{Cr:function(){return loadAssetsOnMount},Fe:function(){return removePreviewWireframeShapes},Hw:function(){return loadElementsOnMount},Sh:function(){return removeLoadingWireframeShape},W_:function(){return getTldrawGlobalEditor},gT:function(){return updateWireframeShape},jL:function(){return createLoadingWireframeShape},kU:function(){return createNewStickyNoteShape},qd:function(){return getIsFlowchartHydrating},wf:function(){return createNewWireframeShape},yw:function(){return addEventListeners}});var r=n(85063),i=n(56984),s=n(41369),a=n(43654),o=n(75104);n(86223);var u=n(74798),d=n(2497),l=n(35669),c=!1,setIsFlowchartHydrating=function(e){c=e},getIsFlowchartHydrating=function(){return c};function createNewWireframeShape(e,t){var n,r,i,s,a,o,u,d="shape:"+t.wireframeId,l=null==t?void 0:null===(n=t.dimensions)||void 0===n?void 0:n.width,c=null==t?void 0:null===(r=t.dimensions)||void 0===r?void 0:r.height,p={wireframeId:t.wireframeId,groupId:null==t?void 0:t.groupId,status:(null==t?void 0:t.status)||"generating",position:{x:null==t?void 0:null===(i=t.position)||void 0===i?void 0:i.x,y:null==t?void 0:null===(s=t.position)||void 0===s?void 0:s.y},w:l,h:c,name:null==t?void 0:t.title,color:"white",isPrototype:null!==(u=t.isPrototype)&&void 0!==u&&u};e.createShape({id:d,type:"frame",x:null==t?void 0:null===(a=t.position)||void 0===a?void 0:a.x,y:null==t?void 0:null===(o=t.position)||void 0===o?void 0:o.y,props:p,parentId:e.getCurrentPageId()})}function updateWireframeShape(e,t,n){var r,i,o,u,d,l=e.getShape(t);if(l&&"frame"===l.type){var c={wireframeId:null==n?void 0:n.wireframeId,status:(null==n?void 0:n.status)||"generating",name:n.title||l.props.name,w:(null==n?void 0:null===(r=n.dimensions)||void 0===r?void 0:r.width)||(null===(i=l.props)||void 0===i?void 0:i.w)||1440,h:(null==n?void 0:null===(o=n.dimensions)||void 0===o?void 0:o.height)||(null===(u=l.props)||void 0===u?void 0:u.h)||840,isPrototype:null!==(d=n.isPrototype)&&void 0!==d&&d};e.updateShape((0,a._)((0,s._)({},l),{props:(0,s._)({},c)}))}}function createNewStickyNoteShape(e,t){var n="shape:"+t.id;if((null==t?void 0:t.type)==="sticky-note")return e.createShape({id:n,type:t.type,x:t.props.position.x,y:t.props.position.y,parentId:e.getCurrentPageId(),props:{w:t.props.dimensions.width,h:t.props.dimensions.height,text:t.props.text||"",fontSize:t.props.fontSize||16,bold:t.props.bold||!1,italic:t.props.italic||!1,alignment:t.props.alignment||"left",color:t.props.color||u.A.COLOR_005,dimensions:t.props.dimensions,position:t.props.position,shapeId:t.id.includes("temp")?"":t.id}}),n}function addEventListeners(e){}var removePreviewWireframeShapes=function(e,t){var n=e.getCurrentPageShapes().filter(function(e){return t?"preview_shape"===e.type&&e.props.propId===t:"preview_shape"===e.type});e.deleteShapes(n.map(function(e){return e.id}))};function loadElementsOnMount(e,t,n,a,u,c){e.deleteShapes(Array.from(e.getCurrentPageShapeIds()));var p=new Map;n.forEach(function(e){p.set(e.id,e)});var f=0;t.forEach(function(t){var n,r=0,i=0;(n=t.wireframeIds,a?a.filter(function(e){return n.includes(e.mainScreen)}).map(function(e){return e.versionScreens.length>0?e.versionScreens[0].id:e.mainScreen}):[]).forEach(function(n){var s,a,o,u,m=p.get(n);if(m){var g=(null==m?void 0:null===(s=m.dimensions)||void 0===s?void 0:s[c])||(null==m?void 0:m.dimensions),h=null!==(o=null==m?void 0:null===(a=m.position)||void 0===a?void 0:a[c])&&void 0!==o?o:{x:r,y:f},v=(null==m?void 0:m.status)||"generating";createNewWireframeShape(e,{wireframeId:n,groupId:t.id,title:(null==m?void 0:m.screenTitle)||(null==m?void 0:m.prompt),dimensions:{width:(null==g?void 0:g.width)||1440,height:(null==g?void 0:g.height)||840},position:{x:null==h?void 0:h.x,y:null==h?void 0:h.y},status:v,isPrototype:null!==(u=m.isPrototype)&&void 0!==u&&u});var y=(null==g?void 0:g.width)||(0,l.A3)(null==m?void 0:m.useCase,null==m?void 0:m.width);i=Math.max(i,(null==g?void 0:g.height)||0),r+=y+((null==m?void 0:m.useCase)===d.ke.DESKTOPLEGACY||(null==m?void 0:m.useCase)===d.ke.DESKTOP||(null==m?void 0:m.useCase)===d.ke.DESKTOPHD||(null==m?void 0:m.useCase)===d.ke.TABLET?144:72)}}),f=f+i+500});var m=u.filter(function(e){return"sticky-note"===e.type}),g=u.filter(function(e){return"image"===e.type}),h=u.filter(function(e){return["flow-node"].includes(e.type)}),v=u.filter(function(e){var t;return"arrow"===e.type&&(null===(t=e.props)||void 0===t?void 0:t.typeName)==="shape"}),y=u.filter(function(e){var t;return(null===(t=e.props)||void 0===t?void 0:t.typeName)==="binding"});m.forEach(function(t){createNewStickyNoteShape(e,t)}),g.forEach(function(t){!function(e,t){var n,r,i,s,a="shape:"+t.id,o=t.props.assetId.includes("asset:")?t.props.assetId:"asset:".concat(t.props.assetId);if((null==t?void 0:t.type)==="image"){var u=(null===(n=t.props.dimensions)||void 0===n?void 0:n.width)||t.props.w,d=(null===(r=t.props.dimensions)||void 0===r?void 0:r.height)||t.props.h;if(!u||!d){console.error("Cannot create image shape without valid dimensions:",t);return}e.createShape({id:a,type:t.type,x:(null===(i=t.props.position)||void 0===i?void 0:i.x)||0,y:(null===(s=t.props.position)||void 0===s?void 0:s.y)||0,parentId:e.getCurrentPageId(),props:{w:u,h:d,assetId:o,shapeId:t.id}})}}(e,t)}),setIsFlowchartHydrating(!0);try{e.store.mergeRemoteChanges(function(){h.forEach(function(t){var n,r=null!==(n=t.props)&&void 0!==n?n:{},i=r.dimensions,a=r.position,u=(r.shapeId,r.typeName),d=r.fromId,l=r.toId,c=(0,o._)(r,["dimensions","position","shapeId","typeName","fromId","toId"]);e.createShape((0,s._)({id:t.id,type:t.type,x:(null==a?void 0:a.x)||0,y:(null==a?void 0:a.y)||0,parentId:e.getCurrentPageId(),props:(0,s._)({w:(null==i?void 0:i.width)||t.props.w||200,h:(null==i?void 0:i.height)||t.props.h||200},c),typeName:u},"binding"===u?{fromId:d,toId:l}:{}))}),v.forEach(function(t){var n,a,u,d=t.id,l=null!==(u=t.props)&&void 0!==u?u:{},c=(l.shapeId,l.typeName,l.fromId,l.toId,l.dimensions,l.position,(0,o._)(l,["shapeId","typeName","fromId","toId","dimensions","position"])),p=(0,r._)({},(0,i._)(c));e.createShape({id:d,type:t.type,x:(null===(n=t.props.position)||void 0===n?void 0:n.x)||0,y:(null===(a=t.props.position)||void 0===a?void 0:a.y)||0,parentId:e.getCurrentPageId(),props:(0,s._)({},p)})}),y.forEach(function(t){var n,r=null!==(n=t.props)&&void 0!==n?n:{},i=(r.shapeId,r.fromId),a=r.toId,u=r.typeName,d=(r.dimensions,r.position,(0,o._)(r,["shapeId","fromId","toId","typeName","dimensions","position"])),l=null!=d?d:{},c=(l.snap,(0,o._)(l,["snap"])),p={id:t.id,type:t.type,fromId:i,toId:a,props:(0,s._)({},c),typeName:u};"binding"===u&&e.createBindings([p])})})}finally{requestAnimationFrame(function(){setIsFlowchartHydrating(!1)})}if(e.getCurrentPageShapes().length>0){var w=e.getCurrentPageBounds();w&&setTimeout(function(){e.zoomToBounds(w,{inset:300,animation:{duration:300}})},0)}}function loadAssetsOnMount(e,t){var n=e.getAssets();e.deleteAssets(n.map(function(e){return e.id}));var r=t.map(function(e){var t=e.props||{};if(!t.src)return console.warn("Skipping asset ".concat(e.id," - missing src:"),t),null;var n=t.w,r=t.h;return n&&r||(console.warn("Asset ".concat(e.id," missing dimensions, using defaults")),n=1440,r=840),{id:"asset:".concat(e.id),type:"image",typeName:"asset",meta:{},props:{name:t.name||t.title||"image",src:t.src,w:n,h:r,isAnimated:t.isAnimated||!1,mimeType:t.mimeType||"image/png",fileSize:t.fileSize&&t.fileSize>0?t.fileSize:1}}}).filter(Boolean);r.length>0&&e.createAssets(r)}var getTldrawGlobalEditor=function(){var e;return window&&(null===(e=window)||void 0===e?void 0:e.editor)?window.editor:null};function createLoadingWireframeShape(e,t){var n,r,i,s,a="shape:"+t.wireframeId,o=null==t?void 0:null===(n=t.dimensions)||void 0===n?void 0:n.width,u=null==t?void 0:null===(r=t.dimensions)||void 0===r?void 0:r.height,d={wireframeId:t.wireframeId,w:o,h:u,useCase:t.useCase};return e.createShape({id:a,type:"loading_wireframe",x:null==t?void 0:null===(i=t.position)||void 0===i?void 0:i.x,y:null==t?void 0:null===(s=t.position)||void 0===s?void 0:s.y,props:d,parentId:e.getCurrentPageId()}),a}function removeLoadingWireframeShape(e,t){e.deleteShape("shape:"+t)}},78906:function(e,t,n){n.d(t,{T3:function(){return extractVersionGroups},_O:function(){return sortByOrderAndDate},c2:function(){return wireframesToVersionGroups}});var r=n(41369),i=n(43654),s=n(44313);function sortByOrderAndDate(e){return e.sort(function(e,t){var n,r,i=null!==(n=e.order)&&void 0!==n?n:1/0,s=null!==(r=t.order)&&void 0!==r?r:1/0;return i!==s?i-s:new Date(t.date).getTime()-new Date(e.date).getTime()})}function extractVersionGroups(e){var t=new Map;return e.forEach(function(e){e.wireframes.forEach(function(e){if(t.has(e.id)){var n=t.get(e.id);new Date(e.date)>new Date(n.date)&&t.set(e.id,e)}else t.set(e.id,e)})}),wireframesToVersionGroups(Array.from(t.values()))}function wireframesToVersionGroups(e){var t=new Map,n=[];e.forEach(function(e){t.set(e.id,(0,i._)((0,r._)({},e),{children:[]}))}),e.forEach(function(e){if(e.parentId){var r=t.get(e.parentId);r?r.children.push(t.get(e.id)):n.push(t.get(e.id))}else n.push(t.get(e.id))});var a=[];return n.forEach(function(e){a.push(function(e){for(var t=[],n=[e];n.length;){var r=n.shift();t.push({id:r.id,parentId:r.parentId,order:r.order,date:r.date}),n.push.apply(n,(0,s._)(r.children))}return sortByOrderAndDate(t)}(e))}),a.map(function(e){var t=e.find(function(t){return null===t.parentId||void 0===t.parentId||!e.some(function(e){return e.id===t.parentId})}),n=e.filter(function(t){return null!==t.parentId&&void 0!==t.parentId&&e.some(function(e){return e.id===t.parentId})}).sort(function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()});return{versionScreens:n,mainScreen:t.id,expanded:!1,currentVisible:n.length>0?n[0].id:t.id,order:t.order,date:t.date}})}},35669:function(e,t,n){n.d(t,{A3:function(){return getWireframeWidth},Mi:function(){return getWireframeDefaultDimensions},ds:function(){return isDesktopDevice},jv:function(){return getWireframeHeight},rh:function(){return checkWireframeStatus},s2:function(){return isMobileDevice}});var r=n(2497),checkWireframeStatus=function(e){return(null==e?void 0:e.error)?"failed":((null==e?void 0:e.isLoading)||(null==e?void 0:e.status)||(null==e?void 0:e.status)==="generating")&&!e.wireframeOutputHtml?"generating":"completed"},getWireframeDefaultDimensions=function(e,t,n){return t&&n?{width:t,height:n}:e===r.ke.MOBILE||e===r.ke.MOBILELEGACY?{width:375,height:840}:e===r.ke.DESKTOPHD?{width:1920,height:1080}:e===r.ke.TABLET?{width:1024,height:1366}:(e===r.ke.DESKTOP||r.ke.DESKTOPLEGACY,{width:1440,height:1024})},getWireframeWidth=function(e,t){return t||getWireframeDefaultDimensions(e).width},getWireframeHeight=function(e,t){return t||getWireframeDefaultDimensions(e).height},isDesktopDevice=function(e){return!!e&&(e===r.ke.DESKTOP||e===r.ke.DESKTOPHD||e===r.ke.DESKTOPLEGACY)},isMobileDevice=function(e){return!!e&&(e===r.ke.MOBILE||e===r.ke.MOBILELEGACY)}},11776:function(e,t,n){n.d(t,{Z:function(){return DesktopIcon}});var r=n(57437),i=n(57042);function DesktopIcon(e){var t=e.className;return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",className:(0,i.Z)("text-carbon-700",t),children:(0,r.jsx)("path",{d:"M15.8332 1.66663H4.1665C3.50346 1.66663 2.86758 1.93002 2.39874 2.39886C1.9299 2.8677 1.6665 3.50358 1.6665 4.16663V12.5C1.6665 13.163 1.9299 13.7989 2.39874 14.2677C2.86758 14.7366 3.50346 15 4.1665 15H6.6665V16.6666H4.1665C3.94549 16.6666 3.73353 16.7544 3.57725 16.9107C3.42097 17.067 3.33317 17.2789 3.33317 17.5C3.33317 17.721 3.42097 17.9329 3.57725 18.0892C3.73353 18.2455 3.94549 18.3333 4.1665 18.3333H15.8332C16.0542 18.3333 16.2661 18.2455 16.4224 18.0892C16.5787 17.9329 16.6665 17.721 16.6665 17.5C16.6665 17.2789 16.5787 17.067 16.4224 16.9107C16.2661 16.7544 16.0542 16.6666 15.8332 16.6666H13.3332V15H15.8332C16.4962 15 17.1321 14.7366 17.6009 14.2677C18.0698 13.7989 18.3332 13.163 18.3332 12.5V4.16663C18.3332 3.50358 18.0698 2.8677 17.6009 2.39886C17.1321 1.93002 16.4962 1.66663 15.8332 1.66663ZM11.6665 16.6666H8.33317V15H11.6665V16.6666ZM16.6665 12.5C16.6665 12.721 16.5787 12.9329 16.4224 13.0892C16.2661 13.2455 16.0542 13.3333 15.8332 13.3333H4.1665C3.94549 13.3333 3.73353 13.2455 3.57725 13.0892C3.42097 12.9329 3.33317 12.721 3.33317 12.5V11.6666H16.6665V12.5ZM16.6665 9.99996H3.33317V4.16663C3.33317 3.94561 3.42097 3.73365 3.57725 3.57737C3.73353 3.42109 3.94549 3.33329 4.1665 3.33329H15.8332C16.0542 3.33329 16.2661 3.42109 16.4224 3.57737C16.5787 3.73365 16.6665 3.94561 16.6665 4.16663V9.99996Z",fill:"#606067"})})}n(2265)},11070:function(e,t,n){n.d(t,{Z:function(){return MobileAppIcon}});var r=n(57437),i=n(57042);function MobileAppIcon(e){var t=e.className;return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"14",viewBox:"0 0 10 14",fill:"none",className:(0,i.Z)("text-carbon-800",t),children:(0,r.jsx)("path",{d:"M5.80666 9.86L5.70666 9.78C5.66949 9.75477 5.62914 9.7346 5.58666 9.72L5.46666 9.66667C5.35854 9.64407 5.2465 9.64868 5.14061 9.6801C5.03471 9.71152 4.93829 9.76876 4.85999 9.84667C4.8011 9.91147 4.75375 9.98588 4.71999 10.0667C4.66954 10.1881 4.65614 10.3218 4.68149 10.4509C4.70684 10.5799 4.76981 10.6986 4.86245 10.792C4.9551 10.8853 5.0733 10.9492 5.20216 10.9756C5.33103 11.0019 5.46481 10.9895 5.58666 10.94C5.66632 10.9013 5.74034 10.852 5.80666 10.7933C5.89916 10.6996 5.96183 10.5805 5.98674 10.4512C6.01166 10.3219 5.99771 10.1881 5.94666 10.0667C5.91342 9.98958 5.86592 9.91946 5.80666 9.86ZM7.99999 0.333336H2.66666C2.13622 0.333336 1.62752 0.54405 1.25244 0.919122C0.87737 1.2942 0.666656 1.8029 0.666656 2.33334V11.6667C0.666656 12.1971 0.87737 12.7058 1.25244 13.0809C1.62752 13.456 2.13622 13.6667 2.66666 13.6667H7.99999C8.53042 13.6667 9.03913 13.456 9.4142 13.0809C9.78928 12.7058 9.99999 12.1971 9.99999 11.6667V2.33334C9.99999 1.8029 9.78928 1.2942 9.4142 0.919122C9.03913 0.54405 8.53042 0.333336 7.99999 0.333336ZM8.66666 11.6667C8.66666 11.8435 8.59642 12.0131 8.4714 12.1381C8.34637 12.2631 8.1768 12.3333 7.99999 12.3333H2.66666C2.48985 12.3333 2.32028 12.2631 2.19525 12.1381C2.07023 12.0131 1.99999 11.8435 1.99999 11.6667V2.33334C1.99999 2.15652 2.07023 1.98696 2.19525 1.86193C2.32028 1.73691 2.48985 1.66667 2.66666 1.66667H7.99999C8.1768 1.66667 8.34637 1.73691 8.4714 1.86193C8.59642 1.98696 8.66666 2.15652 8.66666 2.33334V11.6667Z",fill:"currentColor"})})}n(2265)},68232:function(e,t,n){n.d(t,{Sw:function(){return r},cU:function(){return getCreditPackages},eg:function(){return o},gF:function(){return i}});var r={WIREFRAMES_10:2,WIREFRAMES_20:6,UI_00:2,UI_10:12,UI_20:6,HEATMAP_10:2,UXREVIEW_10:1},i={review:{value:"review",label:"UX Review 1.0",credits:r.UXREVIEW_10,copy:"To review designs, it'd cost you ".concat(r.UXREVIEW_10," token per screen")},heatmap:{value:"heatmap",label:"Heatmap 1.0",credits:r.HEATMAP_10,copy:"To generate heatmaps, it'd cost you ".concat(r.HEATMAP_10," tokens per screen")},wireframe10:{value:"wireframe",label:"Wireframe 1.0",credits:r.WIREFRAMES_10,copy:"To generate wireframes version 1, it will cost you ".concat(r.WIREFRAMES_10)},wireframe20:{value:"wireframe",label:"Wireframe 2.0",credits:r.WIREFRAMES_20,copy:"To generate wireframes version 2, it will cost you ".concat(r.WIREFRAMES_20)},ui00:{value:"ui",label:"Basic UI 1.0",credits:r.UI_00,copy:"To generate basic UI designs, it will cost you ".concat(r.UI_00)},ui10:{value:"ui",label:"Standard Design System",credits:r.UI_20,copy:"To generate advanced UI designs, it will cost you ".concat(r.UI_10)},ui20:{value:"ui",label:"Flowbite Design System",credits:r.UI_10,copy:"To generate flowbite UI designs, it will cost you ".concat(r.UI_20)},uxreview10:{value:"uxreview",label:"UX Review 1.0",credits:r.UXREVIEW_10,copy:"To get a UX review, it will cost you ".concat(r.UXREVIEW_10," per screen")}},s=[{credits:360,price:3.5,originalPrice:4},{credits:720,price:7,originalPrice:8},{credits:1440,price:14,originalPrice:16},{credits:2880,price:28,originalPrice:32}],a=[{credits:360,price:18,originalPrice:18},{credits:720,price:34,originalPrice:34},{credits:1440,price:63,originalPrice:63},{credits:2880,price:118,originalPrice:118}];function getCreditPackages(e){return"extra_credits_pricing_hike"===e?a:s}var o=[{credits:11520,price:116,originalPrice:112},{credits:5760,price:60,originalPrice:56}]},2497:function(e,t,n){n.d(t,{ke:function(){return i},br:function(){return c},Ne:function(){return l},Yi:function(){return d}});var r,i,s=n(57437),a=n(57042);n(2265);var o=n(11776),u=n(11070);(r=i||(i={})).DESKTOP="desktop (1440x1024)",r.DESKTOPHD="desktop-hd (1920x1080)",r.TABLET="tablet (1024x1366)",r.MOBILE="mobile (375x840)",r.DESKTOPLEGACY="desktop",r.MOBILELEGACY="mobile";var d=[{value:"desktop (1440x1024)",label:"Desktop",icon:o.Z,screenSize:"1440 x 1024",disabled:!1},{value:"desktop-hd (1920x1080)",label:"Desktop HD",icon:function(e){var t=e.className;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18",fill:"none",className:(0,a.Z)("text-carbon-800",t),children:(0,s.jsx)("path",{d:"M14.8337 0.666626H3.16699C2.50395 0.666626 1.86807 0.930018 1.39923 1.39886C0.930384 1.8677 0.666992 2.50358 0.666992 3.16663V11.5C0.666992 12.163 0.930384 12.7989 1.39923 13.2677C1.86807 13.7366 2.50395 14 3.16699 14H5.66699V15.6666H3.16699C2.94598 15.6666 2.73402 15.7544 2.57774 15.9107C2.42146 16.067 2.33366 16.2789 2.33366 16.5C2.33366 16.721 2.42146 16.9329 2.57774 17.0892C2.73402 17.2455 2.94598 17.3333 3.16699 17.3333H14.8337C15.0547 17.3333 15.2666 17.2455 15.4229 17.0892C15.5792 16.9329 15.667 16.721 15.667 16.5C15.667 16.2789 15.5792 16.067 15.4229 15.9107C15.2666 15.7544 15.0547 15.6666 14.8337 15.6666H12.3337V14H14.8337C15.4967 14 16.1326 13.7366 16.6014 13.2677C17.0703 12.7989 17.3337 12.163 17.3337 11.5V3.16663C17.3337 2.50358 17.0703 1.8677 16.6014 1.39886C16.1326 0.930018 15.4967 0.666626 14.8337 0.666626ZM10.667 15.6666H7.33366V14H10.667V15.6666ZM15.667 11.5C15.667 11.721 15.5792 11.9329 15.4229 12.0892C15.2666 12.2455 15.0547 12.3333 14.8337 12.3333H3.16699C2.94598 12.3333 2.73402 12.2455 2.57774 12.0892C2.42146 11.9329 2.33366 11.721 2.33366 11.5V10.6666H15.667V11.5ZM15.667 8.99996H2.33366V3.16663C2.33366 2.94561 2.42146 2.73365 2.57774 2.57737C2.73402 2.42109 2.94598 2.33329 3.16699 2.33329H14.8337C15.0547 2.33329 15.2666 2.42109 15.4229 2.57737C15.5792 2.73365 15.667 2.94561 15.667 3.16663V8.99996Z",fill:"#495057"})})},screenSize:"1920 x 1080",disabled:!1},{value:"tablet (1024x1366)",label:"Tablet",icon:function(e){var t=e.className;return(0,s.jsx)("svg",{width:"14",height:"17",viewBox:"0 0 14 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,a.Z)("text-carbon-800",t),children:(0,s.jsx)("path",{d:"M10.8333 0H2.5C1.83696 0 1.20107 0.263392 0.732233 0.732233C0.263392 1.20107 0 1.83696 0 2.5V14.1667C0 14.8297 0.263392 15.4656 0.732233 15.9344C1.20107 16.4033 1.83696 16.6667 2.5 16.6667H10.8333C11.4964 16.6667 12.1323 16.4033 12.6011 15.9344C13.0699 15.4656 13.3333 14.8297 13.3333 14.1667V2.5C13.3333 1.83696 13.0699 1.20107 12.6011 0.732233C12.1323 0.263392 11.4964 0 10.8333 0ZM11.6667 14.1667C11.6667 14.3877 11.5789 14.5996 11.4226 14.7559C11.2663 14.9122 11.0543 15 10.8333 15H2.5C2.27899 15 2.06702 14.9122 1.91074 14.7559C1.75446 14.5996 1.66667 14.3877 1.66667 14.1667V2.5C1.66667 2.27899 1.75446 2.06702 1.91074 1.91074C2.06702 1.75446 2.27899 1.66667 2.5 1.66667H10.8333C11.0543 1.66667 11.2663 1.75446 11.4226 1.91074C11.5789 2.06702 11.6667 2.27899 11.6667 2.5V14.1667ZM7.25833 11.9083C7.16212 11.808 7.04233 11.7333 6.90988 11.6911C6.77743 11.6489 6.63653 11.6405 6.5 11.6667L6.35 11.7167C6.2969 11.7349 6.24645 11.7601 6.2 11.7917L6.075 11.8917C5.99913 11.9709 5.93966 12.0644 5.9 12.1667C5.83618 12.3184 5.81875 12.4857 5.84989 12.6473C5.88104 12.809 5.95937 12.9578 6.075 13.075C6.1579 13.1483 6.25042 13.21 6.35 13.2583C6.50255 13.3211 6.6703 13.3372 6.832 13.3046C6.9937 13.2719 7.14208 13.192 7.25833 13.075C7.41028 12.9218 7.49691 12.7157 7.5 12.5C7.50282 12.3907 7.47998 12.2822 7.43333 12.1833C7.39113 12.0823 7.33194 11.9893 7.25833 11.9083V11.9083Z",fill:"#606067"})})},screenSize:"1024 x 1366",disabled:!1},{value:"mobile (375x840)",label:"Mobile",icon:u.Z,screenSize:"375 x 840",disabled:!1}],l=[{value:"wireframe",label:"Wireframes",tooltip:"Basic, structural layouts in black & white",icon:function(e){var t=e.className;return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,a.Z)("text-carbon-700",t),children:(0,s.jsx)("path",{d:"M13 0.333374H1.00001C0.823199 0.333374 0.65363 0.403612 0.528606 0.528636C0.403581 0.65366 0.333344 0.82323 0.333344 1.00004V13C0.333344 13.1769 0.403581 13.3464 0.528606 13.4714C0.65363 13.5965 0.823199 13.6667 1.00001 13.6667H13C13.1768 13.6667 13.3464 13.5965 13.4714 13.4714C13.5964 13.3464 13.6667 13.1769 13.6667 13V1.00004C13.6667 0.82323 13.5964 0.65366 13.4714 0.528636C13.3464 0.403612 13.1768 0.333374 13 0.333374ZM4.33334 12.3334H1.66668V1.66671H4.33334V12.3334ZM12.3333 12.3334H5.66668V7.66671H12.3333V12.3334ZM12.3333 6.33337H5.66668V1.66671H12.3333V6.33337Z",fill:"currentColor"})})}},{value:"hifi",label:"Hifi Designs",tooltip:"Polished, detailed designs with full color and visual styling",icon:function(e){var t=e.className;return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,a.Z)(t),children:[(0,s.jsx)("path",{d:"M1.29999 1.89995C1.29999 1.51335 1.61339 1.19995 1.99999 1.19995H6.09999V14.6H1.99999C1.61339 14.6 1.29999 14.2866 1.29999 13.9V1.89995Z",fill:"#3F20FB"}),(0,s.jsx)("path",{d:"M6.10001 1.19995H14C14.3866 1.19995 14.7 1.51335 14.7 1.89995V7.89995H6.10001V1.19995Z",fill:"#FFD966"}),(0,s.jsx)("path",{d:"M6.10001 7.90002H14.7V13.9C14.7 14.2866 14.3866 14.6 14 14.6H6.10001V7.90002Z",fill:"#F0859F"})]})}}],c={DESKTOP:"desktop (1440x1024)",DESKTOPHD:"desktop-hd (1920x1080)",TABLET:"tablet (1024x1366)",MOBILE:"mobile (375x840)",DESKTOPLEGACY:"desktop",MOBILELEGACY:"mobile"}},83683:function(e,t,n){n.r(t),n.d(t,{ActionModalProvider:function(){return ActionModalProvider},useActionModal:function(){return useActionModal}});var r=n(9),i=n(57437),s=n(2265),a=(0,s.createContext)(void 0);function useActionModal(){var e=(0,s.useContext)(a);if(void 0===e)throw Error("useActionModal must be used within an ActionModalProvider");return e}var ActionModalProvider=function(e){var t=e.children,n=(0,r._)((0,s.useState)(!1),2),o=n[0],u=n[1],d=(0,r._)((0,s.useState)(""),2),l=d[0],c=d[1],p=(0,r._)((0,s.useState)(null),2),f=p[0],m=p[1],g=(0,r._)((0,s.useState)(null),2),h=g[0],v=g[1];return(0,i.jsx)(a.Provider,{value:{isOpen:o,modalTitle:l,children:f,onClose:h,openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,n=void 0===t?"Action Required":t,r=e.children,i=void 0===r?null:r,s=e.onClose,a=void 0===s?null:s;u(!0),c(n),m(i),v(function(){return a})},closeModal:function(){u(!1),c(""),m(null),v(null)}},children:t})}},19676:function(e,t,n){n.d(t,{MM:function(){return c},Sz:function(){return useSidebarContext},ft:function(){return SidebarContextProvider}});var r=n(9),i=n(57437),s=n(2265),a=n(79398),o=n(46095),u=n(4392),d=n(29467),l=n(82469),c={V1:"v1",V2:"v2"},p=(0,s.createContext)({sidebarVersion:c.V2,setSidebarVersion:function(){},toggleSidebarVersion:function(){}}),useSidebarContext=function(){return(0,s.useContext)(p)};function SidebarContextProvider(e){var t=e.children,n=(0,r._)((0,s.useState)(c.V2),2),f=n[0],m=n[1],g=(0,r._)((0,s.useState)(!1),2),h=g[0],v=g[1],y=(0,a.z)(),w=(0,u.aC)().userInfo,S=(0,d.j)(),_=S.experiments,I=S.isVariant;(0,s.useEffect)(function(){if(w&&_&&_[l.YN.UXP_60]&&!h){v(!0);var e=localStorage.getItem("sidebarVersion"),t=c.V2;m(t),e||localStorage.setItem("sidebarVersion",t),y.capture(o.Je.PAGE_VIEWED,{current_sidebar_version:t,timestamp:Date.now(),email:null==w?void 0:w.email})}},[w,y,_,I,h]);var setSidebarVersion=function(e){if(e!==c.V1&&e!==c.V2){console.error("Invalid sidebar version:",e);return}f!==e&&y.capture(o.Je.SIDEBAR_VERSION_TOGGLED,{current_sidebar_version:e,timestamp:Date.now(),email:null==w?void 0:w.email}),localStorage.setItem("sidebarVersion",e),m(e)};return(0,i.jsx)(p.Provider,{value:{sidebarVersion:f,setSidebarVersion:setSidebarVersion,toggleSidebarVersion:function(){setSidebarVersion(f===c.V1?c.V2:c.V1)}},children:t})}},83438:function(e,t,n){var r=n(45610),i=n(9),s=n(50044),a=n(2265),o="cacheStore";function openDB(){return _openDB.apply(this,arguments)}function _openDB(){return(_openDB=(0,r._)(function(){return(0,s.Jh)(this,function(e){return[2,new Promise(function(e,t){var n=indexedDB.open("cacheDB",1);n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(o)||t.createObjectStore(o)},n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){t(e.target.error)}})]})})).apply(this,arguments)}function _getItem(){return(_getItem=(0,r._)(function(e){var t;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,openDB()];case 1:return t=n.sent(),[2,new Promise(function(n,r){var i=t.transaction(o,"readonly").objectStore(o).get(e);i.onsuccess=function(e){n(e.target.result)},i.onerror=function(e){r(e.target.error)}})];case 2:return console.error("Failed to open DB for getItem",n.sent()),[3,3];case 3:return[2]}})})).apply(this,arguments)}function _setItem(){return(_setItem=(0,r._)(function(e,t){var n;return(0,s.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,openDB()];case 1:return n=r.sent(),[2,new Promise(function(r,i){var s=n.transaction(o,"readwrite").objectStore(o).put(t,e);s.onsuccess=function(){r()},s.onerror=function(e){i(e.target.error)}})];case 2:return console.error("Failed to open DB for setItem",r.sent()),[3,3];case 3:return[2]}})})).apply(this,arguments)}t.Z=function(e,t){var n=(0,i._)((0,a.useState)(t),2),o=n[0],u=n[1];return(0,a.useEffect)(function(){function _loadData(){return(_loadData=(0,r._)(function(){var t;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,function(e){return _getItem.apply(this,arguments)}(e)];case 1:return void 0!==(t=n.sent())&&u(t),[3,3];case 2:return console.error("Failed to load data from IndexedDB",n.sent()),[3,3];case 3:return[2]}})})).apply(this,arguments)}!function(){_loadData.apply(this,arguments)}()},[e]),(0,a.useEffect)(function(){function _saveData(){return(_saveData=(0,r._)(function(){return(0,s.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,3,,4]),!(void 0!==o))return[3,2];return[4,function(e,t){return _setItem.apply(this,arguments)}(e,o)];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return console.error("Failed to save data to IndexedDB",t.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}!function(){_saveData.apply(this,arguments)}()},[e,o]),[o,u]}},36061:function(e,t,n){n.d(t,{U:function(){return useModalControl}});var r=n(25414);function useModalControl(){var e=(0,r.useModal)();return{openModal:e.openModal,closeModal:e.closeModal}}},52997:function(e,t,n){n.d(t,{Ad:function(){return r.Ad},At:function(){return r.At},Av:function(){return d.Av},Dr:function(){return r.Dr},G7:function(){return r.G7},H1:function(){return s.H1},Jo:function(){return a.Jo},KR:function(){return i.KR},L1:function(){return a.L1},L_:function(){return a.L_},N1:function(){return a.N1},NF:function(){return a.NF},PR:function(){return r.PR},Qu:function(){return l.Qu},TY:function(){return i.TY},Tm:function(){return l.Tm},UC:function(){return r.UC},Us:function(){return i.Us},Wu:function(){return u.Wu},Zt:function(){return d.Zt},aG:function(){return o.aG},cq:function(){return u.cq},cr:function(){return a.cr},g$:function(){return s.g$},iC:function(){return l.iC},iK:function(){return r.iK},ic:function(){return d.ic},jw:function(){return a.jw},lT:function(){return a.lT},lj:function(){return a.lj},mj:function(){return r.mj},mm:function(){return i.mm},mp:function(){return s.mp},mv:function(){return u.mv},nY:function(){return l.nY},og:function(){return d.og},qV:function(){return s.qV},s3:function(){return a.s3},su:function(){return u.su},t7:function(){return r.t7},wy:function(){return a.wy},yk:function(){return s.yk},z6:function(){return u.jv},zV:function(){return r.zV}});var r=n(60659),i=n(52477),s=n(16972),a=n(36902),o=n(93629),u=n(52893);n(55024);var d=n(82924),l=n(61841)}}]);