"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{38597:function(e){e.exports={URLS:{streamUrl:"https://stream.uxpilot.ai",authFuncUrl:"https://us-central1-uxpilot-auth.cloudfunctions.net",kbUrl:"https://kb.uxpilot.ai"},isProd:!0,isDev:!1,isLocal:!1,FEATURE_FLAGS:{L1_GENERATION:!1}}},30791:function(e,r,t){t.d(r,{I8:function(){return s},tO:function(){return i}}),t(12075),t(648),t(61708);var n=t(78199),o=t(24086);n.Z.apps.length||n.Z.initializeApp({apiKey:"AIzaSyBvx3L1jW-Q53bHwZc22SZUufdXhxeWbwc",authDomain:"uxpilot-auth.firebaseapp.com",projectId:"uxpilot-auth",storageBucket:"uxpilot-auth.appspot.com",messagingSenderId:"485825078314",appId:"1:485825078314:web:b742b234195e58f8b74f53"});var a=n.Z.firestore(),s=n.Z.auth(),i=n.Z.storage();a.settings({cacheSizeBytes:o.IX,merge:!0}),a.enablePersistence({synchronizeTabs:!0}).catch(function(e){"failed-precondition"===e.code?console.warn("Firebase persistence unavailable - multiple tabs open"):"unimplemented"===e.code&&console.warn("Firebase persistence not supported in this browser")}),r.ZP=n.Z},60453:function(e,r,t){t.d(r,{hb:function(){return dispatchCustomEvent},zW:function(){return o}});var n=t(2265),o={wireframesData:"wireframesData",groupsData:"groupsData",userInfo:"userInfo",exportGroupWireframe:"exportGroupWireframe",saveGroupWireframe:"saveGroupWireframe",unsaveWireframe:"unsaveWireframe",saveWireframe:"saveWireframe",syncing:"syncing",onboardingCompleted:"onboardingCompleted",pageDeleted:"pageDeleted",userInfoData:"userInfoData",panningEnabled:"panningEnabled",panningDisabled:"panningDisabled",sessionExpired:"login",googleSignIn:"googleSignIn",googleOneTabResponse:"googleOneTabResponse",openCreatePageModal:"openCreatePageModal",saveTextChanges:"saveTextChanges",discardTextChanges:"discardTextChanges",refreshSavedWireframes:"refreshSavedWireframes",unSaveWireframeFromToolbar:"unSaveWireframeFromToolbar",itemAttachedWithContext:"itemAttachedWithContext",chatStreaming:"chatStreaming",chatActiveConversationUpdated:"chatActiveConversationUpdated",toggleSavedDesignsPanel:"toggleSavedDesignsPanel",leftPanelWidthChanged:"leftPanelWidthChanged",generateDeviceVersion:"generateDeviceVersion"};r.ZP=function(e,r){var t=(0,n.useCallback)(function(e){r(e.detail)},[r]);(0,n.useEffect)(function(){return document.addEventListener(e,t),function(){document.removeEventListener(e,t)}},[e,t])};var dispatchCustomEvent=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=new CustomEvent(e,{detail:r});document.dispatchEvent(t)}},84172:function(e,r,t){t.d(r,{Tg:function(){return c},bf:function(){return u},f3:function(){return i},kM:function(){return s},lZ:function(){return a}});var n,o=t(21575),a={GET_USER_DATA:"get-user-data",ADD_USER:"add-user-data",ADD_TO_AC:"add-to-ac",IPIFY:"https://api.ipify.org?format=json",UPDATE_USER_PROFILE:"update-user-profile",UPDATE_USER_DATA:"update-user-data",DELETE_USER_DATA:"delete-user-data",CAN_ADD_USER:"can-add-user",WORKOS_CHECK_DOMAIN:"workos/auth/check-domain",WORKOS_CALLBACK:"workos/auth/callback"},s={EMAIL_ALREADY_IN_USE:"auth/email-already-in-use",INVALID_EMAIL:"auth/invalid-email",USER_NOT_FOUND:"auth/user-not-found",WRONG_PASSWORD:"auth/wrong-password",WEAK_PASSWORD:"auth/weak-password",REQUIRES_RECENT_LOGIN:"auth/requires-recent-login",TOO_MANY_REQUESTS:"auth/too-many-requests",EMAIL_NOT_VERIFIED:"auth/email-not-verified",EXPIRED_ACTION_CODE:"auth/expired-action-code",INVALID_ACTION_CODE:"auth/invalid-action-code",USER_DISABLED:"auth/user-disabled",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",INVALID_CREDENTIAL:"auth/invalid-credential",ACCOUNT_EXISTS_WITH_DIFFERENT_CREDENTIAL:"auth/account-exists-with-different-credential",WORKOS_DOMAIN_NOT_FOUND:"workos/domain-not-found",WORKOS_INVALID_TOKEN:"workos/invalid-token",WORKOS_TOKEN_EXPIRED:"workos/token-expired",WORKOS_REFRESH_FAILED:"workos/refresh-failed",WORKOS_UNAUTHORIZED:"workos/unauthorized",WORKOS_SSO_FAILED:"workos/sso-failed",WORKOS_USER_NOT_FOUND:"workos/user-not-found",WORKOS_INVALID_STATE:"workos/invalid-state",WORKOS_CONNECTION_ERROR:"workos/connection-error"},i=(n={},(0,o._)(n,s.EMAIL_ALREADY_IN_USE,"This email is already registered. Please use sign in to your existing account."),(0,o._)(n,s.INVALID_EMAIL,"Please enter a valid email address."),(0,o._)(n,s.USER_NOT_FOUND,"No account found with this email address."),(0,o._)(n,s.WRONG_PASSWORD,"Invalid email or password."),(0,o._)(n,s.WEAK_PASSWORD,"Password is too weak. Please choose a stronger password."),(0,o._)(n,s.REQUIRES_RECENT_LOGIN,"This action requires recent authentication. Please log in again before retrying."),(0,o._)(n,s.TOO_MANY_REQUESTS,"Too many login attempts. Please try again later."),(0,o._)(n,s.EMAIL_NOT_VERIFIED,"Please verify your email to continue."),(0,o._)(n,s.EXPIRED_ACTION_CODE,"This link has expired. Please request a new one."),(0,o._)(n,s.INVALID_ACTION_CODE,"This link is invalid or has already been used."),(0,o._)(n,s.USER_DISABLED,"This account has been disabled. Please contact support."),(0,o._)(n,s.CREDENTIAL_ALREADY_IN_USE,"This credential is already associated with another account."),(0,o._)(n,s.INVALID_CREDENTIAL,"Invalid email or password."),(0,o._)(n,s.ACCOUNT_EXISTS_WITH_DIFFERENT_CREDENTIAL,"An account already exists with this email. Please sign in with your password first, then link your Google account from Account Settings."),n),u={FIREBASE:"firebase",WORKOS:"workos"},c={WORKOS_ACCESS_TOKEN:"workos_access_token",WORKOS_REFRESH_TOKEN:"workos_refresh_token",WORKOS_TOKEN_EXPIRY:"workos_token_expiry",AUTH_TYPE:"auth_type"}},10649:function(e,r,t){t.d(r,{BB:function(){return clearWorkOSTokens},Gl:function(){return W},KT:function(){return p},Rl:function(){return A},eC:function(){return getAuthType},eJ:function(){return storeWorkOSTokens},hd:function(){return m}});var n,o,a,s,i,u,c,l,f=t(45610),h=t(86453),E=t(50044),_=t(38597),d=t(30791),T=t(60453),S=t(84172),O=null,g=null,getWorkOSTokenData=function(){try{var e=localStorage.getItem(S.Tg.WORKOS_ACCESS_TOKEN),r=localStorage.getItem(S.Tg.WORKOS_REFRESH_TOKEN);if(!e||!r)return null;return{accessToken:e,refreshToken:r,tokenType:"Bearer"}}catch(e){return console.error("[AUTH] Error retrieving WorkOS tokens:",e),null}},clearWorkOSTokens=function(){localStorage.removeItem(S.Tg.WORKOS_ACCESS_TOKEN),localStorage.removeItem(S.Tg.WORKOS_REFRESH_TOKEN),localStorage.removeItem(S.Tg.WORKOS_TOKEN_EXPIRY),localStorage.removeItem(S.Tg.AUTH_TYPE)},I=(n=(0,f._)(function(){return(0,E.Jh)(this,function(e){switch(e.label){case 0:if(e.trys.push([0,3,,4]),localStorage.removeItem(S.Tg.AUTH_TYPE),!d.I8.currentUser)return[3,2];return[4,d.I8.signOut()];case 1:e.sent(),e.label=2;case 2:return[3,4];case 3:return console.error("[AUTH] Error clearing Firebase tokens:",e.sent()),[3,4];case 4:return[2]}})}),function(){return n.apply(this,arguments)}),storeWorkOSTokens=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3600;if(!e||!r){console.error("[AUTH] Cannot store WorkOS tokens: missing required tokens");return}var n=Date.now()+1e3*t;try{localStorage.setItem(S.Tg.WORKOS_ACCESS_TOKEN,e),localStorage.setItem(S.Tg.WORKOS_REFRESH_TOKEN,r),localStorage.setItem(S.Tg.WORKOS_TOKEN_EXPIRY,n.toString()),localStorage.setItem(S.Tg.AUTH_TYPE,S.bf.WORKOS)}catch(e){throw console.error("[AUTH] Failed to store WorkOS tokens:",e),Error("Failed to store authentication tokens")}},p=(o=(0,f._)(function(){return(0,E.Jh)(this,function(e){return O?[2,O]:[2,O=(0,f._)(function(){var e,r,t,n;return(0,E.Jh)(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,4,5]),!(e=getWorkOSTokenData()))throw Error("No refresh token available");return[4,fetch("".concat(_.URLS.streamUrl,"/refresh-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e.refreshToken,uid:localStorage.UxpUserID})})];case 1:if(!(r=o.sent()).ok)throw Error("Token refresh failed: ".concat(r.status));return[4,r.json()];case 2:if("success"!==(t=o.sent()).status)throw Error(t.message||"Failed to refresh token");return storeWorkOSTokens(t.accessToken,t.refreshToken||e.refreshToken,t.expiresIn||3600),[2,t.accessToken];case 3:throw console.error("[AUTH] WorkOS token refresh failed:",n=o.sent()),clearWorkOSTokens(),n;case 4:return O=null,[7];case 5:return[2]}})})()]})}),function(){return o.apply(this,arguments)}),A=(a=(0,f._)(function(){return(0,E.Jh)(this,function(e){return g?[2,g]:[2,g=(0,f._)(function(){var e,r;return(0,E.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,3,4]),!(e=d.I8.currentUser))throw Error("No Firebase user found for token refresh");return[4,e.getIdToken(!0)];case 1:return[2,t.sent()];case 2:throw console.error("[AUTH] Firebase token refresh failed:",r=t.sent()),r;case 3:return g=null,[7];case 4:return[2]}})})()]})}),function(){return a.apply(this,arguments)}),getAuthType=function(){var e=localStorage.getItem(S.Tg.AUTH_TYPE);if(e===S.bf.WORKOS){if(getWorkOSTokenData())return S.bf.WORKOS;localStorage.removeItem(S.Tg.AUTH_TYPE)}return e===S.bf.FIREBASE&&d.I8.currentUser&&d.I8.currentUser.emailVerified?S.bf.FIREBASE:getWorkOSTokenData()?(localStorage.setItem(S.Tg.AUTH_TYPE,S.bf.WORKOS),S.bf.WORKOS):d.I8.currentUser&&d.I8.currentUser.emailVerified?(localStorage.setItem(S.Tg.AUTH_TYPE,S.bf.FIREBASE),S.bf.FIREBASE):null},R=(s=(0,f._)(function(){var e;return(0,E.Jh)(this,function(r){try{if(!(e=getWorkOSTokenData()))throw Error("No WorkOS tokens found");return[2,e.accessToken]}catch(e){throw console.error("[AUTH] Error getting WorkOS access token:",e),e}return[2]})}),function(){return s.apply(this,arguments)}),k=(i=(0,f._)(function(){var e,r,t;return(0,E.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),!(e=d.I8.currentUser))throw Error("No Firebase user found");return[4,e.getIdTokenResult()];case 1:return r=n.sent(),localStorage.setItem("tokenId",r.token),[2,r.token];case 2:throw console.error("[AUTH] Error getting Firebase ID token:",t=n.sent()),t;case 3:return[2]}})}),function(){return i.apply(this,arguments)}),m=(u=(0,f._)(function(){return(0,E.Jh)(this,function(e){switch(e.label){case 0:if(getAuthType()!==S.bf.WORKOS)return[3,2];return[4,R()];case 1:case 3:return[2,e.sent()];case 2:return[4,k()]}})}),function(){return u.apply(this,arguments)}),D=(c=(0,f._)(function(){return(0,E.Jh)(this,function(e){switch(e.label){case 0:return[4,getAuthType()];case 1:if(e.sent()===S.bf.WORKOS)return clearWorkOSTokens(),[2];return[4,I()];case 2:return e.sent(),[2]}})}),function(){return c.apply(this,arguments)}),W=(l=(0,f._)(function(e){var r,t,n,o,a,s=arguments;return(0,E.Jh)(this,function(i){switch(i.label){case 0:r=function(r){var o;return(0,E.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,6]),[4,e()];case 1:return a.sent(),[2,{v:!0}];case 2:if(n=(o=a.sent())instanceof Error?o:Error(String(o)),!(r<t+1))return[3,4];return console.warn("[AUTH] Token refresh attempt ".concat(r," failed, retrying..."),n),[4,new Promise(function(e){return setTimeout(e,100*r)})];case 3:return a.sent(),[3,5];case 4:console.error("[AUTH] Token refresh failed after ".concat(t," retries:"),n),a.label=5;case 5:return[3,6];case 6:return[2]}})},t=s.length>1&&void 0!==s[1]?s[1]:2,n=null,o=1,i.label=1;case 1:if(!(o<=t+1))return[3,4];return[5,(0,E.XA)(r(o))];case 2:if(a=i.sent(),"object"===(0,h._)(a))return[2,a.v];i.label=3;case 3:return o++,[3,1];case 4:return[4,D()];case 5:return i.sent(),(0,T.hb)(T.zW.sessionExpired),[2,!1]}})}),function(e){return l.apply(this,arguments)})}}]);