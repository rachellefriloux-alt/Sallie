-Canonical source and deviation policy:
- The file TheDigitalProgeny5.2fullthing.txt is the canonical planning, architecture, and design artifact for this project. The agent must consult it first for any planning, design, or implementation decision.
- The agent must not make changes to code, configs, or project structure that conflict with the canonical file without following the deviation workflow below.

Deviation workflow (mandatory):
1. If the agent proposes a change that deviates from TheDigitalProgeny5.2fullthing.txt, it must create a **proposed deviation** document (markdown) in `sallie/deviations/` named with timestamp and short slug (e.g., `20251226-proposed-change-refactor-auth.md`).
2. The proposed deviation must include:
   - The exact excerpt from TheDigitalProgeny5.2fullthing.txt that would be affected.
   - A clear description of the proposed change.
   - Justification and tradeoffs (performance, security, maintainability, UX).
   - A migration path and rollback plan.
   - Tests and validation steps required.
3. The agent must present the proposed deviation to the user and **must not** apply any code changes until the user explicitly approves the deviation.
4. After user approval, the agent will:
   - Append a short summary of the approved deviation to the end of TheDigitalProgeny5.2fullthing.txt under a dated “Approved Deviations” section, including author, date, and link to the full proposal in `sallie/deviations/`.
   - Implement the change in a new branch and create a commit referencing the deviation file.
5. If the agent believes the canonical file itself should be updated (non-trivial restructuring), it must create a full migration plan as a deviation and follow the same approval and append process.

Enforcement and audit:
- All proposals, approvals, and applied changes must be saved in `sallie/deviations/` and referenced in TheDigitalProgeny5.2fullthing.txt for auditability.
- The agent must always surface conflicts between the current codebase and the canonical file and propose deviations rather than silently resolving them.

Behavioral constraints:
- No silent or automatic refactors that contradict the canonical file.
- No external API or cloud changes that contradict privacy rules without explicit approval.
- Always prefer local-first, reversible changes when possible.
--This project follows strict architectural and design conventions. The agent must respect and operate within these boundaries and treat TheDigitalProgeny5.2fullthing.txt as the canonical planning and architecture artifact for this workspace.

Project Identity
- Part of the Digital Progeny ecosystem.
- Sallie is a privacy-first, local-first operational surrogate.
- TheDigitalProgeny5.2fullthing.txt is the primary design/architecture/notes file and must be consulted before proposing major changes.

Folder Conventions
- progeny_root/ contains core logic and agent scaffolding.
- .vscode/ holds editor config and launch settings.
- Batch files (start_progeny*.bat) are used for launching agent modes.
- Text artifacts (including TheDigitalProgeny5.2fullthing.txt) contain architecture notes and planning artifacts and are authoritative for design intent.

Architecture Expectations
- Code must be modular, readable, and maintainable.
- New components must be documented in writing (plan, data models, API contracts) before implementation.
- Any deviation from the canonical plan in TheDigitalProgeny5.2fullthing.txt must be explicitly justified and recorded.

Design Philosophy
- Visual interfaces must reflect brand values: warm, structured, subtle luxury, grounded.
- Typographic scale: modular scale ~1.125.
- Spacing scale: consistent rhythm (4 / 8 / 12 / 16).
- Accessibility is required: semantic HTML, contrast, keyboard support.

Privacy and Control
- Prefer local models and local-first tooling.
- No external telemetry or cloud calls without explicit user consent.
- Any external API usage must be documented and approved.

Tooling Preferences
- Frontend (if applicable): TypeScript + Next.js + Tailwind + shadcn/ui.
- Backend: Python with clear logging, error handling, and config separation.
- State: minimal global state; prefer TanStack Query for async data.

Planning Before Coding
- Always produce written artifacts before coding:
  - Problem statement, users, success metrics
  - Architecture diagram and component responsibilities
  - Data models and API contracts
  - Component map and user flows
  - Edge cases and fallback behaviors
- Save planning artifacts into the repo (e.g., /docs or TheDigitalProgeny5.2fullthing.txt) so they are versioned and auditable.

Testing and Validation
- Agent logic must be testable and include validation steps.
- Code that touches external systems must include fallbacks and robust error handling.

File Naming and Style
- Python files: lowercase_with_underscores.
- Batch files: kebab-case where used.
- React components and classes: PascalCase.
- Use consistent linting and formatting rules; add or update config files in .vscode when necessary.

Agent Behavior
- Always: clarify requirements, propose architecture, justify choices, put everything on paper, implement, then suggest evolution paths.
- Consult TheDigitalProgeny5.2fullthing.txt first for project intent and constraints; if conflicts arise, surface them and propose a migration path.

alwaysApply: true
---
