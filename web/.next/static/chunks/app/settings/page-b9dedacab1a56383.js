(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{5253:function(e,s,t){Promise.resolve().then(t.bind(t,6155))},6155:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return j}});var a=t(7437),n=t(2265),i=t(9625),l=t(6885);let r={posture:"PEER",notifications:!0,theme:"dark",voiceLanguage:"en-US",voiceAutoSend:!1},o=(0,i.Ue)()((0,l.tJ)(e=>({settings:r,updateSettings:s=>e(e=>({settings:{...e.settings,...s}}))}),{name:"sallie-settings"}));class c{detectDesktopEnvironment(){var e;let s=!!(null===(e=window.chrome)||void 0===e?void 0:e.webview),t=!!window.sallieBridge;return s||t}setupResponseListener(){window.addEventListener("sallieBridgeResponse",e=>{var s;let t=e.detail,a=(null===(s=t.type)||void 0===s?void 0:s.replace("Response",""))||"",n=this.responseHandlers.get(a);n&&n.forEach(e=>e(t))})}postMessage(e){if(this.isDesktopEnv)try{var s,t;null===(t=window.chrome)||void 0===t||null===(s=t.webview)||void 0===s||s.postMessage(JSON.stringify(e))}catch(e){console.error("[NativeBridge] Failed to post message:",e)}}async postMessageWithResponse(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return this.isDesktopEnv?new Promise(a=>{let n=setTimeout(()=>{a({success:!1,error:"Request timed out"})},t),i=s=>{clearTimeout(n),this.removeResponseHandler(e,i),a(s)};this.addResponseHandler(e,i),this.postMessage({type:e,...s})}):{success:!1,error:"Not running in desktop environment"}}addResponseHandler(e,s){let t=this.responseHandlers.get(e)||[];t.push(s),this.responseHandlers.set(e,t)}removeResponseHandler(e,s){let t=this.responseHandlers.get(e)||[],a=t.indexOf(s);a>-1&&(t.splice(a,1),this.responseHandlers.set(e,t))}isDesktop(){return this.isDesktopEnv}async getVersion(){if(!this.isDesktopEnv)return null;let e=await this.postMessageWithResponse("getVersion");return e.success?e.data:null}showNotification(e,s){if(!this.isDesktopEnv){"Notification"in window&&"granted"===Notification.permission&&new Notification(e,{body:s});return}this.postMessage({type:"notification",title:e,body:s})}async triggerCloudSync(){return this.isDesktopEnv?this.postMessageWithResponse("cloudSync"):{success:!1,error:"Cloud sync only available in desktop app"}}async getCloudSyncStatus(){if(!this.isDesktopEnv)return{enabled:!1,status:"idle"};let e=await this.postMessageWithResponse("getCloudSyncStatus");return e.success&&e.data?e.data:{enabled:!1,status:"idle"}}async getPlugins(){if(!this.isDesktopEnv)return[];let e=await this.postMessageWithResponse("getPlugins");return e.success&&e.data?e.data:[]}async executePlugin(e,s){return this.isDesktopEnv?this.postMessageWithResponse("executePlugin",{pluginId:e,command:s}):{success:!1,error:"Plugins only available in desktop app"}}async togglePlugin(e,s){return this.isDesktopEnv?this.postMessageWithResponse("togglePlugin",{pluginId:e,enabled:s}):{success:!1,error:"Plugins only available in desktop app"}}async runScript(e){return this.isDesktopEnv?this.postMessageWithResponse("runScript",{scriptName:e}):{success:!1,error:"Scripts only available in desktop app"}}async getSetting(e){var s;if(!this.isDesktopEnv)return null;let t=await this.postMessageWithResponse("getSetting",{key:e});return t.success&&null!==(s=t.data)&&void 0!==s?s:null}async setSetting(e,s){return!!this.isDesktopEnv&&(await this.postMessageWithResponse("setSetting",{key:e,value:s})).success}openDevConsole(){if(!this.isDesktopEnv){console.log("Press F12 to open browser developer tools");return}this.postMessage({type:"openDevConsole"})}async ping(){if(!this.isDesktopEnv)return!1;let e=await this.postMessageWithResponse("ping",{},2e3);return e.success&&"pong"===e.data}constructor(){this.responseHandlers=new Map,this.isDesktopEnv=this.detectDesktopEnvironment(),this.isDesktopEnv&&this.setupResponseListener()}}let d=new c;function u(){let[e]=(0,n.useState)(()=>d.isDesktop()),[s,t]=(0,n.useState)(null),[a,i]=(0,n.useState)(!1),[l,r]=(0,n.useState)([]),[o,c]=(0,n.useState)({enabled:!1,status:"idle"}),[u,g]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{e&&(async()=>{try{let e=await d.ping();if(i(e),e){let e=await d.getVersion();t(e);let s=await d.getPlugins();r(s);let a=await d.getCloudSyncStatus();c(a)}}catch(e){console.error("[useNativeBridge] Init error:",e),h("Failed to initialize native bridge")}})()},[e]);let m=(0,n.useCallback)((e,s)=>{d.showNotification(e,s)},[]),x=(0,n.useCallback)(async()=>{if(e){g(!0),h(null);try{c(e=>({...e,status:"syncing"}));let e=await d.triggerCloudSync();e.success?c(e=>({...e,status:"idle",lastSync:new Date().toISOString()})):(c(e=>({...e,status:"error"})),h(e.error||"Sync failed"))}catch(e){c(e=>({...e,status:"error"})),h("Failed to trigger sync")}finally{g(!1)}}},[e]),y=(0,n.useCallback)(async(s,t)=>{if(!e)return null;g(!0),h(null);try{let e=await d.executePlugin(s,t);if(e.success)return e.data||null;return h(e.error||"Plugin execution failed"),null}catch(e){return h("Failed to execute plugin"),null}finally{g(!1)}},[e]),b=(0,n.useCallback)(async(s,t)=>{if(!e)return!1;try{let e=await d.togglePlugin(s,t);if(e.success)return r(e=>e.map(e=>e.id===s?{...e,enabled:t}:e)),!0;return h(e.error||"Failed to toggle plugin"),!1}catch(e){return h("Failed to toggle plugin"),!1}},[e]),v=(0,n.useCallback)(async s=>{if(!e)return null;g(!0),h(null);try{let e=await d.runScript(s);if(e.success)return e.data||null;return h(e.error||"Script execution failed"),null}catch(e){return h("Failed to run script"),null}finally{g(!1)}},[e]),f=(0,n.useCallback)(async s=>e?d.getSetting(s):null,[e]),N=(0,n.useCallback)(async(s,t)=>!!e&&d.setSetting(s,t),[e]),j=(0,n.useCallback)(()=>{d.openDevConsole()},[]),w=(0,n.useCallback)(async()=>{if(e)try{let e=await d.getPlugins();r(e)}catch(e){h("Failed to refresh plugins")}},[e]),k=(0,n.useCallback)(async()=>{if(e)try{let e=await d.getCloudSyncStatus();c(e)}catch(e){h("Failed to refresh sync status")}},[e]);return{isDesktop:e,version:s,isConnected:a,plugins:l,cloudSyncStatus:o,isLoading:u,error:p,showNotification:m,triggerSync:x,executePlugin:y,togglePlugin:b,runScript:v,getSetting:f,setSetting:N,openDevConsole:j,refreshPlugins:w,refreshSyncStatus:k}}var g=t(141),p=t(1442),h=t(301);function m(){let{isDesktop:e,plugins:s,isLoading:t,error:i,togglePlugin:l,executePlugin:r,refreshPlugins:o}=u(),[c,d]=(0,n.useState)(null),[m,x]=(0,n.useState)(null);if(!e)return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Plugin Management"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Plugin management is only available in the desktop app."})]});let y=async(e,s)=>{await l(e,!s),await o()},b=async(e,s)=>{d("".concat(e,"-").concat(s)),x(null);try{await r(e,s)?x({pluginId:e,success:!0,message:"Command executed successfully"}):x({pluginId:e,success:!1,message:"Command execution failed"})}catch(s){x({pluginId:e,success:!1,message:"Command execution error"})}finally{d(null),setTimeout(()=>x(null),3e3)}};return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Plugin Management"}),(0,a.jsx)("button",{onClick:o,disabled:t,className:"px-3 py-1 text-sm bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors disabled:opacity-50",children:t?"Loading...":"Refresh"})]}),i&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-700 rounded text-red-300 text-sm",children:i}),m&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded text-sm ".concat(m.success?"bg-green-900/30 border border-green-700 text-green-300":"bg-red-900/30 border border-red-700 text-red-300"),children:m.message}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,a.jsx)(g.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"No plugins installed"})]}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 text-violet-400"}),(0,a.jsx)("h3",{className:"text-lg font-medium",children:e.name}),e.enabled?(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-500"}):(0,a.jsx)(h.Z,{className:"w-5 h-5 text-gray-500"})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:e.description})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 ml-4",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Enabled"}),(0,a.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:()=>y(e.id,e.enabled),className:"w-5 h-5 rounded border-gray-600 bg-gray-600 text-violet-600 focus:ring-violet-500"})]})]}),e.commands&&e.commands.length>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"Available Commands:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.commands.map(s=>(0,a.jsx)("button",{onClick:()=>b(e.id,s.name),disabled:!e.enabled||c==="".concat(e.id,"-").concat(s.name),title:s.description,className:"px-3 py-1 text-sm bg-violet-600 hover:bg-violet-700 text-white rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c==="".concat(e.id,"-").concat(s.name)?"Running...":s.name},s.name))})]})]},e.id))})]})}var x=t(7653),y=t(7842),b=t(6310);function v(){let{isDesktop:e,cloudSyncStatus:s,isLoading:t,triggerSync:n,refreshSyncStatus:i}=u();if(!e||!s.enabled)return null;let l=async()=>{if("syncing"!==s.status)try{await n(),await i()}catch(e){console.error("Sync error:",e)}};return(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 bg-gray-800 rounded-lg border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(()=>{switch(s.status){case"syncing":return(0,a.jsx)(x.Z,{className:"w-5 h-5 text-blue-400 animate-pulse"});case"error":return(0,a.jsx)(y.Z,{className:"w-5 h-5 text-red-400"});default:return(0,a.jsx)(p.Z,{className:"w-5 h-5 text-green-400"})}})(),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:s.provider?"".concat(s.provider," Sync"):"Cloud Sync"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:(()=>{switch(s.status){case"syncing":return"Syncing...";case"error":return"Sync Error";case"idle":return s.lastSync?"Last sync: ".concat(function(e){try{let s=new Date(e);if(isNaN(s.getTime()))return"unknown";let t=new Date().getTime()-s.getTime(),a=Math.floor(t/6e4),n=Math.floor(t/36e5);if(a<1)return"just now";if(a<60)return"".concat(a,"m ago");if(n<24)return"".concat(n,"h ago");return"".concat(Math.floor(t/864e5),"d ago")}catch(e){return"unknown"}}(s.lastSync)):"Ready to sync";default:return"Unknown status"}})()})]})]}),(0,a.jsx)("button",{onClick:l,disabled:"syncing"===s.status||t,className:"p-2 hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Sync now",children:(0,a.jsx)(b.Z,{className:"w-4 h-4 text-gray-400 ".concat("syncing"===s.status?"animate-spin":"")})})]})}let f=[{code:"en-US",label:"English (US)"},{code:"en-GB",label:"English (UK)"},{code:"en-AU",label:"English (Australia)"},{code:"es-ES",label:"Spanish (Spain)"},{code:"es-MX",label:"Spanish (Mexico)"},{code:"fr-FR",label:"French"},{code:"de-DE",label:"German"},{code:"it-IT",label:"Italian"},{code:"pt-BR",label:"Portuguese (Brazil)"},{code:"ja-JP",label:"Japanese"},{code:"ko-KR",label:"Korean"},{code:"zh-CN",label:"Chinese (Simplified)"},{code:"zh-TW",label:"Chinese (Traditional)"}];function N(){let{settings:e,updateSettings:s}=o(),{isDesktop:t,version:i,isConnected:l}=u(),[r,c]=(0,n.useState)({gemini:"",openai:""}),[d,g]=(0,n.useState)(!1),[p,h]=(0,n.useState)({enableSystemTray:!0,minimizeToTray:!0,startOnLogin:!1,enableNativeNotifications:!0}),x=async()=>{g(!0);try{console.log("Saving settings:",e),await new Promise(e=>setTimeout(e,500))}catch(e){console.error("Failed to save settings:",e)}finally{g(!1)}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Settings"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Configure Sallie's behavior and preferences"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Posture Mode"}),(0,a.jsxs)("select",{value:e.posture,onChange:e=>s({posture:e.target.value}),className:"w-full px-4 py-2 bg-gray-700 text-gray-100 rounded-lg border border-gray-600 focus:border-violet-500 focus:ring-2 focus:ring-violet-500 focus:outline-none",children:[(0,a.jsx)("option",{value:"COMPANION",children:"Companion - Grounding, warm presence"}),(0,a.jsx)("option",{value:"CO_PILOT",children:"Co-Pilot - Decisive, execution-focused"}),(0,a.jsx)("option",{value:"PEER",children:"Peer - Real talk, collaborative"}),(0,a.jsx)("option",{value:"EXPERT",children:"Expert - Dense, technical, option-oriented"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Notifications"}),(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.notifications,onChange:e=>s({notifications:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Enable notifications"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Voice Input"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"Configure speech recognition settings. Voice input requires Chrome, Edge, or Safari."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Speech Recognition Language"}),(0,a.jsx)("select",{value:e.voiceLanguage,onChange:e=>s({voiceLanguage:e.target.value}),className:"w-full px-4 py-2 bg-gray-700 text-gray-100 rounded-lg border border-gray-600 focus:border-violet-500 focus:ring-2 focus:ring-violet-500 focus:outline-none",children:f.map(e=>(0,a.jsx)("option",{value:e.code,children:e.label},e.code))})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.voiceAutoSend,onChange:e=>s({voiceAutoSend:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Auto-send after voice input"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Keyboard shortcut: Ctrl+Shift+V (or Cmd+Shift+V on Mac) to toggle voice input"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"API Keys"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Gemini API Key"}),(0,a.jsx)("input",{type:"password",value:r.gemini,onChange:e=>c({...r,gemini:e.target.value}),placeholder:"Enter Gemini API key",className:"w-full px-4 py-2 bg-gray-700 text-gray-100 rounded-lg border border-gray-600 focus:border-violet-500 focus:ring-2 focus:ring-violet-500 focus:outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"OpenAI API Key (Optional)"}),(0,a.jsx)("input",{type:"password",value:r.openai,onChange:e=>c({...r,openai:e.target.value}),placeholder:"Enter OpenAI API key",className:"w-full px-4 py-2 bg-gray-700 text-gray-100 rounded-lg border border-gray-600 focus:border-violet-500 focus:ring-2 focus:ring-violet-500 focus:outline-none"})]})]})]}),t&&(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Desktop Settings"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:["Running Sallie Desktop v",i||"Unknown"," ",l?"(Connected)":"(Disconnected)"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:p.enableSystemTray,onChange:e=>h({...p,enableSystemTray:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Enable system tray icon"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:p.minimizeToTray,onChange:e=>h({...p,minimizeToTray:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500",disabled:!p.enableSystemTray}),(0,a.jsx)("span",{className:p.enableSystemTray?"text-gray-300":"text-gray-500",children:"Minimize to system tray"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:p.startOnLogin,onChange:e=>h({...p,startOnLogin:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Start on system login"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:p.enableNativeNotifications,onChange:e=>h({...p,enableNativeNotifications:e.target.checked}),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-violet-600 focus:ring-violet-500"}),(0,a.jsx)("span",{className:"text-gray-300",children:"Enable native desktop notifications"})]})]})]}),t&&(0,a.jsx)(m,{}),t&&(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Cloud Sync"}),(0,a.jsx)(v,{})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:x,disabled:d,className:"px-6 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-50",children:d?"Saving...":"Save Settings"}),(0,a.jsx)("button",{onClick:()=>{let s=new Blob([JSON.stringify({settings:e,apiKeys:{gemini:"***",openai:"***"}},null,2)],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="sallie-settings-".concat(new Date().toISOString().split("T")[0],".json"),a.click(),URL.revokeObjectURL(t)},className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg font-semibold transition-colors",children:"Export Settings"})]})]})]})}function j(){return(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 p-4 md:p-8",children:(0,a.jsx)(N,{})})}}},function(e){e.O(0,[992,971,117,744],function(){return e(e.s=5253)}),_N_E=e.O()}]);